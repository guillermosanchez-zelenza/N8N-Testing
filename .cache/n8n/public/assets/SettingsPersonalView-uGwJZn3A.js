import{e as M,k as C,fE as U,l as I,f as $,u as E,aK as D,dc as A,x as N,_ as L}from"./n8n-_nNvRoCf.js";import{m as w}from"./pinia-aUqqC48i.js";import{G as z,ag as n,l as i,m,p as s,T as t,O as a,S as l,R as o,I as r,M as b,Q as g,F as B,a7 as V}from"./vendor-NNwioulI.js";import"./lodash-es-5z_C16pm.js";import"./axios-s2RMMPhA.js";import"./flatted-jPn12Tq4.js";import"./esprima-next-ulPLCZ1Z.js";import"./luxon-ZRIU05qF.js";import"./@vueuse/core-8g26_cc0.js";import"./uuid-McvpxQtQ.js";import"./vue-i18n-1PEMRmUU.js";import"./@n8n/permissions-8yMqUF1Y.js";const F=z({name:"SettingsPersonalView",setup(){return{i18n:N(),...M()}},data(){return{hasAnyChanges:!1,formInputs:null,formBus:C(),readyToSubmit:!1,mfaDocsUrl:U,themeOptions:[{name:"system",label:"settings.personal.theme.systemDefault"},{name:"light",label:"settings.personal.theme.light"},{name:"dark",label:"settings.personal.theme.dark"}]}},mounted(){var e,u,h;this.formInputs=[{name:"firstName",initialValue:(e=this.currentUser)==null?void 0:e.firstName,properties:{label:this.i18n.baseText("auth.firstName"),maxlength:32,required:!0,autocomplete:"given-name",capitalize:!0,disabled:this.isLDAPFeatureEnabled&&this.signInWithLdap}},{name:"lastName",initialValue:(u=this.currentUser)==null?void 0:u.lastName,properties:{label:this.i18n.baseText("auth.lastName"),maxlength:32,required:!0,autocomplete:"family-name",capitalize:!0,disabled:this.isLDAPFeatureEnabled&&this.signInWithLdap}},{name:"email",initialValue:(h=this.currentUser)==null?void 0:h.email,properties:{label:this.i18n.baseText("auth.email"),type:"email",required:!0,validationRules:[{name:"VALID_EMAIL"}],autocomplete:"email",capitalize:!0,disabled:this.isLDAPFeatureEnabled&&this.signInWithLdap||this.signInWithSaml}}]},computed:{...w(E,$,I),currentUser(){return this.usersStore.currentUser},signInWithLdap(){var e;return((e=this.currentUser)==null?void 0:e.signInType)==="ldap"},isLDAPFeatureEnabled(){return this.settingsStore.settings.enterprise.ldap},signInWithSaml(){return this.settingsStore.isSamlLoginEnabled&&this.settingsStore.isDefaultAuthenticationSaml},mfaDisabled(){return!this.usersStore.mfaEnabled},isMfaFeatureEnabled(){return this.settingsStore.isMfaFeatureEnabled},currentTheme(){return this.uiStore.theme}},methods:{selectTheme(e){this.uiStore.setTheme(e)},onInput(){this.hasAnyChanges=!0},onReadyToSubmit(e){this.readyToSubmit=e},async onSubmit(e){if(!(!this.hasAnyChanges||!this.usersStore.currentUserId))try{await this.usersStore.updateUser({id:this.usersStore.currentUserId,firstName:e.firstName,lastName:e.lastName,email:e.email}),this.showToast({title:this.i18n.baseText("settings.personal.personalSettingsUpdated"),message:"",type:"success"}),this.hasAnyChanges=!1}catch(u){this.showError(u,this.i18n.baseText("settings.personal.personalSettingsUpdatedError"))}},onSaveClick(){this.formBus.emit("submit")},openPasswordModal(){this.uiStore.openModal(D)},onMfaEnableClick(){this.uiStore.openModal(A)},async onMfaDisableClick(){try{await this.usersStore.disabledMfa(),this.showToast({title:this.$locale.baseText("settings.personal.mfa.toast.disabledMfa.title"),message:this.$locale.baseText("settings.personal.mfa.toast.disabledMfa.message"),type:"success",duration:0})}catch(e){this.showError(e,this.$locale.baseText("settings.personal.mfa.toast.disabledMfa.error.message"))}}}}),P="_container_i4boh_5",W="_header_i4boh_12",R="_user_i4boh_21",O="_username_i4boh_31",q="_disableMfaButton_i4boh_43",K="_button_i4boh_50",G="_infoText_i4boh_57",Y="_themeSelect_i4boh_62",H={container:P,header:W,user:R,username:O,disableMfaButton:q,button:K,infoText:G,themeSelect:Y},Q={class:"mb-s"},j={"data-test-id":"personal-data-form"},J={key:0},X={class:"mb-s"},Z={class:"mb-s"},x={key:0},ee={class:"mb-xs"},te={class:"mb-s"};function se(e,u,h,ne,ie,le){const d=n("n8n-heading"),_=n("n8n-text"),y=n("n8n-avatar"),T=n("n8n-form-inputs"),S=n("n8n-link"),p=n("n8n-input-label"),c=n("n8n-button"),v=n("n8n-option"),k=n("n8n-select");return i(),m("div",{class:r(e.$style.container),"data-test-id":"personal-settings-container"},[s("div",{class:r(e.$style.header)},[t(d,{size:"2xlarge"},{default:a(()=>[l(o(e.i18n.baseText("settings.personal.personalSettings")),1)]),_:1}),s("div",{class:r(e.$style.user)},[s("span",{class:r(e.$style.username),"data-test-id":"current-user-name"},[t(_,{color:"text-light"},{default:a(()=>[l(o(e.currentUser.fullName),1)]),_:1})],2),t(y,{"first-name":e.currentUser.firstName,"last-name":e.currentUser.lastName,size:"large"},null,8,["first-name","last-name"])],2)],2),s("div",null,[s("div",Q,[t(d,{size:"large"},{default:a(()=>[l(o(e.i18n.baseText("settings.personal.basicInformation")),1)]),_:1})]),s("div",j,[e.formInputs?(i(),b(T,{key:0,inputs:e.formInputs,"event-bus":e.formBus,onUpdate:e.onInput,onReady:e.onReadyToSubmit,onSubmit:e.onSubmit},null,8,["inputs","event-bus","onUpdate","onReady","onSubmit"])):g("",!0)])]),!e.signInWithLdap&&!e.signInWithSaml?(i(),m("div",J,[s("div",X,[t(d,{size:"large"},{default:a(()=>[l(o(e.i18n.baseText("settings.personal.security")),1)]),_:1})]),s("div",Z,[t(p,{label:e.i18n.baseText("auth.password")},{default:a(()=>[t(S,{"data-test-id":"change-password-link",onClick:e.openPasswordModal},{default:a(()=>[l(o(e.i18n.baseText("auth.changePassword")),1)]),_:1},8,["onClick"])]),_:1},8,["label"])]),e.isMfaFeatureEnabled?(i(),m("div",x,[s("div",ee,[t(p,{label:e.$locale.baseText("settings.personal.mfa.section.title")},null,8,["label"]),t(_,{bold:!1,class:r(e.$style.infoText)},{default:a(()=>[l(o(e.mfaDisabled?e.$locale.baseText("settings.personal.mfa.button.disabled.infobox"):e.$locale.baseText("settings.personal.mfa.button.enabled.infobox"))+" ",1),t(S,{to:e.mfaDocsUrl,size:"small",bold:!0},{default:a(()=>[l(o(e.$locale.baseText("generic.learnMore")),1)]),_:1},8,["to"])]),_:1},8,["class"])]),e.mfaDisabled?(i(),b(c,{key:0,class:r(e.$style.button),type:"tertiary",label:e.$locale.baseText("settings.personal.mfa.button.enabled"),"data-test-id":"enable-mfa-button",onClick:e.onMfaEnableClick},null,8,["class","label","onClick"])):(i(),b(c,{key:1,class:r(e.$style.disableMfaButton),type:"tertiary",label:e.$locale.baseText("settings.personal.mfa.button.disabled"),"data-test-id":"disable-mfa-button",onClick:e.onMfaDisableClick},null,8,["class","label","onClick"]))])):g("",!0)])):g("",!0),s("div",null,[s("div",te,[t(d,{size:"large"},{default:a(()=>[l(o(e.i18n.baseText("settings.personal.personalisation")),1)]),_:1})]),s("div",null,[t(p,{label:e.i18n.baseText("settings.personal.theme")},{default:a(()=>[t(k,{class:r(e.$style.themeSelect),"data-test-id":"theme-select",size:"small","model-value":e.currentTheme,filterable:"","onUpdate:modelValue":e.selectTheme},{default:a(()=>[(i(!0),m(B,null,V(e.themeOptions,f=>(i(),b(v,{key:f.name,label:e.$t(f.label),value:f.name},null,8,["label","value"]))),128))]),_:1},8,["class","model-value","onUpdate:modelValue"])]),_:1},8,["label"])])]),s("div",null,[t(c,{float:"right",label:e.i18n.baseText("settings.personal.save"),size:"large",disabled:!e.hasAnyChanges||!e.readyToSubmit,"data-test-id":"save-settings-button",onClick:e.onSaveClick},null,8,["label","disabled","onClick"])])],2)}const ae={$style:H},Se=L(F,[["render",se],["__cssModules",ae]]);export{Se as default};
//# sourceMappingURL=SettingsPersonalView-uGwJZn3A.js.map
