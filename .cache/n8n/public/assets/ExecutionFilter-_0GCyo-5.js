import{G as H,l as p,m as T,R as d,r as ae,e as b,Z as O,D as se,ag as c,M as g,O as i,T as r,S as w,Q as y,u as o,p as n,F as A,a7 as K,I as u,a2 as Y}from"./vendor-NNwioulI.js";import{_ as Q,l as oe,u as le,aM as ne,t as ie,fQ as re,b as t,cP as z,O as de}from"./n8n-_nNvRoCf.js";import{T as ue}from"./index-xP-VuMjv.js";const ce=H({name:"ExecutionTime",props:["startTime"],data(){return{nowTime:-1,intervalTimer:null}},computed:{time(){if(!this.startTime)return"...";const x=this.nowTime-new Date(this.startTime).getTime();return this.$locale.displayTimer(x)}},mounted(){this.setNow(),this.intervalTimer=setInterval(()=>{this.setNow()},1e3)},beforeUnmount(){this.intervalTimer!==null&&clearInterval(this.intervalTimer)},methods:{setNow(){this.nowTime=new Date().getTime()}}});function pe(x,v,C,$,E,I){return p(),T("span",null,d(x.time),1)}const Le=Q(ce,[["render",pe]]),me={"data-test-id":"execution-filter-form"},fe={for:"execution-filter-workflows"},ve={for:"execution-filter-tags"},xe={for:"execution-filter-status"},_e={for:"execution-filter-start-date"},be={target:"_blank",href:"https://docs.n8n.io/workflows/executions/custom-executions-data/"},ge={for:"execution-filter-saved-data-key"},Te=["onClick"],ke={for:"execution-filter-saved-data-value"},he=["onClick"],j="YYYY-MM-DD HH:mm",we=H({__name:"ExecutionFilter",props:{workflows:{},popoverPlacement:{default:"bottom"},teleported:{type:Boolean,default:!0}},emits:["filterChanged"],setup(x,{emit:v}){const C=x,$=oe(),E=le(),{debounce:I}=ne(),R=de(),W=I(v,{debounceTime:500}),D=ae(!1),k=b(()=>$.isEnterpriseFeatureEnabled(ie.AdvancedExecutionFilters)),q=b(()=>!1),M=()=>({status:"all",workflowId:"all",tags:[],startDate:"",endDate:"",metadata:[{key:"",value:""}]}),a=O(M()),m=O(re(a).reduce((e,l)=>(e[l]=b({get(){return a[l]},set(_){a[l]=_,v("filterChanged",a)}}),e),{})),Z=b(()=>[{id:"all",name:t.baseText("executionsList.anyStatus")},{id:"error",name:t.baseText("executionsList.error")},{id:"canceled",name:t.baseText("executionsList.canceled")},{id:"running",name:t.baseText("executionsList.running")},{id:"success",name:t.baseText("executionsList.success")},{id:"waiting",name:t.baseText("executionsList.waiting")}]),h=b(()=>{let e=0;return a.status!=="all"&&e++,a.workflowId!=="all"&&e++,z(a.tags)||e++,z(a.metadata)||e++,a.startDate&&e++,a.endDate&&e++,e}),U=(e,l,_)=>{a.metadata[e]||(a.metadata[e]={key:"",value:""}),a.metadata[e][l]=_,D.value||(R.track("User filtered executions with custom data"),D.value=!0),W("filterChanged",a)},J=e=>{a.tags=e,v("filterChanged",a)},X=()=>{Object.assign(a,M()),v("filterChanged",a)},S=()=>{E.goToUpgrade("custom-data-filter","upgrade-custom-data-filter")};return se(()=>{D.value=!1,v("filterChanged",a)}),(e,l)=>{const _=c("n8n-badge"),B=c("n8n-button"),L=c("n8n-option"),N=c("n8n-select"),P=c("el-date-picker"),F=c("i18n-t"),ee=c("n8n-icon"),V=c("n8n-tooltip"),G=c("n8n-input"),te=c("n8n-popover");return p(),g(te,{trigger:"click",placement:e.popoverPlacement,width:"440"},{reference:i(()=>[r(B,{icon:"filter",type:"tertiary",active:!!h.value,"data-test-id":"executions-filter-button"},{default:i(()=>[h.value?(p(),g(_,{key:0,theme:"primary",class:"mr-4xs","data-test-id":"execution-filter-badge"},{default:i(()=>[w(d(h.value),1)]),_:1})):y("",!0),w(" "+d(o(t).baseText("executionsList.filters")),1)]),_:1},8,["active"])]),default:i(()=>[n("div",me,[e.workflows&&e.workflows.length>0?(p(),T("div",{key:0,class:u(e.$style.group)},[n("label",fe,d(o(t).baseText("workflows.heading")),1),r(N,{id:"execution-filter-workflows",modelValue:m.workflowId,"onUpdate:modelValue":l[0]||(l[0]=s=>m.workflowId=s),placeholder:o(t).baseText("executionsFilter.selectWorkflow"),filterable:"","data-test-id":"executions-filter-workflows-select",teleported:e.teleported},{default:i(()=>[n("div",null,[(p(!0),T(A,null,K(C.workflows,(s,f)=>(p(),g(L,{key:f,label:s.name,value:s.id},null,8,["label","value"]))),128))])]),_:1},8,["modelValue","placeholder","teleported"])],2)):y("",!0),q.value?(p(),T("div",{key:1,class:u(e.$style.group)},[n("label",ve,d(o(t).baseText("workflows.filters.tags")),1),r(ue,{id:"execution-filter-tags",placeholder:o(t).baseText("workflowOpen.filterWorkflows"),"model-value":a.tags,"create-enabled":!1,"data-test-id":"executions-filter-tags-select","onUpdate:modelValue":J},null,8,["placeholder","model-value"])],2)):y("",!0),n("div",{class:u(e.$style.group)},[n("label",xe,d(o(t).baseText("executionsList.status")),1),r(N,{id:"execution-filter-status",modelValue:m.status,"onUpdate:modelValue":l[1]||(l[1]=s=>m.status=s),placeholder:o(t).baseText("executionsFilter.selectStatus"),filterable:"","data-test-id":"executions-filter-status-select",teleported:e.teleported},{default:i(()=>[(p(!0),T(A,null,K(Z.value,(s,f)=>(p(),g(L,{key:f,label:s.name,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder","teleported"])],2),n("div",{class:u(e.$style.group)},[n("label",_e,d(o(t).baseText("executionsFilter.start")),1),n("div",{class:u(e.$style.dates)},[r(P,{id:"execution-filter-start-date",modelValue:m.startDate,"onUpdate:modelValue":l[2]||(l[2]=s=>m.startDate=s),type:"datetime",teleported:!1,format:j,placeholder:o(t).baseText("executionsFilter.startDate"),"data-test-id":"executions-filter-start-date-picker"},null,8,["modelValue","placeholder"]),n("span",{class:u(e.$style.divider)},"to",2),r(P,{id:"execution-filter-end-date",modelValue:m.endDate,"onUpdate:modelValue":l[3]||(l[3]=s=>m.endDate=s),type:"datetime",teleported:!1,format:j,placeholder:o(t).baseText("executionsFilter.endDate"),"data-test-id":"executions-filter-end-date-picker"},null,8,["modelValue","placeholder"])],2)],2),n("div",{class:u(e.$style.group)},[r(V,{placement:"right"},{content:i(()=>[r(F,{tag:"span",keypath:"executionsFilter.customData.docsTooltip"},{link:i(()=>[n("a",be,d(o(t).baseText("executionsFilter.customData.docsTooltip.link")),1)]),_:1})]),default:i(()=>[n("span",{class:u(e.$style.label)},[w(d(o(t).baseText("executionsFilter.savedData"))+" ",1),r(ee,{class:u(e.$style.tooltipIcon),icon:"question-circle",size:"small"},null,8,["class"])],2)]),_:1}),n("div",{class:u(e.$style.subGroup)},[n("label",ge,d(o(t).baseText("executionsFilter.savedDataKey")),1),r(V,{disabled:k.value,placement:"top"},{content:i(()=>[r(F,{tag:"span",keypath:"executionsFilter.customData.inputTooltip"},{link:i(()=>[n("a",{href:"#","data-test-id":"executions-filter-view-plans-link",onClick:Y(S,["prevent"])},d(o(t).baseText("executionsFilter.customData.inputTooltip.link")),9,Te)]),_:1})]),default:i(()=>{var s;return[r(G,{id:"execution-filter-saved-data-key",name:"execution-filter-saved-data-key",type:"text",disabled:!k.value,placeholder:o(t).baseText("executionsFilter.savedDataKeyPlaceholder"),"model-value":(s=a.metadata[0])==null?void 0:s.key,"data-test-id":"execution-filter-saved-data-key-input","onUpdate:modelValue":l[4]||(l[4]=f=>U(0,"key",f))},null,8,["disabled","placeholder","model-value"])]}),_:1},8,["disabled"]),n("label",ke,d(o(t).baseText("executionsFilter.savedDataValue")),1),r(V,{disabled:k.value,placement:"top"},{content:i(()=>[r(F,{tag:"span",keypath:"executionsFilter.customData.inputTooltip"},{link:i(()=>[n("a",{href:"#",onClick:Y(S,["prevent"])},d(o(t).baseText("executionsFilter.customData.inputTooltip.link")),9,he)]),_:1})]),default:i(()=>{var s;return[r(G,{id:"execution-filter-saved-data-value",name:"execution-filter-saved-data-value",type:"text",disabled:!k.value,placeholder:o(t).baseText("executionsFilter.savedDataValuePlaceholder"),"model-value":(s=a.metadata[0])==null?void 0:s.value,"data-test-id":"execution-filter-saved-data-value-input","onUpdate:modelValue":l[5]||(l[5]=f=>U(0,"value",f))},null,8,["disabled","placeholder","model-value"])]}),_:1},8,["disabled"])],2)],2),h.value?(p(),g(B,{key:2,class:u(e.$style.resetBtn),size:"large",text:"","data-test-id":"executions-filter-reset-button",onClick:X},{default:i(()=>[w(d(o(t).baseText("executionsFilter.reset")),1)]),_:1},8,["class"])):y("",!0)])]),_:1},8,["placement"])}}}),ye="_group_1153r_5",De="_label_1153r_6",Fe="_subGroup_1153r_12",Ve="_dates_1153r_21",Ce="_divider_1153r_29",$e="_resetBtn_1153r_34",Ee="_tooltipIcon_1153r_39",Ie={group:ye,label:De,subGroup:Fe,dates:Ve,divider:Ce,resetBtn:$e,tooltipIcon:Ee},Me={$style:Ie},Ne=Q(we,[["__cssModules",Me],["__scopeId","data-v-88754156"]]);export{Le as E,Ne as a};
//# sourceMappingURL=ExecutionFilter-_0GCyo-5.js.map
