import{u as A,e as $,x as I,dy as K,_ as q}from"./n8n-_nNvRoCf.js";import{G as L,aJ as J,aK as Q,aL as W}from"./index-xP-VuMjv.js";import{D as X}from"./luxon-ZRIU05qF.js";import{G as M,_ as Y,e as _,b as N,ag as i,l as s,M as x,O as a,I as u,u as t,T as d,R as c,S as v,p as l,Q as H,m as y,n as Z,F as ee,a7 as te}from"./vendor-NNwioulI.js";import"./lodash-es-5z_C16pm.js";import"./axios-s2RMMPhA.js";import"./flatted-jPn12Tq4.js";import"./esprima-next-ulPLCZ1Z.js";import"./pinia-aUqqC48i.js";import"./@vueuse/core-8g26_cc0.js";import"./uuid-McvpxQtQ.js";import"./vue-i18n-1PEMRmUU.js";import"./@n8n/permissions-8yMqUF1Y.js";import"./@n8n/codemirror-lang-sql-feLn5IS9.js";import"./@lezer/common-1hBQ1gIF.js";import"./codemirror-lang-html-n8n-wWQLhhqk.js";import"./prettier-s3fE3Qyr.js";import"./@jsplumb/util-DR0SB56A.js";import"./@jsplumb/core-MKwKlGip.js";import"./@jsplumb/common-Q5_tv_GT.js";import"./@jsplumb/connector-bezier-3dWY17R5.js";import"./@jsplumb/browser-ui-AlqFM-P6.js";import"./codemirror-lang-n8n-expression-HpIZnV_9.js";import"./fast-json-stable-stringify-eHEaCv8s.js";import"./timeago.js--Bumj2r9.js";import"./qrcode.vue-UdCmS1Sj.js";import"./vue3-touch-events-_RfbPMOD.js";import"./chart.js-JtqvIvkt.js";const ne=M({__name:"ExternalSecretsProviderCard.ee",props:{provider:{type:Object,required:!0}},setup(C){const e=C,m=L(),n=I(),f=A(),b=$(),{provider:o}=Y(e),p=_(()=>o.value.data),{connectionState:g,initialConnectionState:E,normalizedProviderData:w,testConnection:k,setConnectionState:h}=J(o,p),S=_(()=>[{value:"setup",label:n.baseText("settings.externalSecrets.card.actionDropdown.setup")},...e.provider.connected?[{value:"reload",label:n.baseText("settings.externalSecrets.card.actionDropdown.reload")}]:[]]),O=_(()=>e.provider.connected||Object.keys(e.provider.data).length>0),R=_(r=>X.fromISO(e.provider.connectedAt).toFormat("dd LLL yyyy"));N(()=>{h(e.provider.state)});async function U(){return e.provider.connected?!0:(await m.getProvider(e.provider.name),await Z(),await k()!=="error")}function B(){f.openModalWithData({name:K,data:{name:e.provider.name}})}async function V(){try{await m.reloadProvider(e.provider.name),b.showMessage({title:n.baseText("settings.externalSecrets.card.reload.success.title"),message:n.baseText("settings.externalSecrets.card.reload.success.description",{interpolate:{provider:e.provider.displayName}}),type:"success"})}catch(r){b.showError(r,n.baseText("error"))}}async function z(r){switch(r){case"setup":B();break;case"reload":await V();break}}return(r,D)=>{const P=i("n8n-text"),F=i("n8n-action-toggle"),j=i("n8n-button"),G=i("n8n-card");return s(),x(G,{class:u(r.$style.card)},{default:a(()=>[l("div",{class:u(r.$style.cardBody)},[d(Q,{class:u(r.$style.cardImage),provider:t(o)},null,8,["class","provider"]),l("div",{class:u(r.$style.cardContent)},[d(P,{bold:""},{default:a(()=>[v(c(t(o).displayName),1)]),_:1}),t(o).connected?(s(),x(P,{key:0,color:"text-light",size:"small"},{default:a(()=>{var T;return[l("span",null,c(t(n).baseText("settings.externalSecrets.card.secretsCount",{interpolate:{count:`${(T=t(m).secrets[t(o).name])==null?void 0:T.length}`}})),1),v(" | "),l("span",null,c(t(n).baseText("settings.externalSecrets.card.connectedAt",{interpolate:{date:R.value}})),1)]}),_:1})):H("",!0)],2),O.value?(s(),y("div",{key:0,class:u(r.$style.cardActions)},[d(W,{provider:t(o),"before-update":U,disabled:t(g)==="error"&&!t(o).connected},null,8,["provider","disabled"]),d(F,{class:"ml-s",theme:"dark",actions:S.value,onAction:z},null,8,["actions"])],2)):(s(),x(j,{key:1,type:"tertiary",onClick:D[0]||(D[0]=T=>B())},{default:a(()=>[v(c(t(n).baseText("settings.externalSecrets.card.setUp")),1)]),_:1}))],2)]),_:1},8,["class"])}}}),re="_card_63ubk_5",oe="_cardImage_63ubk_10",se="_cardBody_63ubk_15",ae="_cardContent_63ubk_21",ce="_cardActions_63ubk_28",ie={card:re,cardImage:oe,cardBody:se,cardContent:ae,cardActions:ce},de={$style:ie},le=q(ne,[["__cssModules",de]]),pe={class:"pb-3xl"},me={key:0,"data-test-id":"external-secrets-content-licensed"},ue=["href"],_e=["href"],je=M({__name:"SettingsExternalSecrets",setup(C){const e=I(),m=A(),n=L(),f=$(),b=_(()=>[...n.providers].sort((p,g)=>g.name.localeCompare(p.name)));N(()=>{try{n.fetchAllSecrets(),n.getProviders()}catch(p){f.showError(p,e.baseText("error"))}});function o(){m.goToUpgrade("external-secrets","upgrade-external-secrets")}return(p,g)=>{const E=i("n8n-heading"),w=i("n8n-callout"),k=i("i18n-t"),h=i("n8n-action-box");return s(),y("div",pe,[d(E,{size:"2xlarge"},{default:a(()=>[v(c(t(e).baseText("settings.externalSecrets.title")),1)]),_:1}),t(n).isEnterpriseExternalSecretsEnabled?(s(),y("div",me,[d(w,{theme:"secondary",class:"mt-2xl mb-l"},{default:a(()=>[v(c(t(e).baseText("settings.externalSecrets.info"))+" ",1),l("a",{href:t(e).baseText("settings.externalSecrets.docs"),target:"_blank"},c(t(e).baseText("settings.externalSecrets.info.link")),9,ue)]),_:1}),(s(!0),y(ee,null,te(b.value,S=>(s(),x(le,{key:S.name,provider:S},null,8,["provider"]))),128))])):(s(),x(h,{key:1,class:"mt-2xl mb-l","data-test-id":"external-secrets-content-unlicensed","button-text":t(e).baseText("settings.externalSecrets.actionBox.buttonText"),onClick:o},{heading:a(()=>[l("span",null,c(t(e).baseText("settings.externalSecrets.actionBox.title")),1)]),description:a(()=>[d(k,{keypath:"settings.externalSecrets.actionBox.description"},{link:a(()=>[l("a",{href:t(e).baseText("settings.externalSecrets.docs"),target:"_blank"},c(t(e).baseText("settings.externalSecrets.actionBox.description.link")),9,_e)]),_:1})]),_:1},8,["button-text"]))])}}});export{je as default};
//# sourceMappingURL=SettingsExternalSecrets-cORN09wt.js.map
