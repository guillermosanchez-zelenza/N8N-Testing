import{e3 as w,g7 as B,_ as T,a9 as N,cP as R,b as V,a5 as z,fU as C}from"./n8n-_nNvRoCf.js";import{aP as W,h as J}from"./index-xP-VuMjv.js";import{_ as S,M as K}from"./TextWithHighlights.vue_vue_type_script_setup_true_lang-OUCPnKVA.js";import{G as F,e as p,ag as D,l as s,m as o,I as n,p as M,T as A,M as i,Q as l,R as P,F as H,a7 as L,J as U,r as j,O as $,u as q,S as G}from"./vendor-NNwioulI.js";import{D as O}from"./NodeView-e_zfgMVH.js";import"./lodash-es-5z_C16pm.js";import"./axios-s2RMMPhA.js";import"./flatted-jPn12Tq4.js";import"./esprima-next-ulPLCZ1Z.js";import"./luxon-ZRIU05qF.js";import"./pinia-aUqqC48i.js";import"./@vueuse/core-8g26_cc0.js";import"./uuid-McvpxQtQ.js";import"./vue-i18n-1PEMRmUU.js";import"./@n8n/permissions-8yMqUF1Y.js";import"./@n8n/codemirror-lang-sql-feLn5IS9.js";import"./@lezer/common-1hBQ1gIF.js";import"./codemirror-lang-html-n8n-wWQLhhqk.js";import"./prettier-s3fE3Qyr.js";import"./@jsplumb/util-DR0SB56A.js";import"./@jsplumb/core-MKwKlGip.js";import"./@jsplumb/common-Q5_tv_GT.js";import"./@jsplumb/connector-bezier-3dWY17R5.js";import"./@jsplumb/browser-ui-AlqFM-P6.js";import"./codemirror-lang-n8n-expression-HpIZnV_9.js";import"./fast-json-stable-stringify-eHEaCv8s.js";import"./timeago.js--Bumj2r9.js";import"./qrcode.vue-UdCmS1Sj.js";import"./vue3-touch-events-_RfbPMOD.js";import"./chart.js-JtqvIvkt.js";import"./useExecutionDebugging-GoiwhZAw.js";import"./file-saver-GLtlGJrO.js";import"./vue-json-pretty-AIiKR_BZ.js";import"./dateFormatter-e3zTcyK4.js";import"./RunDataAi-WDp0ZlAg.js";import"./workflowActivate-taS2Qpdq.js";import"./collaboration.store-emJMSzVB.js";const Q=["title"],X=["data-value","data-name","data-path","data-depth"],Y=["id"],Z=["for"],x=F({__name:"RunDataSchemaItem",props:{schema:{},level:{},parent:{},subKey:{},paneType:{},mappingEnabled:{type:Boolean},draggingPath:{},distanceFromActive:{},node:{},search:{}},setup(g){const a=g,r=p(()=>Array.isArray(a.schema.value)),c=p(()=>{var e;return((e=a.parent)==null?void 0:e.type)==="array"}),v=p(()=>a.level===0&&Array.isArray(a.schema.value)&&a.schema.value.every(e=>!Array.isArray(e.value))),d=p(()=>c.value?`[${a.schema.key}]`:a.schema.key),b=p(()=>c.value?`${a.schema.type}[${a.schema.key}]`:a.schema.key),h=p(()=>Array.isArray(a.schema.value)?"":w(a.schema.value,600,0)),_=e=>W({nodeName:a.node.name,distanceFromActive:a.distanceFromActive,path:e}),t=e=>`${e*.033}s`,m=e=>{switch(e){case"object":return"cube";case"array":return"list";case"string":case"null":return"font";case"number":return"hashtag";case"boolean":return"check-square";case"function":return"code";case"bigint":return"calculator";case"symbol":return"sun";case"undefined":return"ban"}B(e)};return(e,u)=>{var E;const y=D("font-awesome-icon"),I=D("run-data-schema-item",!0);return s(),o("div",{class:n(e.$style.item),"data-test-id":"run-data-schema-item"},[e.level>0||e.level===0&&!r.value?(s(),o("div",{key:0,title:e.schema.type,class:n({[e.$style.pill]:!0,[e.$style.mappable]:e.mappingEnabled,[e.$style.dragged]:e.draggingPath===e.schema.path})},[M("span",{class:n(e.$style.label),"data-value":_(e.schema.path),"data-name":b.value,"data-path":e.schema.path,"data-depth":e.level,"data-target":"mappable"},[A(y,{icon:m(e.schema.type),size:"sm"},null,8,["icon"]),c.value?(s(),i(S,{key:0,content:(E=a.parent)==null?void 0:E.key,search:a.search},null,8,["content","search"])):l("",!0),d.value?(s(),i(S,{key:1,class:n({[e.$style.arrayIndex]:c.value}),content:d.value,search:a.search},null,8,["class","content","search"])):l("",!0)],10,X)],10,Q)):l("",!0),h.value?(s(),o("span",{key:1,class:n(e.$style.text)},P(h.value),3)):l("",!0),e.level>0&&r.value?(s(),o("input",{key:2,id:e.subKey,type:"checkbox",checked:""},null,8,Y)):l("",!0),e.level>0&&r.value?(s(),o("label",{key:3,class:n(e.$style.toggle),for:e.subKey},[A(y,{icon:"angle-up"})],10,Z)):l("",!0),r.value?(s(),o("div",{key:4,class:n({[e.$style.sub]:!0,[e.$style.flat]:v.value})},[(s(!0),o(H,null,L(e.schema.value,(k,f)=>(s(),i(I,{key:`${k.type}-${e.level}-${f}`,schema:k,level:e.level+1,parent:e.schema,"pane-type":e.paneType,"sub-key":`${e.paneType}_${k.type}-${e.level}-${f}`,"mapping-enabled":e.mappingEnabled,"dragging-path":e.draggingPath,"distance-from-active":e.distanceFromActive,node:e.node,style:U({transitionDelay:t(f)}),search:e.search},null,8,["schema","level","parent","pane-type","sub-key","mapping-enabled","dragging-path","distance-from-active","node","style","search"]))),128))],2)):l("",!0)],2)}}}),ee="_item_dk8yb_5",ae="_sub_dk8yb_18",te="_toggle_dk8yb_24",se="_flat_dk8yb_45",ne="_pill_dk8yb_55",re="_mappable_dk8yb_74",oe="_dragged_dk8yb_82",le="_label_dk8yb_93",pe="_arrayIndex_dk8yb_98",ce="_text_dk8yb_104",me={item:ee,sub:ae,toggle:te,flat:se,pill:ne,mappable:re,dragged:oe,label:le,arrayIndex:pe,text:ce},ie={$style:me},de=T(x,[["__cssModules",ie]]),ue=F({__name:"RunDataSchema",props:{data:{},mappingEnabled:{type:Boolean},distanceFromActive:{default:0},runIndex:{},totalRuns:{},paneType:{},node:{},search:{}},setup(g){const a=g,r=j(""),c=N(),{getSchemaForExecutionData:v}=J(),d=p(()=>v(a.data)),b=p(()=>R(a.data)),h=t=>{var m;(m=t==null?void 0:t.dataset)!=null&&m.path&&(r.value=t.dataset.path),c.resetMappingTelemetry()},_=t=>{r.value="",setTimeout(()=>{var u;const m=c.mappingTelemetry,e={src_node_type:(u=a.node)==null?void 0:u.type,src_field_name:t.dataset.name||"",src_nodes_back:a.distanceFromActive,src_run_index:a.runIndex,src_runs_total:a.totalRuns,src_field_nest_level:t.dataset.depth||0,src_view:"schema",src_element:t,success:!1,...m};z().run("runDataJson.onDragEnd",e),C.track("User dragged data for mapping",e)},1e3)};return(t,m)=>{const e=D("n8n-info-tip");return s(),o("div",{class:n(t.$style.schemaWrapper)},[b.value?(s(),i(e,{key:0},{default:$(()=>[G(P(q(V).baseText("dataMapping.schemaView.emptyData")),1)]),_:1})):(s(),i(O,{key:1,type:"mapping","target-data-key":"mappable",disabled:!t.mappingEnabled,onDragstart:h,onDragend:_},{preview:$(({canDrop:u,el:y})=>[y?(s(),i(K,{key:0,html:y.outerHTML,"can-drop":u},null,8,["html","can-drop"])):l("",!0)]),default:$(()=>[M("div",{class:n(t.$style.schema)},[A(de,{schema:d.value,level:0,parent:null,"pane-type":t.paneType,"sub-key":`${d.value.type}-0-0`,"mapping-enabled":t.mappingEnabled,"dragging-path":r.value,"distance-from-active":t.distanceFromActive,node:t.node,search:t.search},null,8,["schema","pane-type","sub-key","mapping-enabled","dragging-path","distance-from-active","node","search"])],2)]),_:1},8,["disabled"]))],2)}}}),ye="_schemaWrapper_czk1f_5",he="_schema_czk1f_5",ge={schemaWrapper:ye,schema:he},ve={$style:ge},aa=T(ue,[["__cssModules",ve]]);export{aa as default};
//# sourceMappingURL=RunDataSchema-bFDumJlX.js.map
