import{s as v,m as g}from"./pinia-aUqqC48i.js";import{j as T}from"./jsonpath-0J1pRXgH.js";import{g6 as h,a9 as y,e as S,v as b,y as J,ey as $,at as C,ga as P,x as D,_ as x}from"./n8n-_nNvRoCf.js";import{m as k,j as I,c as j}from"./index-xP-VuMjv.js";import{e as N}from"./NodeView-e_zfgMVH.js";import{G as V,ag as p,l as c,m as O,M as f,O as i,R as m,S as d,T as r,p as R,I as A}from"./vendor-NNwioulI.js";import"./lodash-es-5z_C16pm.js";import"./axios-s2RMMPhA.js";import"./flatted-jPn12Tq4.js";import"./esprima-next-ulPLCZ1Z.js";import"./luxon-ZRIU05qF.js";import"./@vueuse/core-8g26_cc0.js";import"./uuid-McvpxQtQ.js";import"./vue-i18n-1PEMRmUU.js";import"./@n8n/permissions-8yMqUF1Y.js";import"./@n8n/codemirror-lang-sql-feLn5IS9.js";import"./@lezer/common-1hBQ1gIF.js";import"./codemirror-lang-html-n8n-wWQLhhqk.js";import"./prettier-s3fE3Qyr.js";import"./@jsplumb/util-DR0SB56A.js";import"./@jsplumb/core-MKwKlGip.js";import"./@jsplumb/common-Q5_tv_GT.js";import"./@jsplumb/connector-bezier-3dWY17R5.js";import"./@jsplumb/browser-ui-AlqFM-P6.js";import"./codemirror-lang-n8n-expression-HpIZnV_9.js";import"./fast-json-stable-stringify-eHEaCv8s.js";import"./timeago.js--Bumj2r9.js";import"./qrcode.vue-UdCmS1Sj.js";import"./vue3-touch-events-_RfbPMOD.js";import"./chart.js-JtqvIvkt.js";import"./useExecutionDebugging-GoiwhZAw.js";import"./file-saver-GLtlGJrO.js";import"./vue-json-pretty-AIiKR_BZ.js";import"./dateFormatter-e3zTcyK4.js";import"./RunDataAi-WDp0ZlAg.js";import"./workflowActivate-taS2Qpdq.js";import"./collaboration.store-emJMSzVB.js";const G=V({name:"RunDataJsonActions",props:{node:{type:Object},paneType:{type:String},sessionId:{type:String},currentOutputIndex:{type:Number},runIndex:{type:Number},displayMode:{type:String},distanceFromActive:{type:Number},selectedJsonPath:{type:String,default:h},jsonData:{type:Array,required:!0}},setup(){const t=y(),e=D(),o=k(),a=I(),{activeNode:s}=v(t),n=N(s);return{i18n:e,nodeHelpers:o,clipboard:a,pinnedData:n,...S()}},computed:{...g(J,y,b,j),isReadOnlyRoute(){var t,e;return((e=(t=this.$route)==null?void 0:t.meta)==null?void 0:e.readOnlyCanvas)===!0},activeNode(){return this.ndvStore.activeNode},noSelection(){return this.selectedJsonPath===h},normalisedJsonPath(){return this.noSelection?'[""]':this.selectedJsonPath}},methods:{getJsonValue(){let t=T.query(this.jsonData,`$${this.normalisedJsonPath}`)[0];if(this.noSelection){const o=window!==window.parent&&window.parent.location.pathname.includes("/executions");this.pinnedData.hasData.value&&!o?t=$(this.pinnedData.data.value):t=C(this.nodeHelpers.getNodeInputData(this.node,this.runIndex,this.currentOutputIndex))}let e="";return typeof t=="object"?e=JSON.stringify(t,null,2):e=t.toString(),e},getJsonItemPath(){const t=P(this.normalisedJsonPath);let e="",o="";const a=t.split("]"),s=a[0].slice(1);return o=a.slice(1).join("]"),e=`$item(${s}).$node["${this.node.name}"].json`,{path:o,startPath:e}},getJsonParameterPath(){const e=P(this.normalisedJsonPath).split("]").slice(1).join("]");let o=`$node["${this.node.name}"].json`;return this.distanceFromActive===1&&(o="$json"),{path:e,startPath:o}},handleCopyClick(t){let e;if(t.command==="value")e=this.getJsonValue(),this.showToast({title:this.i18n.baseText("runData.copyValue.toast"),message:"",type:"success",duration:2e3});else{let a="",s="";if(t.command==="itemPath"){const n=this.getJsonItemPath();a=n.startPath,s=n.path,this.showToast({title:this.i18n.baseText("runData.copyItemPath.toast"),message:"",type:"success",duration:2e3})}else if(t.command==="parameterPath"){const n=this.getJsonParameterPath();a=n.startPath,s=n.path,this.showToast({title:this.i18n.baseText("runData.copyParameterPath.toast"),message:"",type:"success",duration:2e3})}!s.startsWith("[")&&!s.startsWith(".")&&s&&(s+="."),e=`{{ ${a+s} }}`}const o={value:"selection",itemPath:"item_path",parameterPath:"parameter_path"}[t.command];this.$telemetry.track("User copied ndv data",{node_type:this.activeNode.type,session_id:this.sessionId,run_index:this.runIndex,view:"json",copy_type:o,workflow_id:this.workflowsStore.workflowId,pane:this.paneType,in_execution_log:this.isReadOnlyRoute}),this.clipboard.copy(e)}}}),B="_actionsGroup_1ai92_5",M={actionsGroup:B},E={class:"el-dropdown-link"};function F(t,e,o,a,s,n){const u=p("n8n-icon-button"),l=p("el-dropdown-item"),_=p("el-dropdown-menu"),w=p("el-dropdown");return c(),O("div",{class:A(t.$style.actionsGroup)},[t.noSelection?(c(),f(u,{key:0,title:t.i18n.baseText("runData.copyToClipboard"),icon:"copy",type:"tertiary",circle:!1,onClick:e[0]||(e[0]=W=>t.handleCopyClick({command:"value"}))},null,8,["title"])):(c(),f(w,{key:1,trigger:"click",onCommand:t.handleCopyClick},{dropdown:i(()=>[r(_,null,{default:i(()=>[r(l,{command:{command:"value"}},{default:i(()=>[d(m(t.i18n.baseText("runData.copyValue")),1)]),_:1}),r(l,{command:{command:"itemPath"},divided:""},{default:i(()=>[d(m(t.i18n.baseText("runData.copyItemPath")),1)]),_:1}),r(l,{command:{command:"parameterPath"}},{default:i(()=>[d(m(t.i18n.baseText("runData.copyParameterPath")),1)]),_:1})]),_:1})]),default:i(()=>[R("span",E,[r(u,{title:t.i18n.baseText("runData.copyToClipboard"),icon:"copy",type:"tertiary",circle:!1},null,8,["title"])])]),_:1},8,["onCommand"]))],2)}const H={$style:M},Dt=x(G,[["render",F],["__cssModules",H]]);export{Dt as default};
//# sourceMappingURL=RunDataJsonActions-D1RkNUsx.js.map
