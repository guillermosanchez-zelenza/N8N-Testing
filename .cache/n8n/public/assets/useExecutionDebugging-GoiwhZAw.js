import{aJ as _,e as V,af as l}from"./vendor-NNwioulI.js";import{e as S,v as W,l as B,u as C,t as I,a6 as P,V as v,m as L,dJ as h,O,x as U}from"./n8n-_nNvRoCf.js";import{a as A}from"./index-xP-VuMjv.js";const Y=()=>{const T=O(),E=_(),t=U(),N=A(),g=S(),s=W(),M=B(),d=C(),k=V(()=>M.isEnterpriseFeatureEnabled(I.DebugInEditor));return{applyExecutionData:async o=>{var D;const a=await s.getExecution(o),m=s.getCurrentWorkflow(),f=s.getNodes();if(!((D=a==null?void 0:a.data)!=null&&D.resultData))return;const{runData:b}=a.data.resultData,p=Object.keys(b),c=p.filter(e=>!f.some(i=>i.name===e)),y=Object.keys(s.workflow.pinData??{}),u=p.filter(e=>y.includes(e));if(u.length>0){const e=l("p",[t.baseText("nodeView.confirmMessage.debug.message"),l("ul",{class:"mt-l ml-l"},u.map(n=>l("li",n)))]);if(await N.confirm(e,t.baseText("nodeView.confirmMessage.debug.headline"),{type:"warning",confirmButtonText:t.baseText("nodeView.confirmMessage.debug.confirmButtonText"),cancelButtonText:t.baseText("nodeView.confirmMessage.debug.cancelButtonText"),dangerouslyUseHTMLString:!0,customClass:"matching-pinned-nodes-confirmation"})===P)u.forEach(n=>{const r=s.getNodeByName(n);r&&s.unpinData({node:r})});else{await E.push({name:v.EXECUTION_PREVIEW,params:{name:m.id,executionId:o}});return}}s.setWorkflowExecutionData(a);const w=f.filter(e=>!m.getParentNodes(e.name).length);let x=0;w.forEach(e=>{var n,r;const i=(r=(n=b[e.name])==null?void 0:n[0].data)==null?void 0:r.main[0];i&&(x++,s.pinData({node:e,data:i}))}),g.showToast({title:t.baseText("nodeView.showMessage.debug.title"),message:t.baseText("nodeView.showMessage.debug.content"),type:"info"}),c.length&&g.showToast({title:t.baseText("nodeView.showMessage.debug.missingNodes.title"),message:t.baseText("nodeView.showMessage.debug.missingNodes.content",{interpolate:{nodeNames:c.join(", ")}}),type:"warning"}),T.track("User clicked debug execution button",{instance_id:L().instanceId,exec_status:a.status,override_pinned_data:w.length===x,all_exec_data_imported:c.length===0})},handleDebugLinkClick:o=>{if(!k.value){d.openModalWithData({name:h,data:{title:t.baseText(d.contextBasedTranslationKeys.feature.unavailable.title),footerButtonAction:()=>{d.closeModal(h),d.goToUpgrade("debug","upgrade-debug")}}}),o.preventDefault(),o.stopPropagation();return}s.isInDebugMode=!1}}};export{Y as u};
//# sourceMappingURL=useExecutionDebugging-GoiwhZAw.js.map
