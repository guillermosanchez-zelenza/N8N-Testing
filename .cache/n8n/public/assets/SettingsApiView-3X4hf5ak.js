import{e as T,u as g,be as k,d as C,f as S,l as A,m as v,a6 as U,_ as P}from"./n8n-_nNvRoCf.js";import{C as I,a as K}from"./index-xP-VuMjv.js";import{m as x}from"./pinia-aUqqC48i.js";import{G as E,ag as t,l,m as h,p as s,T as i,O as a,S as n,R as o,J as M,I as r,M as m,Q as D}from"./vendor-NNwioulI.js";import"./lodash-es-5z_C16pm.js";import"./axios-s2RMMPhA.js";import"./flatted-jPn12Tq4.js";import"./esprima-next-ulPLCZ1Z.js";import"./luxon-ZRIU05qF.js";import"./@vueuse/core-8g26_cc0.js";import"./uuid-McvpxQtQ.js";import"./vue-i18n-1PEMRmUU.js";import"./@n8n/permissions-8yMqUF1Y.js";import"./@n8n/codemirror-lang-sql-feLn5IS9.js";import"./@lezer/common-1hBQ1gIF.js";import"./codemirror-lang-html-n8n-wWQLhhqk.js";import"./prettier-s3fE3Qyr.js";import"./@jsplumb/util-DR0SB56A.js";import"./@jsplumb/core-MKwKlGip.js";import"./@jsplumb/common-Q5_tv_GT.js";import"./@jsplumb/connector-bezier-3dWY17R5.js";import"./@jsplumb/browser-ui-AlqFM-P6.js";import"./codemirror-lang-n8n-expression-HpIZnV_9.js";import"./fast-json-stable-stringify-eHEaCv8s.js";import"./timeago.js--Bumj2r9.js";import"./qrcode.vue-UdCmS1Sj.js";import"./vue3-touch-events-_RfbPMOD.js";import"./chart.js-JtqvIvkt.js";const V=E({name:"SettingsApiView",components:{CopyInput:I},setup(){return{...T(),...K(),...g()}},data(){return{loading:!1,mounted:!1,apiKey:"",swaggerUIEnabled:!1,apiDocsURL:""}},mounted(){if(!this.isPublicApiEnabled)return;this.getApiKey();const e=this.rootStore.baseUrl,p=this.settingsStore.publicApiPath,c=this.settingsStore.publicApiLatestVersion;this.swaggerUIEnabled=this.settingsStore.isSwaggerUIEnabled,this.apiDocsURL=this.swaggerUIEnabled?`${e}${p}/v${c}/docs`:`https://${k}/api/api-reference/`},computed:{...x(v,A,S,C,g),currentUser(){return this.usersStore.currentUser},isTrialing(){return this.cloudPlanStore.userIsTrialing},isLoadingCloudPlans(){return this.cloudPlanStore.state.loadingPlan},isPublicApiEnabled(){return this.settingsStore.isPublicApiEnabled}},methods:{onUpgrade(){this.uiStore.goToUpgrade("settings-n8n-api","upgrade-api","redirect")},async showDeleteModal(){await this.confirm(this.$locale.baseText("settings.api.delete.description"),this.$locale.baseText("settings.api.delete.title"),{confirmButtonText:this.$locale.baseText("settings.api.delete.button"),cancelButtonText:this.$locale.baseText("generic.cancel")})===U&&await this.deleteApiKey()},async getApiKey(){try{this.apiKey=await this.settingsStore.getApiKey()||""}catch(e){this.showError(e,this.$locale.baseText("settings.api.view.error"))}finally{this.mounted=!0}},async createApiKey(){this.loading=!0;try{this.apiKey=await this.settingsStore.createApiKey()||""}catch(e){this.showError(e,this.$locale.baseText("settings.api.create.error"))}finally{this.loading=!1,this.$telemetry.track("User clicked create API key button")}},async deleteApiKey(){try{await this.settingsStore.deleteApiKey(),this.showMessage({title:this.$locale.baseText("settings.api.delete.toast"),type:"success"}),this.apiKey=""}catch(e){this.showError(e,this.$locale.baseText("settings.api.delete.error"))}finally{this.$telemetry.track("User clicked delete API key button")}},onCopy(){this.$telemetry.track("User clicked copy API key button")}}}),z="_container_1teme_5",L="_header_1teme_9",B="_card_1teme_18",N="_hint_1teme_29",R={container:z,header:L,card:B,delete:"_delete_1teme_22",hint:N},O={key:0},F={class:"mb-s"},G=["textContent"],J=["textContent"];function Q(e,p,c,q,H,W){const b=t("n8n-heading"),y=t("i18n-t"),$=t("n8n-info-tip"),d=t("n8n-link"),f=t("CopyInput"),_=t("n8n-card"),w=t("n8n-text"),u=t("n8n-action-box");return l(),h("div",{class:r(e.$style.container)},[s("div",{class:r(e.$style.header)},[i(b,{size:"2xlarge"},{default:a(()=>[n(o(e.$locale.baseText("settings.api"))+" ",1),s("span",{style:M({fontSize:"var(--font-size-s)",color:"var(--color-text-light)"})}," ("+o(e.$locale.baseText("beta"))+") ",5)]),_:1})],2),e.apiKey?(l(),h("div",O,[s("p",F,[i($,{bold:!1},{default:a(()=>[i(y,{keypath:"settings.api.view.info",tag:"span"},{apiAction:a(()=>[s("a",{href:"https://docs.n8n.io/api",target:"_blank",textContent:o(e.$locale.baseText("settings.api.view.info.api"))},null,8,G)]),webhookAction:a(()=>[s("a",{href:"https://docs.n8n.io/integrations/core-nodes/n8n-nodes-base.webhook/",target:"_blank",textContent:o(e.$locale.baseText("settings.api.view.info.webhook"))},null,8,J)]),_:1})]),_:1})]),i(_,{class:r(["mb-4xs",e.$style.card])},{default:a(()=>[s("span",{class:r(e.$style.delete)},[i(d,{bold:!0,onClick:e.showDeleteModal},{default:a(()=>[n(o(e.$locale.baseText("generic.delete")),1)]),_:1},8,["onClick"])],2),s("div",null,[i(f,{label:e.$locale.baseText("settings.api.view.myKey"),value:e.apiKey,"copy-button-text":e.$locale.baseText("generic.clickToCopy"),"toast-title":e.$locale.baseText("settings.api.view.copy.toast"),"redact-value":!0,onCopy:e.onCopy},null,8,["label","value","copy-button-text","toast-title","onCopy"])])]),_:1},8,["class"]),s("div",{class:r(e.$style.hint)},[i(w,{size:"small"},{default:a(()=>[n(o(e.$locale.baseText(`settings.api.view.${e.swaggerUIEnabled?"tryapi":"more-details"}`)),1)]),_:1}),n(" "+o(" ")+" "),i(d,{to:e.apiDocsURL,"new-window":!0,size:"small"},{default:a(()=>[n(o(e.$locale.baseText(`settings.api.view.${e.swaggerUIEnabled?"apiPlayground":"external-docs"}`)),1)]),_:1},8,["to"])],2)])):!e.isPublicApiEnabled&&e.isTrialing?(l(),m(u,{key:1,"data-test-id":"public-api-upgrade-cta",heading:e.$locale.baseText("settings.api.trial.upgradePlan.title"),description:e.$locale.baseText("settings.api.trial.upgradePlan.description"),"button-text":e.$locale.baseText("settings.api.trial.upgradePlan.cta"),"onClick:button":e.onUpgrade},null,8,["heading","description","button-text","onClick:button"])):e.mounted&&!e.isLoadingCloudPlans?(l(),m(u,{key:2,"button-text":e.$locale.baseText(e.loading?"settings.api.create.button.loading":"settings.api.create.button"),description:e.$locale.baseText("settings.api.create.description"),"onClick:button":e.createApiKey},null,8,["button-text","description","onClick:button"])):D("",!0)],2)}const j={$style:R},Se=P(V,[["render",Q],["__cssModules",j]]);export{Se as default};
//# sourceMappingURL=SettingsApiView-3X4hf5ak.js.map
