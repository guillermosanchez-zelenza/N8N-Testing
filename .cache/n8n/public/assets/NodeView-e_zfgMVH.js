import{u as le,y as j,v as z,q as se,x as ge,ea as an,eb as rn,dN as ke,_ as L,a9 as q,ec as Wn,ed as Vn,bd as ln,aI as dn,N as _,a5 as be,e as Le,ee as Qt,ef as Bn,cT as Pe,az as Ge,d0 as re,m as un,eg as Un,eh as Ln,ei as Ze,ej as xn,ek as Hn,el as gt,O as Fn,b5 as Je,Z as Ce,dg as X,a6 as Ve,B as cn,d8 as Zt,J as pe,em as zn,en as We,o as Ee,a3 as Be,aM as Mt,eo as ut,d4 as Ie,ep as eo,eq as Yn,er as to,es as hn,ai as vt,et as Kn,eu as jn,ev as qn,cP as oo,b3 as Pt,at as no,ew as Gn,a8 as ve,ex as ye,ey as so,ez as Jn,eA as Xn,eB as io,eC as Ot,cH as Te,z as Wt,eD as Qn,eE as Zn,k as pn,d6 as dt,V as F,d2 as es,l as fn,eF as ts,eG as os,t as gn,eH as ns,eI as ss,eJ as is,eK as as,eL as rs,d_ as ls,cR as ds,eM as us,F as cs,D as Nt,r as et,eN as mn,eO as ie,eP as Xe,cY as Vt,b as hs,S as ps,eQ as Ue,eR as ct,eS as Bt,eT as ao,eU as ro,eV as lo,eW as uo,eX as co,eY as ho,eZ as po,e_ as fo,e$ as go,f0 as mo,f1 as fs,b6 as yo,f2 as wo,f3 as vo,f4 as $t,f5 as gs,f6 as ms,f7 as No,b7 as ys,ay as ko,f8 as ws,f9 as bo,fa as vs,fb as Ns,fc as ks,fd as bs,fe as Ts,ff as To,fg as Ss,fh as Ds,fi as Es,fj as So,fk as Do,fl as Cs,fm as Is,fn as Eo,fo as Ps,af as Os,fp as Co,fq as Io,a1 as $s,c_ as Rs,cZ as _s,c$ as As,fr as Ms,fs as Po,M as He,$ as Fe,ft as Ws,cQ as Vs,f as Bs,d1 as Us,fu as ue,cI as Ls,cJ as xs,cK as Hs,bs as Fs,cX as zs,cS as kt,a7 as Ys,fv as Ks,fw as js,e8 as qs,fx as Gs}from"./n8n-_nNvRoCf.js";import{m as G,s as mt,d as Ut}from"./pinia-aUqqC48i.js";import{_ as Oo,$ as $o,a0 as Ro,a1 as tt}from"./@jsplumb/core-MKwKlGip.js";import{c as Lt,g as ht,h as yn,b as xt,i as Js,N as yt,w as Oe,j as Ht,k as pt,a as Ft,l as Xs,P as Qs,m as xe,n as wn,o as zt,R as vn,J as Zs,C as ei,p as _o,q as Rt,r as Nn,t as bt,v as ti,x as oi,y as _t,z as ze,A as ni,B as si,E as ii,K as ai,D as ot,F as ri,G as li,H as di,I as ui,u as ci,L as hi,M as nt,s as Ao,O as ee,Q as pi,U as fi,V as gi,W as _e,X as Ye,Y as mi,Z as yi,_ as Tt,$ as wi,a0 as Mo,a1 as st,a2 as vi,a3 as Ni,a4 as ki,a5 as bi,a6 as Ti,a7 as Si,a8 as Di,a9 as Wo,aa as Vo,ab as Bo,ac as St,ad as Ei,ae as Uo,af as Lo,ag as Ci,ah as it,ai as xo,aj as Ho,ak as Ii,al as Pi,am as Fo,an as zo,ao as Oi,ap as $i,aq as Ri,ar as _i,as as Ai,at as Mi,au as Wi}from"./index-xP-VuMjv.js";import{r as H,e as K,d as kn,b as bn,G as x,ag as S,l as c,m as b,p as g,T as m,I as D,O as y,S as I,R as T,M as P,Q as C,a8 as Yo,a2 as te,F as Q,a7 as ae,aw as Tn,ax as Sn,u as B,K as Vi,V as Y,U as J,H as ne,a5 as Dn,J as oe,P as En,y as Bi,X as Ui,aE as Se,aG as we,a9 as Yt,aN as Li,W as xi,aq as Kt,n as Cn}from"./vendor-NNwioulI.js";import{u as Hi}from"./useExecutionDebugging-GoiwhZAw.js";import{g as ce,s as Ae,x as Dt,z as Fi}from"./lodash-es-5z_C16pm.js";import{F as Et}from"./file-saver-GLtlGJrO.js";import{V as In}from"./vue-json-pretty-AIiKR_BZ.js";import{c as zi}from"./dateFormatter-e3zTcyK4.js";import Yi from"./RunDataAi-WDp0ZlAg.js";import{w as Ko}from"./workflowActivate-taS2Qpdq.js";import{v as he}from"./uuid-McvpxQtQ.js";import{a as Ki,u as ji}from"./collaboration.store-emJMSzVB.js";import{g as qi,f as at,h as jo,a as qo,E as Go,b as Jo,d as Xo,i as rt}from"./@jsplumb/browser-ui-AlqFM-P6.js";const Ct=H([0,0]),Ke=H(!1),je=H({source:"canvas"}),lt=H([]),Qo=H(()=>{}),Qe=(e=()=>{})=>{const t=le(),o=j(),n=z(),s=Lt(),{getInputDataWithPinned:i}=yn(),a=ge(),r=K(()=>s.preferences.branchReadOnly||t.isReadOnlyView),l=K(()=>{if(!Ke.value)return[];const u=t.selectedNodes.map(v=>n.getNodeByName(v.name)),k=je.value;return k.source==="canvas"?u:k.source==="node-right-click"?u.some($=>$.name===k.node.name)?u:[k.node]:[k.node]}),d=u=>{const k=n.allNodes.filter(v=>v.type===u.name);return u.maxNodes===void 0||k.length<u.maxNodes},h=u=>{const k=o.getNodeType(u.type,u.typeVersion);return!k||an.includes(k.name)?!1:d(k)},p=u=>{const k=o.getNodeType(u.type,u.typeVersion),v=i(u);return!k||v.length===0?!1:k.outputs.length===1&&!rn.includes(u.type)},w=u=>!!n.pinDataByNodeName(u.name),f=()=>{je.value={source:"canvas"},Ke.value=!1,lt.value=[],Ct.value=[0,0]},N=(u,k={source:"canvas"})=>{if(u.stopPropagation(),Ke.value&&k.source===je.value.source){f();return}u.preventDefault(),Qo.value=e,je.value=k,Ct.value=ht(u),Ke.value=!0;const v=l.value,$=v.every(A=>A.type===se),M={adjustToNumber:v.length,interpolate:{subject:$?a.baseText("contextMenu.sticky",{adjustToNumber:v.length}):a.baseText("contextMenu.node",{adjustToNumber:v.length})}},R=[{id:"select_all",divided:!0,label:a.baseText("contextMenu.selectAll"),shortcut:{metaKey:!0,keys:["A"]},disabled:v.length===n.allNodes.length},{id:"deselect_all",label:a.baseText("contextMenu.deselectAll"),disabled:v.length===0}];if(v.length===0)lt.value=[{id:"add_node",shortcut:{keys:["Tab"]},label:a.baseText("contextMenu.addNode"),disabled:r.value},{id:"add_sticky",shortcut:{shiftKey:!0,keys:["s"]},label:a.baseText("contextMenu.addSticky"),disabled:r.value},...R];else{const A=[!$&&{id:"toggle_activation",label:v.every(O=>O.disabled)?a.baseText("contextMenu.activate",M):a.baseText("contextMenu.deactivate",M),shortcut:{keys:["D"]},disabled:r.value},!$&&{id:"toggle_pin",label:v.every(O=>w(O))?a.baseText("contextMenu.unpin",M):a.baseText("contextMenu.pin",M),shortcut:{keys:["p"]},disabled:r.value||!v.every(p)},{id:"copy",label:a.baseText("contextMenu.copy",M),shortcut:{metaKey:!0,keys:["C"]}},{id:"duplicate",label:a.baseText("contextMenu.duplicate",M),shortcut:{metaKey:!0,keys:["D"]},disabled:r.value||!v.every(h)},...R,{id:"delete",divided:!0,label:a.baseText("contextMenu.delete",M),shortcut:{keys:["Del"]},disabled:r.value}].filter(Boolean);if(v.length===1){const O=$?[{id:"open",label:a.baseText("contextMenu.editSticky"),shortcut:{keys:["↵"]},disabled:r.value},{id:"change_color",label:a.baseText("contextMenu.changeColor"),disabled:r.value}]:[{id:"open",label:a.baseText("contextMenu.open"),shortcut:{keys:["↵"]}},{id:"execute",label:a.baseText("contextMenu.test"),disabled:r.value},{id:"rename",label:a.baseText("contextMenu.rename"),shortcut:{keys:["F2"]},disabled:r.value}];A.unshift(...O)}lt.value=A}},E=u=>{Qo.value(u,l.value)};return kn(()=>t.nodeViewOffsetPosition,()=>{f()}),{isOpen:Ke,position:Ct,target:je,actions:lt,targetNodes:l,open:N,close:f,_dispatchAction:E}};function Gi(){const e=H(!1),t=H(document.createElement("span")),{isTouchDevice:o,isCtrlKeyPressed:n}=ke(),s=le(),i=xt(),a=z(),{isOpen:r}=Qe();function l(O){Object.assign(t.value.style,O)}function d(O){const[W,V]=v(O);t.value=Object.assign(t.value,{x:W,y:V}),l({left:t.value.x+"px",top:t.value.y+"px",visibility:"visible"}),e.value=!0}function h(O){const W=w(O);l({left:W.x+"px",top:W.y+"px",width:W.width+"px",height:W.height+"px"})}function p(){t.value.x=0,t.value.y=0,l({visibility:"hidden",left:"0px",top:"0px",width:"0px",height:"0px"}),e.value=!1}function w(O){const[W,V]=v(O);return{x:Math.min(W,t.value.x),y:Math.min(V,t.value.y),width:Math.abs(W-t.value.x),height:Math.abs(V-t.value.y)}}function f(O){const W=[],V=w(O);return a.allNodes.forEach(Z=>{Z.position[0]<V.x||Z.position[0]>V.x+V.width||Z.position[1]<V.y||Z.position[1]>V.y+V.height||W.push(Z)}),W}function N(){t.value.id="select-box",l({margin:"0px auto",border:"2px dotted #FF0000",position:"absolute",zIndex:"100",visibility:"hidden"}),t.value.addEventListener("mouseup",u),document.querySelector("#node-view").appendChild(t.value)}function E(O){if(O.buttons===0){u(O);return}h(O)}function u(O){if(O.button===2||r.value)return;if(!e.value){o&&O.target instanceof HTMLElement&&O.target&&O.target.id.includes("node-view")&&R();return}document.removeEventListener("mousemove",E),R();const W=f(O);W.forEach(V=>{M(V)}),W.length===1&&(s.lastSelectedNode=W[0].name),p()}function k(O,W){n(O)||W||O.button===2||s.isActionActive("dragActive")||(d(O),document.addEventListener("mousemove",E))}function v(O){const W=ht(O),[V,Z]=i.canvasPositionFromPagePosition(W),fe=i.nodeViewScale,$e=s.nodeViewOffsetPosition;return Js(V,Z,fe,$e)}function $(O){s.removeNodeFromSelection(O),A.value.removeFromDragSelection(A.value.getManagedElement(O==null?void 0:O.id))}function M(O){s.addSelectedNode(O),A.value.addToDragSelection(A.value.getManagedElement(O==null?void 0:O.id))}function R(){A.value.clearDragSelection(),s.resetSelectedNodes(),s.lastSelectedNode=null,s.lastSelectedNodeOutputIndex=null,i.lastSelectedConnection=null,i.newNodeInsertPosition=null}const A=K(()=>i.jsPlumbInstance);return bn(()=>{N()}),{selectActive:e,getMousePositionWithinNodeView:v,mouseUpMouseSelect:u,mouseDownMouseSelect:k,nodeDeselected:$,nodeSelected:M,deselectAllNodes:R}}function Ji(){function e(){return j().allNodeTypes.reduce((o,n)=>{if(typeof n.defaults.name!="string")throw new Error("Expected node name default to be a string");return/\d$/.test(n.defaults.name)&&o.push(n.defaults.name),o},[])}function t(o,n=[]){var h,p;const{canvasNames:s}=z();if(!s.has(o)&&!n.includes(o))return o;const a=e().find(w=>o.startsWith(w));if(a){let w="",f=1;const N=o.split(a).pop(),E=N==null?void 0:N[N.length-1];for(E&&Number.isInteger(Number(E))&&(f=parseInt(E,10),o=o.slice(0,-1)),w=o;s.has(w)||n.includes(w);)w=o+f++;return w}if(/^\d+-?\d*$/.test(o)){let w="",f=1;const N=o.match(/(?<base>\d+)-?(?<suffix>\d*)/);if(!(N!=null&&N.groups))throw new Error("Failed to find match for unique name");for(((h=N==null?void 0:N.groups)==null?void 0:h.suffix)!==""&&(f=parseInt(N.groups.suffix,10)),w=N.groups.base;s.has(w)||n.includes(w);)w=N.groups.base+"-"+f++;return w}let r="",l=1;const d=o.match(/(?<base>.*\D+)(?<suffix>\d*)/);if(!(d!=null&&d.groups))throw new Error("Failed to find match for unique name");for(((p=d==null?void 0:d.groups)==null?void 0:p.suffix)!==""&&(l=parseInt(d.groups.suffix,10)),r=d.groups.base;s.has(r)||n.includes(r);)r=d.groups.base+l++;return r}return{uniqueNodeName:t}}const Xi=x({name:"NodeTitle",components:{NodeIcon:yt},props:{modelValue:{type:String,default:""},nodeType:{},readOnly:{type:Boolean,default:!1}},data(){return{editName:!1,newName:""}},computed:{editable(){return!this.readOnly&&window===window.parent}},methods:{async onEdit(){this.newName=this.modelValue,this.editName=!0,await this.$nextTick();const e=this.$refs.input;e&&e.focus()},onRename(){this.newName.trim()!==""&&this.$emit("update:modelValue",this.newName.trim()),this.editName=!1}}}),Qi="_container_15oh7_5",Zi="_title_15oh7_15",ea="_hoverable_15oh7_23",ta="_editIcon_15oh7_26",oa="_iconWrapper_15oh7_30",na="_editIconContainer_15oh7_43",sa="_editButtons_15oh7_49",ia="_editContainer_15oh7_57",aa={container:Qi,title:Zi,hoverable:ea,editIcon:ta,iconWrapper:oa,editIconContainer:na,editButtons:sa,editContainer:ia};function ra(e,t,o,n,s,i){const a=S("NodeIcon"),r=S("n8n-text"),l=S("n8n-input"),d=S("n8n-button"),h=S("font-awesome-icon"),p=S("n8n-popover");return c(),b("span",{class:D(e.$style.container),"data-test-id":"node-title-container",onClick:t[5]||(t[5]=(...w)=>e.onEdit&&e.onEdit(...w))},[g("span",{class:D(e.$style.iconWrapper)},[m(a,{"node-type":e.nodeType,size:18},null,8,["node-type"])],2),m(p,{placement:"right",width:"200",visible:e.editName,disabled:!e.editable},{reference:y(()=>[g("div",{class:D({[e.$style.title]:!0,[e.$style.hoverable]:e.editable})},[I(T(e.modelValue)+" ",1),g("div",{class:D(e.$style.editIconContainer)},[e.editable?(c(),P(h,{key:0,class:D(e.$style.editIcon),icon:"pencil-alt"},null,8,["class"])):C("",!0)],2)],2)]),default:y(()=>[g("div",{class:D(e.$style.editContainer),onKeydown:[t[2]||(t[2]=Yo((...w)=>e.onRename&&e.onRename(...w),["enter"])),t[3]||(t[3]=te(()=>{},["stop"])),t[4]||(t[4]=Yo(w=>e.editName=!1,["esc"]))]},[m(r,{bold:!0,color:"text-base",tag:"div"},{default:y(()=>[I(T(e.$locale.baseText("ndv.title.renameNode")),1)]),_:1}),m(l,{ref:"input",modelValue:e.newName,"onUpdate:modelValue":t[0]||(t[0]=w=>e.newName=w),size:"small","data-test-id":"node-rename-input"},null,8,["modelValue"]),g("div",{class:D(e.$style.editButtons)},[m(d,{type:"secondary",size:"small",label:e.$locale.baseText("ndv.title.cancel"),onClick:t[1]||(t[1]=w=>e.editName=!1)},null,8,["label"]),m(d,{type:"primary",size:"small",label:e.$locale.baseText("ndv.title.rename"),onClick:e.onRename},null,8,["label","onClick"])],2)],34)]),_:1},8,["visible","disabled"])],2)}const la={$style:aa},da=L(Xi,[["render",ra],["__cssModules",la]]),ua=x({name:"NodeSettingsTabs",props:{modelValue:{type:String,default:""},nodeType:{},sessionId:{type:String}},setup(){return{externalHooks:be()}},computed:{...G(q,z),activeNode(){return this.ndvStore.activeNode},documentationUrl(){var n,s,i,a;const e=this.nodeType;if(!e)return"";if(e.documentationUrl&&e.documentationUrl.startsWith("http"))return e.documentationUrl;const t="?utm_source=n8n_app&utm_medium=node_settings_modal-credential_link&utm_campaign="+e.name,o=(a=(i=(s=(n=e.codex)==null?void 0:n.resources)==null?void 0:s.primaryDocumentation)==null?void 0:i[0])==null?void 0:a.url;return o?o+t:this.isCommunityNode?`${Wn}${e.name.split(".")[0]}`:Vn+t},isCommunityNode(){const e=this.nodeType;return e?ln(e.name):!1},packageName(){return this.nodeType.name.split(".")[0]},options(){const e=[{label:this.$locale.baseText("nodeSettings.parameters"),value:"params"}];this.documentationUrl&&e.push({label:this.$locale.baseText("nodeSettings.docs"),value:"docs",href:this.documentationUrl}),this.isCommunityNode&&e.push({icon:"cube",value:"communityNode",align:"right",tooltip:this.$locale.baseText("generic.communityNode.tooltip",{interpolate:{docUrl:dn,packageName:this.packageName}})});const t=!this.isCommunityNode;return e.push({icon:"cog",value:"settings",align:t?"right":void 0}),e}},methods:{onTabSelect(e){e==="docs"&&this.nodeType&&(this.externalHooks.run("dataDisplay.onDocumentationUrlClick",{nodeType:this.nodeType,documentationUrl:this.documentationUrl}),this.$telemetry.track("User clicked ndv link",{node_type:this.activeNode.type,workflow_id:this.workflowsStore.workflowId,session_id:this.sessionId,pane:_.Main,type:"docs"})),e==="settings"&&this.nodeType&&this.$telemetry.track("User viewed node settings",{node_type:this.nodeType.name,workflow_id:this.workflowsStore.workflowId}),(e==="settings"||e==="params")&&this.$emit("update:modelValue",e)},onTooltipClick(e,t){e==="communityNode"&&t.target.localName==="a"&&this.$telemetry.track("user clicked cnr docs link",{source:"node details view"})}}});function ca(e,t,o,n,s,i){const a=S("n8n-tabs");return c(),P(a,{options:e.options,"model-value":e.modelValue,"onUpdate:modelValue":e.onTabSelect,onTooltipClick:e.onTooltipClick},null,8,["options","model-value","onUpdate:modelValue","onTooltipClick"])}const ha=L(ua,[["render",ca]]),pa=x({name:"NodeWebhooks",mixins:[Oe],props:["node","nodeType"],setup(){return{clipboard:Ht(),...Le()}},data(){return{isMinimized:this.nodeType&&!Qt.includes(this.nodeType.name),showUrlFor:"test"}},computed:{isProductionOnly(){return this.nodeType&&Bn.includes(this.nodeType.name)},urlOptions(){return[...this.isProductionOnly?[]:[{label:this.baseText.testUrl,value:"test"}],{label:this.baseText.productionUrl,value:"production"}]},visibleWebhookUrls(){return this.webhooksNode.filter(e=>typeof e.ndvHideUrl=="string"?!this.getWebhookExpressionValue(e,"ndvHideUrl"):!e.ndvHideUrl)},webhooksNode(){return this.nodeType===null||this.nodeType.webhooks===void 0?[]:this.nodeType.webhooks.filter(e=>e.restartWebhook!==!0)},baseText(){switch(this.nodeType.name){case Ge:return{toggleTitle:this.$locale.baseText("nodeWebhooks.webhookUrls.chatTrigger"),clickToDisplay:this.$locale.baseText("nodeWebhooks.clickToDisplayWebhookUrls.formTrigger"),clickToHide:this.$locale.baseText("nodeWebhooks.clickToHideWebhookUrls.chatTrigger"),clickToCopy:this.$locale.baseText("nodeWebhooks.clickToCopyWebhookUrls.chatTrigger"),testUrl:this.$locale.baseText("nodeWebhooks.testUrl"),productionUrl:this.$locale.baseText("nodeWebhooks.productionUrl"),copyTitle:this.$locale.baseText("nodeWebhooks.showMessage.title.chatTrigger"),copyMessage:this.$locale.baseText("nodeWebhooks.showMessage.message.chatTrigger")};case Pe:return{toggleTitle:this.$locale.baseText("nodeWebhooks.webhookUrls.formTrigger"),clickToDisplay:this.$locale.baseText("nodeWebhooks.clickToDisplayWebhookUrls.formTrigger"),clickToHide:this.$locale.baseText("nodeWebhooks.clickToHideWebhookUrls.formTrigger"),clickToCopy:this.$locale.baseText("nodeWebhooks.clickToCopyWebhookUrls.formTrigger"),testUrl:this.$locale.baseText("nodeWebhooks.testUrl"),productionUrl:this.$locale.baseText("nodeWebhooks.productionUrl"),copyTitle:this.$locale.baseText("nodeWebhooks.showMessage.title.formTrigger"),copyMessage:this.$locale.baseText("nodeWebhooks.showMessage.message.formTrigger")};default:return{toggleTitle:this.$locale.baseText("nodeWebhooks.webhookUrls"),clickToDisplay:this.$locale.baseText("nodeWebhooks.clickToDisplayWebhookUrls"),clickToHide:this.$locale.baseText("nodeWebhooks.clickToHideWebhookUrls"),clickToCopy:this.$locale.baseText("nodeWebhooks.clickToCopyWebhookUrls"),testUrl:this.$locale.baseText("nodeWebhooks.testUrl"),productionUrl:this.$locale.baseText("nodeWebhooks.productionUrl"),copyTitle:this.$locale.baseText("nodeWebhooks.showMessage.title"),copyMessage:void 0}}}},watch:{node(){this.isMinimized=!Qt.includes(this.nodeType.name)}},methods:{copyWebhookUrl(e){const t=this.getWebhookUrlDisplay(e);this.clipboard.copy(t),this.showMessage({title:this.baseText.copyTitle,message:this.baseText.copyMessage,type:"success"}),this.$telemetry.track("User copied webhook URL",{pane:"parameters",type:`${this.showUrlFor} url`})},getWebhookUrlDisplay(e){return this.node?this.getWebhookUrl(e,this.node,this.isProductionOnly?"production":this.showUrlFor):""},isWebhookMethodVisible(e){return typeof e.ndvHideMethod=="string"?!this.getWebhookExpressionValue(e,"ndvHideMethod"):!e.ndvHideMethod}}}),jt=e=>(Tn("data-v-bce5e163"),e=e(),Sn(),e),fa={key:0,class:"webhooks"},ga=["title"],ma={key:0,class:"node-webhooks"},ya={key:0,class:"url-selection"},wa={key:0,class:"webhook-wrapper"},va={class:"http-field"},Na={class:"http-method"},ka=jt(()=>g("br",null,null,-1)),ba={class:"url-field"},Ta=["onClick"],Sa=jt(()=>g("br",null,null,-1)),Da={key:1,class:"webhook-wrapper"},Ea={class:"url-field-full-width"},Ca=["onClick"],Ia=jt(()=>g("br",null,null,-1));function Pa(e,t,o,n,s,i){const a=S("font-awesome-icon"),r=S("n8n-radio-buttons"),l=S("el-col"),d=S("el-row"),h=S("n8n-tooltip"),p=S("el-collapse-transition");return e.webhooksNode.length&&e.visibleWebhookUrls.length>0?(c(),b("div",fa,[g("div",{class:D(["clickable headline",{expanded:!e.isMinimized}]),title:e.isMinimized?e.baseText.clickToDisplay:e.baseText.clickToHide,onClick:t[0]||(t[0]=w=>e.isMinimized=!e.isMinimized)},[m(a,{icon:"angle-right",class:"minimize-button minimize-icon"}),I(" "+T(e.baseText.toggleTitle),1)],10,ga),m(p,null,{default:y(()=>[e.isMinimized?C("",!0):(c(),b("div",ma,[e.isProductionOnly?C("",!0):(c(),b("div",ya,[m(d,null,{default:y(()=>[m(l,{span:24},{default:y(()=>[m(r,{modelValue:e.showUrlFor,"onUpdate:modelValue":t[1]||(t[1]=w=>e.showUrlFor=w),options:e.urlOptions},null,8,["modelValue","options"])]),_:1})]),_:1})])),(c(!0),b(Q,null,ae(e.visibleWebhookUrls,(w,f)=>(c(),P(h,{key:f,class:"item",content:e.baseText.clickToCopy,placement:"left"},{default:y(()=>[e.isWebhookMethodVisible(w)?(c(),b("div",wa,[g("div",va,[g("div",Na,[I(T(e.getWebhookExpressionValue(w,"httpMethod")),1),ka])]),g("div",ba,[g("div",{class:"webhook-url left-ellipsis clickable",onClick:N=>e.copyWebhookUrl(w)},[I(T(e.getWebhookUrlDisplay(w)),1),Sa],8,Ta)])])):(c(),b("div",Da,[g("div",Ea,[g("div",{class:"webhook-url left-ellipsis clickable",onClick:N=>e.copyWebhookUrl(w)},[I(T(e.getWebhookUrlDisplay(w)),1),Ia],8,Ca)])]))]),_:2},1032,["content"]))),128))]))]),_:1})])):C("",!0)}const Oa=L(pa,[["render",Pa],["__scopeId","data-v-bce5e163"]]);function Pn(e={}){const t=j(),o=K(()=>{if(e.nodeType)return B(e.nodeType);const i=B(e.node);return i?t.getNodeType(i.type,i.typeVersion):null}),n=K(()=>{var a,r,l;if(!((a=o.value)!=null&&a.outputs)||typeof((r=o.value)==null?void 0:r.outputs)=="string")return!1;const i=re((l=o.value)==null?void 0:l.outputs);return i?i.filter(d=>d!==_.Main).length>0:!1}),s=K(()=>{var i;return(((i=o.value)==null?void 0:i.outputs)??[]).length>1});return{nodeType:o,isSubNodeType:n,isMultipleOutputsNodeType:s}}function Ne(e,t={}){const o=un(),n=z(),s=Le(),i=ge(),a=Fn(),r=be(),{sessionId:l}=mt(o),{isSubNodeType:d,isMultipleOutputsNodeType:h}=Pn({node:e}),p=K(()=>{const R=B(e);return R?n.pinDataByNodeName(R.name):void 0}),w=K(()=>!!B(e)&&typeof p.value<"u"),f=K(()=>{const R=B(e);return!!R&&!d.value&&!h.value&&!rn.includes(R.type)});function N(R){try{return JSON.parse(R),!0}catch(A){const O=i.baseText("runData.editOutputInvalid"),W=new RegExp(/JSON\.parse:|of the JSON data/,"g"),V=A.message.replace(W,"").trim(),Z=/at position (\d+)/,fe=A.message.match(Z);if(A.message=V.charAt(0).toUpperCase()+V.slice(1),A.message=A.message.replace("Unexpected token ' in JSON",i.baseText("runData.editOutputInvalid.singleQuote")),fe){const $e=parseInt(fe[1],10),wt=(R.slice(0,$e).match(/\n/g)||[]).length;A.message=A.message.replace(Z,i.baseText("runData.editOutputInvalid.atPosition",{interpolate:{position:`${$e}`}})),A.message=`${i.baseText("runData.editOutputInvalid.onLine",{interpolate:{line:`${wt+1}`}})} ${A.message}`}return s.showError(A,O),!1}}function E(R){const A=B(e);if(!A)return!1;typeof R=="object"&&(R=JSON.stringify(R));const{pinData:O,...W}=n.getCurrentWorkflow(),V=Un(W,{replaceCircularRefs:!0}),Z={...O,[A.name]:R},fe=n.getPinDataSize(Z);return fe>Ln?(s.showError(new Error(i.baseText("ndv.pinData.error.tooLarge.description")),i.baseText("ndv.pinData.error.tooLarge.title")),!1):Ze(V)+fe>xn-Hn?(s.showError(new Error(i.baseText("ndv.pinData.error.tooLargeWorkflow.description")),i.baseText("ndv.pinData.error.tooLargeWorkflow.title")),!1):!0}function u({source:R}){const A=B(e),O=B(t.displayMode),W=B(t.runIndex),V={pinning_source:R,node_type:A==null?void 0:A.type,session_id:l.value,data_size:Ze(p.value),view:O,run_index:W};r.run("runData.onDataPinningSuccess",V),a.track("Ndv data pinning success",V)}function k({errorType:R,source:A}){const O=B(e),W=B(t.displayMode),V=B(t.runIndex);a.track("Ndv data pinning failure",{pinning_source:A,node_type:O==null?void 0:O.type,session_id:l.value,data_size:Ze(p.value),view:W,run_index:V,error_type:R})}function v(R,A){const O=B(e);if(O){if(typeof R=="string"){if(!N(R))throw k({errorType:"invalid-json",source:A}),new Error("Invalid JSON");R=gt(R)}if(!E(R))throw k({errorType:"data-too-large",source:A}),new Error("Data too large");n.pinData({node:O,data:R}),u({source:A})}}function $({source:R}){const A=B(e),O=B(t.runIndex);a.track("User unpinned ndv data",{node_type:A==null?void 0:A.type,session_id:l.value,run_index:O,source:R,data_size:Ze(p.value)})}function M(R){const A=B(e);A&&($({source:R}),n.unpinData({node:A}))}return{data:p,hasData:w,isValidNodeType:f,setData:v,onSetDataSuccess:u,onSetDataError:k,unsetData:M,onUnsetData:$,isValidJSON:N,isValidSize:E}}const $a=x({mixins:[pt],inheritAttrs:!1,props:{nodeName:{type:String,required:!0},disabled:{type:Boolean,default:!1},label:{type:String},type:{type:String},size:{type:String},transparent:{type:Boolean,default:!1},telemetrySource:{type:String}},setup(e,t){var a,r;const n=z().getNodeByName(e.nodeName),s=Ne(n);return{externalHooks:be(),pinnedData:s,...Le(),...Ft(),...(r=(a=pt).setup)==null?void 0:r.call(a,e,t)}},computed:{...G(j,q,z),node(){return this.workflowsStore.getNodeByName(this.nodeName)},nodeType(){return this.node?this.nodeTypesStore.getNodeType(this.node.type,this.node.typeVersion):null},nodeRunning(){const e=this.workflowsStore.executedNode;return this.workflowRunning&&(this.workflowsStore.isNodeExecuting(this.node.name)||e===this.node.name)},workflowRunning(){return this.uiStore.isActionActive("workflowRunning")},isTriggerNode(){return this.node?this.nodeTypesStore.isTriggerNode(this.node.type):!1},isManualTriggerNode(){return!!(this.nodeType&&this.nodeType.name===Je)},isChatNode(){return!!(this.nodeType&&this.nodeType.name===Ge)},isFormTriggerNode(){return!!(this.nodeType&&this.nodeType.name===Pe)},isPollingTypeNode(){var e;return!!((e=this.nodeType)!=null&&e.polling)},isScheduleTrigger(){var e;return!!((e=this.nodeType)!=null&&e.group.includes("schedule"))},isWebhookNode(){return!!(this.nodeType&&this.nodeType.name===Ce)},isListeningForEvents(){const e=this.workflowsStore.executionWaitingForWebhook,t=this.workflowsStore.executedNode;return this.node&&!this.node.disabled&&this.isTriggerNode&&e&&(!t||t===this.nodeName)},isListeningForWorkflowEvents(){return this.nodeRunning&&this.isTriggerNode&&!this.isScheduleTrigger&&!this.isManualTriggerNode},hasIssues(){var e;return!!((e=this.node)!=null&&e.issues&&(this.node.issues.parameters||this.node.issues.credentials))},disabledHint(){if(this.isListeningForEvents)return"";if(this.isTriggerNode&&this.node.disabled)return this.$locale.baseText("ndv.execute.nodeIsDisabled");if(this.isTriggerNode&&this.hasIssues){const e=this.ndvStore.activeNode;return e&&e.name!==this.nodeName?this.$locale.baseText("ndv.execute.fixPrevious"):this.$locale.baseText("ndv.execute.requiredFieldsMissing")}return this.workflowRunning&&!this.nodeRunning?this.$locale.baseText("ndv.execute.workflowAlreadyRunning"):""},buttonLabel(){var e;return this.isListeningForEvents||this.isListeningForWorkflowEvents?this.$locale.baseText("ndv.execute.stopListening"):this.label?this.label:this.isChatNode?this.$locale.baseText("ndv.execute.testChat"):this.isWebhookNode?this.$locale.baseText("ndv.execute.listenForTestEvent"):this.isFormTriggerNode?this.$locale.baseText("ndv.execute.testStep"):this.isPollingTypeNode||(e=this.nodeType)!=null&&e.mockManualExecution?this.$locale.baseText("ndv.execute.fetchEvent"):this.$locale.baseText("ndv.execute.testNode")}},methods:{async stopWaitingForWebhook(){try{await this.workflowsStore.removeTestWebhook(this.workflowsStore.workflowId)}catch(e){this.showError(e,this.$locale.baseText("ndv.execute.stopWaitingForWebhook.error"));return}},async onClick(){if(this.isChatNode)this.ndvStore.setActiveNodeName(null),X.emit("openChat");else if(this.isListeningForEvents)await this.stopWaitingForWebhook();else if(this.isListeningForWorkflowEvents)this.$emit("stopExecution");else{let e=!1;if(this.pinnedData.hasData.value&&(e=await this.confirm(this.$locale.baseText("ndv.pinData.unpinAndExecute.description"),this.$locale.baseText("ndv.pinData.unpinAndExecute.title"),{confirmButtonText:this.$locale.baseText("ndv.pinData.unpinAndExecute.confirm"),cancelButtonText:this.$locale.baseText("ndv.pinData.unpinAndExecute.cancel")})===Ve,e&&this.node&&this.pinnedData.unsetData("unpin-and-execute-modal")),!this.pinnedData.hasData.value||e){const t={node_type:this.nodeType?this.nodeType.name:null,workflow_id:this.workflowsStore.workflowId,source:this.telemetrySource,session_id:this.ndvStore.sessionId};this.$telemetry.track("User clicked execute node button",t),await this.externalHooks.run("nodeExecuteButton.onClick",t),await this.runWorkflow({destinationNode:this.nodeName,source:"RunData.ExecuteNodeButton"}),this.$emit("execute")}}}}});function Ra(e,t,o,n,s,i){const a=S("n8n-button"),r=S("n8n-tooltip");return c(),b("div",null,[m(r,{placement:"bottom",disabled:!e.disabledHint},{content:y(()=>[g("div",null,T(e.disabledHint),1)]),default:y(()=>[g("div",null,[m(a,Vi(e.$attrs,{loading:e.nodeRunning&&!e.isListeningForEvents&&!e.isListeningForWorkflowEvents,disabled:e.disabled||!!e.disabledHint,label:e.buttonLabel,type:e.type,size:e.size,icon:!e.isListeningForEvents&&"flask","transparent-background":e.transparent,onClick:e.onClick,title:e.isTriggerNode?"":e.$locale.baseText("ndv.execute.testNode.description")}),null,16,["loading","disabled","label","type","size","icon","transparent-background","onClick","title"])])]),_:1},8,["disabled"])])}const qt=L($a,[["render",Ra]]),_a=x({name:"NodeSettings",components:{NodeTitle:da,NodeCredentials:Xs,ParameterInputList:Qs,NodeSettingsTabs:ha,NodeWebhooks:Oa,NodeExecuteButton:qt},setup(){const e=xe();return{externalHooks:be(),nodeHelpers:e}},computed:{...G(zt,j,q,le,cn,z,wn),isCurlImportModalOpen(){return this.uiStore.isModalOpen(Zt)},isReadOnly(){return this.readOnly||this.hasForeignCredential},isExecutable(){if(this.nodeType&&this.node){const e=this.workflowsStore.getCurrentWorkflow(),t=e.getNode(this.node.name),o=pe(e,t,this.nodeType);if(!re(o).includes(_.Main)&&!this.isTriggerNode)return!1}return this.executable||this.hasForeignCredential},nodeTypeName(){if(this.nodeType){const e=this.$locale.shortNodeType(this.nodeType.name);return this.$locale.headerText({key:`headers.${e}.displayName`,fallback:this.nodeType.name})}return""},nodeTypeVersions(){return this.node?this.nodeTypesStore.getNodeVersions(this.node.type):[]},latestVersion(){return Math.max(...this.nodeTypeVersions)},isLatestNodeVersion(){var e;return this.latestVersion===((e=this.node)==null?void 0:e.typeVersion)},nodeVersionTag(){return!this.nodeType||this.nodeType.hidden?this.$locale.baseText("nodeSettings.deprecated"):this.isLatestNodeVersion?this.$locale.baseText("nodeSettings.latest"):this.$locale.baseText("nodeSettings.latestVersion",{interpolate:{version:this.latestVersion.toString()}})},nodeTypeDescription(){var e;if((e=this.nodeType)!=null&&e.description){const t=this.$locale.shortNodeType(this.nodeType.name);return this.$locale.headerText({key:`headers.${t}.description`,fallback:this.nodeType.description})}else return this.$locale.baseText("nodeSettings.noDescriptionFound")},headerStyle(){return this.node?{"background-color":this.node.color}:{}},node(){return this.ndvStore.activeNode},parametersSetting(){return this.parameters.filter(e=>e.isNodeSetting)},parametersNoneSetting(){return this.parameters.filter(e=>!e.isNodeSetting)},parameters(){return this.nodeType===null?[]:this.nodeType.properties},outputPanelEditMode(){return this.ndvStore.outputPanelEditMode},isCommunityNode(){var e;return ln((e=this.node)==null?void 0:e.type)},isTriggerNode(){var e;return this.nodeTypesStore.isTriggerNode((e=this.node)==null?void 0:e.type)},workflowOwnerName(){return this.workflowsEEStore.getWorkflowOwnerName(`${this.workflowsStore.workflowId}`)},hasForeignCredential(){return this.foreignCredentials.length>0},usedCredentials(){return Object.values(this.workflowsStore.usedCredentials).filter(e=>{var t;return Object.values(((t=this.node)==null?void 0:t.credentials)||[]).find(o=>o.id===e.id)})},credentialOwnerName(){const e=this.usedCredentials?Object.values(this.usedCredentials).find(t=>t.id===this.foreignCredentials[0]):void 0;return this.credentialsStore.getCredentialOwnerName(e)}},props:{eventBus:{type:Object},dragging:{type:Boolean},sessionId:{type:String},nodeType:{type:Object},readOnly:{type:Boolean,default:!1},foreignCredentials:{type:Array,default:()=>[]},blockUI:{type:Boolean,default:!1},executable:{type:Boolean,default:!0}},data(){return{nodeValid:!0,nodeColor:null,openPanel:"params",nodeValues:{color:"#ff0000",alwaysOutputData:!1,executeOnce:!1,notesInFlow:!1,onError:"stopWorkflow",retryOnFail:!1,maxTries:3,waitBetweenTries:1e3,notes:"",parameters:{}},nodeValuesInitialized:!1,nodeSettings:[],COMMUNITY_NODES_INSTALLATION_DOCS_URL:dn,CUSTOM_NODES_DOCS_URL:zn,MAIN_NODE_PANEL_WIDTH:We,hiddenIssuesInputs:[]}},watch:{node(e,t){this.setNodeValues()},isCurlImportModalOpen(e,t){if(e===!1){let o=this.uiStore.getHttpNodeParameters||"";if(!o)return;try{o=JSON.parse(o),this.valueChanged({node:this.node.name,name:"parameters",value:o}),this.uiStore.setHttpNodeParameters({name:Zt,parameters:""})}catch{}}}},mounted(){var e;this.populateHiddenIssuesSet(),this.populateSettings(),this.setNodeValues(),(e=this.eventBus)==null||e.on("openSettings",this.openSettings),this.nodeHelpers.updateNodeParameterIssues(this.node,this.nodeType)},beforeUnmount(){var e;(e=this.eventBus)==null||e.off("openSettings",this.openSettings)},methods:{populateHiddenIssuesSet(){!this.node||!this.workflowsStore.isNodePristine(this.node.name)||(this.hiddenIssuesInputs.push("credentials"),this.parametersNoneSetting.forEach(e=>{this.hiddenIssuesInputs.push(e.name)}),this.workflowsStore.setNodePristine(this.node.name,!1))},populateSettings(){this.isExecutable&&!this.isTriggerNode&&this.nodeSettings.push({displayName:this.$locale.baseText("nodeSettings.alwaysOutputData.displayName"),name:"alwaysOutputData",type:"boolean",default:!1,noDataExpression:!0,description:this.$locale.baseText("nodeSettings.alwaysOutputData.description")},{displayName:this.$locale.baseText("nodeSettings.executeOnce.displayName"),name:"executeOnce",type:"boolean",default:!1,noDataExpression:!0,description:this.$locale.baseText("nodeSettings.executeOnce.description")},{displayName:this.$locale.baseText("nodeSettings.retryOnFail.displayName"),name:"retryOnFail",type:"boolean",default:!1,noDataExpression:!0,description:this.$locale.baseText("nodeSettings.retryOnFail.description")},{displayName:this.$locale.baseText("nodeSettings.maxTries.displayName"),name:"maxTries",type:"number",typeOptions:{minValue:2,maxValue:5},default:3,displayOptions:{show:{retryOnFail:[!0]}},noDataExpression:!0,description:this.$locale.baseText("nodeSettings.maxTries.description")},{displayName:this.$locale.baseText("nodeSettings.waitBetweenTries.displayName"),name:"waitBetweenTries",type:"number",typeOptions:{minValue:0,maxValue:5e3},default:1e3,displayOptions:{show:{retryOnFail:[!0]}},noDataExpression:!0,description:this.$locale.baseText("nodeSettings.waitBetweenTries.description")},{displayName:this.$locale.baseText("nodeSettings.onError.displayName"),name:"onError",type:"options",options:[{name:this.$locale.baseText("nodeSettings.onError.options.stopWorkflow.displayName"),value:"stopWorkflow",description:this.$locale.baseText("nodeSettings.onError.options.stopWorkflow.description")},{name:this.$locale.baseText("nodeSettings.onError.options.continueRegularOutput.displayName"),value:"continueRegularOutput",description:this.$locale.baseText("nodeSettings.onError.options.continueRegularOutput.description")},{name:this.$locale.baseText("nodeSettings.onError.options.continueErrorOutput.displayName"),value:"continueErrorOutput",description:this.$locale.baseText("nodeSettings.onError.options.continueErrorOutput.description")}],default:"stopWorkflow",noDataExpression:!0,description:this.$locale.baseText("nodeSettings.onError.description")}),this.nodeSettings.push({displayName:this.$locale.baseText("nodeSettings.notes.displayName"),name:"notes",type:"string",typeOptions:{rows:5},default:"",noDataExpression:!0,description:this.$locale.baseText("nodeSettings.notes.description")},{displayName:this.$locale.baseText("nodeSettings.notesInFlow.displayName"),name:"notesInFlow",type:"boolean",default:!1,noDataExpression:!0,description:this.$locale.baseText("nodeSettings.notesInFlow.description")})},onParameterBlur(e){this.hiddenIssuesInputs=this.hiddenIssuesInputs.filter(t=>t!==e)},onWorkflowActivate(){this.hiddenIssuesInputs=[],this.$emit("activate")},onNodeExecute(){this.hiddenIssuesInputs=[],this.$emit("execute")},setValue(e,t){const o=e.split(".");let n=o.pop(),s=!1;if(n!==void 0&&n.includes("[")){const i=n.match(/(.*)\[(\d+)\]$/);i&&(o.push(i[1]),n=i[2],s=!0)}if(o.length===0)if(t===null){const{[n]:i,...a}=this.nodeValues;this.nodeValues=a}else this.nodeValues={...this.nodeValues,[n]:t};else if(t===null){let i=ce(this.nodeValues,o.join("."));const{[n]:a,...r}=i;if(i=r,s&&i.length===0){n=o.pop(),i=ce(this.nodeValues,o.join("."));const{[n]:l,...d}=i;i=d}}else typeof t=="object"?Ae(ce(this.nodeValues,o.join(".")),n,Ee(t)):Ae(ce(this.nodeValues,o.join(".")),n,t);this.nodeValues={...this.nodeValues}},credentialSelected(e){this.workflowsStore.updateNodeProperties(e);const t=this.workflowsStore.getNodeByName(e.name);t&&this.nodeHelpers.updateNodeCredentialIssues(t),this.externalHooks.run("nodeSettings.credentialSelected",{updateInformation:e})},nameChanged(e){this.node&&this.historyStore.pushCommandToUndo(new vn(this.node.name,e)),this.valueChanged({value:e,name:"name"})},valueChanged(e){var s;let t;e.hasOwnProperty("value")?t=e.value:t=ce(this.nodeValues,e.name);const o=e.node||((s=this.node)==null?void 0:s.name),n=this.workflowsStore.getNodeByName(o);if(n!==null)if(e.name==="onError"&&this.$emit("redrawRequired"),e.name==="name"){const i={value:t,oldValue:o,name:e.name};this.$emit("valueChanged",i)}else if(e.name==="parameters"){const i=this.nodeTypesStore.getNodeType(n.type,n.typeVersion);if(!i)return;let a=Be(i.properties,n.parameters,!1,!1,n);const r=Object.assign({},a);a=Ee(a);for(const l of Object.keys(e.value)){t=e.value[l];const d=l.split(".").slice(1).join("."),h=d.match(/(.*)\[(\d+)\]$/);if(e[l]===void 0&&h!==null){const p=h[1],w=h[2],f=ce(a,p);Array.isArray(f)&&(f.splice(parseInt(w,10),1),Ae(a,p,f))}else t===void 0?Dt(a,d):Ae(a,d,t);this.externalHooks.run("nodeSettings.valueChanged",{parameterPath:d,newValue:t,parameters:this.parameters,oldNodeParameters:r})}a=Be(i.properties,a,!0,!1,n);for(const l of Object.keys(a))a&&a[l]!==null&&a[l]!==void 0&&this.setValue(`parameters.${l}`,a[l]);if(a){const l={name:n.name,value:a};this.workflowsStore.setNodeParameters(l),this.nodeHelpers.updateNodeParameterIssuesByName(n.name),this.nodeHelpers.updateNodeCredentialIssuesByName(n.name)}}else if(e.name.startsWith("parameters.")){const i=this.nodeTypesStore.getNodeType(n.type,n.typeVersion);if(!i)return;let a=Be(i.properties,n.parameters,!1,!1,n);const r=Object.assign({},a);a=Ee(a);const l=e.name.split(".").slice(1).join("."),d=l.match(/(.*)\[(\d+)\]$/);if(e.value===void 0&&d!==null){const p=d[1],w=d[2],f=ce(a,p);Array.isArray(f)&&(f.splice(parseInt(w,10),1),Ae(a,p,f))}else t===void 0?Dt(a,l):Ae(a,l,t),this.removeMismatchedOptionValues(i,a,{name:l,value:t});a=Be(i.properties,a,!0,!1,n);for(const p of Object.keys(a))a&&a[p]!==null&&a[p]!==void 0&&this.setValue(`parameters.${p}`,a[p]);const h={name:n.name,value:a};this.workflowsStore.setNodeParameters(h),this.externalHooks.run("nodeSettings.valueChanged",{parameterPath:l,newValue:t,parameters:this.parameters,oldNodeParameters:r}),this.nodeHelpers.updateNodeParameterIssuesByName(n.name),this.nodeHelpers.updateNodeCredentialIssuesByName(n.name),this.$telemetry.trackNodeParametersValuesChange(i.name,e)}else{this.nodeValues={...this.nodeValues,[e.name]:t};const i={name:n.name,key:e.name,value:t};this.workflowsStore.setNodeValue(i)}},removeMismatchedOptionValues(e,t,o){e.properties.forEach(n=>{var l,d;const s=n.displayOptions;if(!(t!=null&&t.hasOwnProperty(n.name))||!s||!n.options)return;const i=(l=s.show)==null?void 0:l[o.name],a=(d=s.hide)==null?void 0:d[o.name];if(i===void 0&&a===void 0)return;(!Object.keys(t).every(h=>(n.options??[]).find(p=>p.name===h)!==void 0)||i!==o.value||a===o.value)&&Dt(t,n.name)})},setNodeValues(){if(!this.node){this.nodeValuesInitialized=!0;return}if(this.nodeType!==null){this.nodeValid=!0;const e=[];this.node.color&&(e.push("color"),this.nodeValues={...this.nodeValues,color:this.node.color}),this.node.notes&&(e.push("notes"),this.nodeValues={...this.nodeValues,notes:this.node.notes}),this.node.alwaysOutputData&&(e.push("alwaysOutputData"),this.nodeValues={...this.nodeValues,alwaysOutputData:this.node.alwaysOutputData}),this.node.executeOnce&&(e.push("executeOnce"),this.nodeValues={...this.nodeValues,executeOnce:this.node.executeOnce}),this.node.continueOnFail&&(e.push("onError"),this.nodeValues={...this.nodeValues,onError:"continueRegularOutput"}),this.node.onError&&(e.push("onError"),this.nodeValues={...this.nodeValues,onError:this.node.onError}),this.node.notesInFlow&&(e.push("notesInFlow"),this.nodeValues={...this.nodeValues,notesInFlow:this.node.notesInFlow}),this.node.retryOnFail&&(e.push("retryOnFail"),this.nodeValues={...this.nodeValues,retryOnFail:this.node.retryOnFail}),this.node.maxTries&&(e.push("maxTries"),this.nodeValues={...this.nodeValues,maxTries:this.node.maxTries}),this.node.waitBetweenTries&&(e.push("waitBetweenTries"),this.nodeValues={...this.nodeValues,waitBetweenTries:this.node.waitBetweenTries});for(const t of this.nodeSettings)e.includes(t.name)||(this.nodeValues={...this.nodeValues,[t.name]:t.default});this.nodeValues={...this.nodeValues,parameters:Ee(this.node.parameters)}}else this.nodeValid=!1;this.nodeValuesInitialized=!0},onMissingNodeTextClick(e){e.target.localName==="a"&&this.$telemetry.track("user clicked cnr browse button",{source:"cnr missing node modal"})},onMissingNodeLearnMoreLinkClick(){var e,t;this.$telemetry.track("user clicked cnr docs link",{source:"missing node modal source",package_name:(e=this.node)==null?void 0:e.type.split(".")[0],node_type:(t=this.node)==null?void 0:t.type})},onStopExecution(){this.$emit("stopExecution")},openSettings(){this.openPanel="settings"}}}),Aa="_header_1uxvz_5",Ma="_warningIcon_1uxvz_9",Wa="_descriptionContainer_1uxvz_14",Va={header:Aa,warningIcon:Ma,descriptionContainer:Wa},Ba={class:"header-side-menu"},Ua={key:1},La={key:0,class:"node-is-not-valid"},xa={class:"missingNodeTitleContainer mt-s mb-xs"},Ha={class:"mb-l"},Fa=["href"],za=["href","textContent"],Ya={key:1,class:"node-parameters-wrapper","data-test-id":"node-parameters"},Ka={key:1,class:"no-parameters"},ja={key:2,class:"parameter-item parameter-notice","data-test-id":"node-parameters-http-notice"},qa={class:"node-version","data-test-id":"node-version"};function Ga(e,t,o,n,s,i){var v;const a=S("NodeTitle"),r=S("NodeExecuteButton"),l=S("NodeSettingsTabs"),d=S("font-awesome-icon"),h=S("n8n-text"),p=S("i18n-t"),w=S("n8n-link"),f=S("n8n-notice"),N=S("NodeWebhooks"),E=S("NodeCredentials"),u=S("ParameterInputList"),k=S("n8n-block-ui");return c(),b("div",{class:D({"node-settings":!0,dragging:e.dragging}),onKeydown:t[1]||(t[1]=te(()=>{},["stop"]))},[g("div",{class:D(e.$style.header)},[g("div",Ba,[e.node?(c(),P(a,{key:0,class:"node-name","model-value":e.node.name,"node-type":e.nodeType,"read-only":e.isReadOnly,"onUpdate:modelValue":e.nameChanged},null,8,["model-value","node-type","read-only","onUpdate:modelValue"])):C("",!0),e.isExecutable?(c(),b("div",Ua,[!e.blockUI&&e.node&&e.nodeValid?(c(),P(r,{key:0,"data-test-id":"node-execute-button","node-name":e.node.name,disabled:e.outputPanelEditMode.enabled&&!e.isTriggerNode,size:"small","telemetry-source":"parameters",onExecute:e.onNodeExecute,onStopExecution:e.onStopExecution},null,8,["node-name","disabled","onExecute","onStopExecution"])):C("",!0)])):C("",!0)]),e.node&&e.nodeValid?(c(),P(l,{key:0,modelValue:e.openPanel,"onUpdate:modelValue":t[0]||(t[0]=$=>e.openPanel=$),"node-type":e.nodeType,"session-id":e.sessionId},null,8,["modelValue","node-type","session-id"])):C("",!0)],2),e.node&&!e.nodeValid?(c(),b("div",La,[g("p",{class:D(e.$style.warningIcon)},[m(d,{icon:"exclamation-triangle"})],2),g("div",xa,[m(h,{size:"large",color:"text-dark",bold:""},{default:y(()=>[I(T(e.$locale.baseText("nodeSettings.communityNodeUnknown.title")),1)]),_:1})]),e.isCommunityNode?(c(),b("div",{key:0,class:D(e.$style.descriptionContainer)},[g("div",Ha,[m(p,{keypath:"nodeSettings.communityNodeUnknown.description",tag:"span",onClick:e.onMissingNodeTextClick},{action:y(()=>[g("a",{href:`https://www.npmjs.com/package/${e.node.type.split(".")[0]}`,target:"_blank"},T(e.node.type.split(".")[0]),9,Fa)]),_:1},8,["onClick"])]),m(w,{to:e.COMMUNITY_NODES_INSTALLATION_DOCS_URL,onClick:e.onMissingNodeLearnMoreLinkClick},{default:y(()=>[I(T(e.$locale.baseText("nodeSettings.communityNodeUnknown.installLink.text")),1)]),_:1},8,["to","onClick"])],2)):(c(),P(p,{key:1,keypath:"nodeSettings.nodeTypeUnknown.description",tag:"span"},{action:y(()=>[g("a",{href:e.CUSTOM_NODES_DOCS_URL,target:"_blank",textContent:T(e.$locale.baseText("nodeSettings.nodeTypeUnknown.description.customNode"))},null,8,za)]),_:1}))])):C("",!0),e.node&&e.nodeValid?(c(),b("div",Ya,[e.hasForeignCredential?(c(),P(f,{key:0,content:e.$locale.baseText("nodeSettings.hasForeignCredential",{interpolate:{owner:e.credentialOwnerName}})},null,8,["content"])):C("",!0),Y(g("div",null,[m(N,{node:e.node,"node-type":e.nodeType},null,8,["node","node-type"]),e.nodeValuesInitialized?(c(),P(u,{key:0,parameters:e.parametersNoneSetting,"hide-delete":!0,"node-values":e.nodeValues,"is-read-only":e.isReadOnly,"hidden-issues-inputs":e.hiddenIssuesInputs,path:"parameters",onValueChanged:e.valueChanged,onActivate:e.onWorkflowActivate,onParameterBlur:e.onParameterBlur},{default:y(()=>[m(E,{node:e.node,readonly:e.isReadOnly,"show-all":!0,"hide-issues":e.hiddenIssuesInputs.includes("credentials"),onCredentialSelected:e.credentialSelected,onValueChanged:e.valueChanged,onBlur:e.onParameterBlur},null,8,["node","readonly","hide-issues","onCredentialSelected","onValueChanged","onBlur"])]),_:1},8,["parameters","node-values","is-read-only","hidden-issues-inputs","onValueChanged","onActivate","onParameterBlur"])):C("",!0),e.parametersNoneSetting.length===0?(c(),b("div",Ka,[m(h,null,{default:y(()=>[I(T(e.$locale.baseText("nodeSettings.thisNodeDoesNotHaveAnyParameters")),1)]),_:1})])):C("",!0),e.nodeHelpers.isCustomApiCallSelected(e.nodeValues)?(c(),b("div",ja,[m(f,{content:e.$locale.baseText("nodeSettings.useTheHttpRequestNode",{interpolate:{nodeTypeDisplayName:e.nodeType.displayName}})},null,8,["content"])])):C("",!0)],512),[[J,e.openPanel==="params"]]),Y(g("div",null,[m(u,{parameters:e.parametersSetting,"node-values":e.nodeValues,"is-read-only":e.isReadOnly,"hidden-issues-inputs":e.hiddenIssuesInputs,path:"parameters",onValueChanged:e.valueChanged,onParameterBlur:e.onParameterBlur},null,8,["parameters","node-values","is-read-only","hidden-issues-inputs","onValueChanged","onParameterBlur"]),m(u,{parameters:e.nodeSettings,"hide-delete":!0,"node-values":e.nodeValues,"is-read-only":e.isReadOnly,"hidden-issues-inputs":e.hiddenIssuesInputs,path:"",onValueChanged:e.valueChanged,onParameterBlur:e.onParameterBlur},null,8,["parameters","node-values","is-read-only","hidden-issues-inputs","onValueChanged","onParameterBlur"]),g("div",qa,[I(T(e.$locale.baseText("nodeSettings.nodeVersion",{interpolate:{node:(v=e.nodeType)==null?void 0:v.displayName,version:e.node.typeVersion.toString()}}))+" ",1),g("span",null,"("+T(e.nodeVersionTag)+")",1)])],512),[[J,e.openPanel==="settings"]])])):C("",!0),m(k,{show:e.blockUI},null,8,["show"])],34)}const Ja={$style:Va},Xa=L(_a,[["render",Ga],["__cssModules",Ja],["__scopeId","data-v-b165f714"]]),Qa=x({name:"Draggable",props:{disabled:{type:Boolean},type:{type:String},data:{type:String},tag:{type:String,default:"div"},targetDataKey:{type:String}},data(){const e={x:-100,y:-100};return{isDragging:!1,draggablePosition:e,draggingEl:null,draggableStyle:{transform:`translate(${e.x}px, ${e.y}px)`},animationFrameId:0}},computed:{...G(q),canDrop(){return this.ndvStore.canDraggableDrop},stickyPosition(){return this.ndvStore.draggableStickyPos}},methods:{setDraggableStyle(){this.draggableStyle={transform:`translate(${this.draggablePosition.x}px, ${this.draggablePosition.y}px)`}},onDragStart(e){var o,n,s;if(this.disabled||(this.draggingEl=e.target,this.targetDataKey&&((o=this.draggingEl.dataset)==null?void 0:o.target)!==this.targetDataKey&&(this.draggingEl=this.draggingEl.closest(`[data-target="${this.targetDataKey}"]`)),this.targetDataKey&&((s=(n=this.draggingEl)==null?void 0:n.dataset)==null?void 0:s.target)!==this.targetDataKey))return;e.preventDefault(),e.stopPropagation(),this.isDragging=!1,this.draggablePosition={x:e.pageX,y:e.pageY},this.setDraggableStyle(),window.addEventListener("mousemove",this.onDrag),window.addEventListener("mouseup",this.onDragEnd);const t=document.activeElement;t&&t.blur()},onDrag(e){if(e.preventDefault(),e.stopPropagation(),!this.disabled){if(!this.isDragging){this.isDragging=!0;const t=this.targetDataKey&&this.draggingEl?this.draggingEl.dataset.value:this.data||"";this.ndvStore.draggableStartDragging({type:this.type,data:t||""}),this.$emit("dragstart",this.draggingEl),document.body.style.cursor="grabbing"}this.animationFrameId=window.requestAnimationFrame(()=>{this.canDrop&&this.stickyPosition?this.draggablePosition={x:this.stickyPosition[0],y:this.stickyPosition[1]}:this.draggablePosition={x:e.pageX,y:e.pageY},this.setDraggableStyle(),this.$emit("drag",this.draggablePosition)})}},onDragEnd(){this.disabled||(document.body.style.cursor="unset",window.removeEventListener("mousemove",this.onDrag),window.removeEventListener("mouseup",this.onDragEnd),window.cancelAnimationFrame(this.animationFrameId),setTimeout(()=>{this.$emit("dragend",this.draggingEl),this.isDragging=!1,this.draggingEl=null,this.ndvStore.draggableStopDragging()},0))}}}),Za="_dragging_bt5wj_5",er="_draggable_bt5wj_10",tr={dragging:Za,draggable:er,"draggable-data-transfer":"_draggable-data-transfer_bt5wj_17"};function or(e,t,o,n,s,i){return c(),P(En(e.tag),{ref:"wrapper",class:D({[e.$style.dragging]:e.isDragging}),onMousedown:e.onDragStart},{default:y(()=>[ne(e.$slots,"default",{isDragging:e.isDragging}),(c(),P(Dn,{to:"body"},[Y(g("div",{ref:"draggable",class:D(e.$style.draggable),style:oe(e.draggableStyle)},[ne(e.$slots,"preview",{canDrop:e.canDrop,el:e.draggingEl})],6),[[J,e.isDragging]])]))]),_:3},40,["class","onMousedown"])}const nr={$style:tr},sr=L(Qa,[["render",or],["__cssModules",nr]]),ir=x({components:{Draggable:sr},props:{canMoveRight:{type:Boolean},canMoveLeft:{type:Boolean}},methods:{onDrag(e){this.$emit("drag",e)},onDragStart(){this.$emit("dragstart")},onDragEnd(){this.$emit("dragend")}}}),ar="_dragContainer_4rvyw_5",rr="_dragButton_4rvyw_9",lr="_leftArrow_4rvyw_23 _arrow_4rvyw_32",dr="_rightArrow_4rvyw_24 _arrow_4rvyw_32",ur="_visible_4rvyw_28",cr="_arrow_4rvyw_32",hr="_grid_4rvyw_50",pr={dragContainer:ar,dragButton:rr,leftArrow:lr,rightArrow:dr,visible:ur,arrow:cr,grid:hr},fr=g("div",null,[g("div"),g("div"),g("div"),g("div"),g("div")],-1),gr=g("div",null,[g("div"),g("div"),g("div"),g("div"),g("div")],-1),mr=[fr,gr];function yr(e,t,o,n,s,i){const a=S("font-awesome-icon"),r=S("Draggable");return c(),P(r,{type:"panel-resize",class:D(e.$style.dragContainer),onDrag:e.onDrag,onDragstart:e.onDragStart,onDragend:e.onDragEnd},{default:y(({isDragging:l})=>[g("div",{class:D({[e.$style.dragButton]:!0})},[e.canMoveLeft?(c(),b("span",{key:0,class:D({[e.$style.leftArrow]:!0,[e.$style.visible]:l})},[m(a,{icon:"arrow-left"})],2)):C("",!0),e.canMoveRight?(c(),b("span",{key:1,class:D({[e.$style.rightArrow]:!0,[e.$style.visible]:l})},[m(a,{icon:"arrow-right"})],2)):C("",!0),g("div",{class:D(e.$style.grid)},mr,2)],2)]),_:1},8,["class","onDrag","onDragstart","onDragend"])}const wr={$style:pr},vr=L(ir,[["render",yr],["__cssModules",wr]]),Nr=["data-node-name","data-node-placement","onClick"],kr=x({__name:"NDVFloatingNodes",props:{rootNode:{},type:{}},emits:["switchSelectedNode"],setup(e,{expose:t,emit:o}){const n=e,s=z(),i=j(),a=s.getCurrentWorkflow();function r(f){const N=h.value[f][0];N&&o("switchSelectedNode",N.node.name)}function l(f){if(f.shiftKey&&f.altKey&&(f.ctrlKey||f.metaKey)){const E={ArrowUp:"outputSub",ArrowRight:"outputMain",ArrowDown:"inputSub",ArrowLeft:"inputMain"}[f.key]||null;E&&r(E)}}function d(f){return f.map(N=>{const E=s.getNodeByName(N);if(E){const u=i.getNodeType(E.type);if(u)return{node:E,nodeType:u}}return null}).filter(N=>N!==null)}const h=K(()=>{const f=n.rootNode.name;return{outputSub:d(a.getChildNodes(f,"ALL_NON_MAIN")),outputMain:d(a.getChildNodes(f,"main",1)),inputSub:d(a.getParentNodes(f,"ALL_NON_MAIN")),inputMain:d(a.getParentNodes(f,"main",1))}}),p=["outputSub","outputMain","inputSub","inputMain"],w={outputSub:"bottom",outputMain:"left",inputSub:"top",inputMain:"right"};return bn(()=>{document.addEventListener("keydown",l,!0)}),Bi(()=>{document.removeEventListener("keydown",l,!0)}),t({moveNodeDirection:r}),(f,N)=>{const E=S("n8n-tooltip");return c(),b("aside",{class:D(f.$style.floatingNodes)},[(c(),b(Q,null,ae(p,u=>g("ul",{key:u,class:D([f.$style.nodesList,f.$style[u]])},[(c(!0),b(Q,null,ae(h.value[u],({node:k,nodeType:v})=>(c(),b(Q,null,[k&&v?(c(),P(E,{key:k.name,placement:w[u],teleported:!1,offset:60},{content:y(()=>[I(T(k.name),1)]),default:y(()=>[g("li",{class:D(f.$style.connectedNode),"data-test-id":"floating-node","data-node-name":k.name,"data-node-placement":u,onClick:$=>f.$emit("switchSelectedNode",k.name)},[m(yt,{"node-type":v,"node-name":k.name,"tooltip-position":w[u],size:35,circle:""},null,8,["node-type","node-name","tooltip-position"])],10,Nr)]),_:2},1032,["placement"])):C("",!0)],64))),256))],2)),64))],2)}}}),br="_floatingNodes_htxl9_5",Tr="_nodesList_htxl9_19",Sr="_inputSub_htxl9_33",Dr="_outputSub_htxl9_33",Er="_outputMain_htxl9_44",Cr="_inputMain_htxl9_44",Ir="_connectedNode_htxl9_67",Pr={floatingNodes:br,nodesList:Tr,inputSub:Sr,outputSub:Dr,outputMain:Er,inputMain:Cr,connectedNode:Ir},Or={$style:Pr},$r=L(kr,[["__cssModules",Or]]),De=24,Zo=80,Me=280,Rr=320,_r=420,Ar={regular:We,dragless:We,unknown:We,inputless:We,wide:We*2},Mr=x({name:"NDVDraggablePanels",components:{PanelDragButton:vr,NDVFloatingNodes:$r},props:{isDraggable:{type:Boolean},hideInputAndOutput:{type:Boolean},position:{type:Number},nodeType:{type:Object,default:()=>({})}},setup(){const{callDebounced:e}=Mt();return{callDebounced:e}},data(){return{windowWidth:1,isDragging:!1,MIN_PANEL_WIDTH:Me,initialized:!1}},mounted(){this.setTotalWidth(),this.mainPanelDimensions.relativeLeft===1&&this.mainPanelDimensions.relativeRight===1&&(this.setMainPanelWidth(),this.setPositions(this.getInitialLeftPosition(this.mainPanelDimensions.relativeWidth)),this.restorePositionData()),window.addEventListener("resize",this.setTotalWidth),this.$emit("init",{position:this.mainPanelDimensions.relativeLeft}),setTimeout(()=>{this.initialized=!0},0),ut.on("setPositionByName",this.setPositionByName)},beforeUnmount(){window.removeEventListener("resize",this.setTotalWidth),ut.off("setPositionByName",this.setPositionByName)},computed:{...G(q),mainPanelDimensions(){return this.ndvStore.getMainPanelDimensions(this.currentNodePaneType)},activeNode(){return this.ndvStore.activeNode},supportedResizeDirections(){const e=["right"];return this.isDraggable&&e.push("left"),e},currentNodePaneType(){return this.hasInputSlot?this.isDraggable?this.nodeType===null?"unknown":ce(this,"nodeType.parameterPane")||"regular":"dragless":"inputless"},hasInputSlot(){return this.$slots.input!==void 0},inputPanelMargin(){return this.pxToRelativeWidth(Zo)},minWindowWidth(){return 2*(De+Zo)+Me},minimumLeftPosition(){return this.windowWidth<this.minWindowWidth?this.pxToRelativeWidth(1):this.hasInputSlot?this.pxToRelativeWidth(De+20)+this.inputPanelMargin:this.pxToRelativeWidth(De)},maximumRightPosition(){return this.windowWidth<this.minWindowWidth?this.pxToRelativeWidth(1):this.pxToRelativeWidth(De+20)+this.inputPanelMargin},canMoveLeft(){return this.mainPanelDimensions.relativeLeft>this.minimumLeftPosition},canMoveRight(){return this.mainPanelDimensions.relativeRight>this.maximumRightPosition},mainPanelStyles(){return{left:`${this.relativeWidthToPx(this.mainPanelDimensions.relativeLeft)}px`,right:`${this.relativeWidthToPx(this.mainPanelDimensions.relativeRight)}px`}},inputPanelStyles(){return{right:`${this.relativeWidthToPx(this.calculatedPositions.inputPanelRelativeRight)}px`}},outputPanelStyles(){return{left:`${this.relativeWidthToPx(this.calculatedPositions.outputPanelRelativeLeft)}px`,transform:`translateX(-${this.relativeWidthToPx(this.outputPanelRelativeTranslate)}px)`}},calculatedPositions(){const e=this.$slots.input!==void 0,t=this.mainPanelDimensions.relativeLeft+this.mainPanelDimensions.relativeWidth;return{inputPanelRelativeRight:e?1-t+this.mainPanelDimensions.relativeWidth:1-this.pxToRelativeWidth(De),outputPanelRelativeLeft:t}},outputPanelRelativeTranslate(){const e=1-this.pxToRelativeWidth(Me+De),t=this.calculatedPositions.outputPanelRelativeLeft-e;return t>0?t:0},hasDoubleWidth(){return ce(this,"nodeType.parameterPane")==="wide"},fixedPanelWidth(){const e=this.hasDoubleWidth?2:1;return this.windowWidth>1700?_r*e:Rr*e},isBelowMinWidthMainPanel(){const e=this.pxToRelativeWidth(Me);return this.mainPanelDimensions.relativeWidth<e}},watch:{windowWidth(e){const t=this.pxToRelativeWidth(Me);this.isBelowMinWidthMainPanel&&this.setMainPanelWidth(t);const o=this.minimumLeftPosition>this.mainPanelDimensions.relativeLeft,n=this.maximumRightPosition>this.mainPanelDimensions.relativeRight;e>this.minWindowWidth&&o&&n&&(this.setMainPanelWidth(t),this.setPositions(this.getInitialLeftPosition(this.mainPanelDimensions.relativeWidth))),this.setPositions(this.mainPanelDimensions.relativeLeft)}},methods:{onSwitchSelectedNode(e){this.$emit("switchSelectedNode",e)},getInitialLeftPosition(e){return this.currentNodePaneType==="dragless"?this.pxToRelativeWidth(De+1+this.fixedPanelWidth):this.hasInputSlot?.5-e/2:this.minimumLeftPosition},setMainPanelWidth(e){const t=e||this.pxToRelativeWidth(Ar[this.currentNodePaneType]);this.ndvStore.setMainPanelDimensions({panelType:this.currentNodePaneType,dimensions:{relativeWidth:t}})},setPositions(e){const t=e||1-this.calculatedPositions.inputPanelRelativeRight,o=1-t-this.mainPanelDimensions.relativeWidth,n=this.maximumRightPosition>o,s=this.minimumLeftPosition>t,i=this.currentNodePaneType==="inputless";if(s){this.ndvStore.setMainPanelDimensions({panelType:this.currentNodePaneType,dimensions:{relativeLeft:this.minimumLeftPosition,relativeRight:1-this.mainPanelDimensions.relativeWidth-this.minimumLeftPosition}});return}if(n){this.ndvStore.setMainPanelDimensions({panelType:this.currentNodePaneType,dimensions:{relativeLeft:1-this.mainPanelDimensions.relativeWidth-this.maximumRightPosition,relativeRight:this.maximumRightPosition}});return}this.ndvStore.setMainPanelDimensions({panelType:this.currentNodePaneType,dimensions:{relativeLeft:i?this.minimumLeftPosition:t,relativeRight:o}})},setPositionByName(e){const t={minLeft:this.minimumLeftPosition,maxRight:this.maximumRightPosition,initial:this.getInitialLeftPosition(this.mainPanelDimensions.relativeWidth)};this.setPositions(t[e])},pxToRelativeWidth(e){return e/this.windowWidth},relativeWidthToPx(e){return e*this.windowWidth},onResizeStart(){this.setTotalWidth()},onResizeEnd(){this.storePositionData()},onResizeDebounced(e){this.initialized&&this.callDebounced(this.onResize,{debounceTime:10,trailing:!0},e)},onResize({direction:e,x:t,width:o}){const n=this.pxToRelativeWidth(t),s=this.pxToRelativeWidth(o);e==="left"&&n<=this.minimumLeftPosition||e==="right"&&1-n<=this.maximumRightPosition||o<=Me||(this.setMainPanelWidth(s),this.setPositions(e==="left"?n:this.mainPanelDimensions.relativeLeft))},restorePositionData(){const e=Ie(`${eo}_${this.currentNodePaneType}`).value;if(e){const t=parseFloat(e);this.setMainPanelWidth(t);const o=this.getInitialLeftPosition(t);return this.setPositions(o),!0}return!1},storePositionData(){Ie(`${eo}_${this.currentNodePaneType}`).value=this.mainPanelDimensions.relativeWidth.toString()},onDragStart(){this.isDragging=!0,this.$emit("dragstart",{position:this.mainPanelDimensions.relativeLeft})},onDrag(e){const t=this.pxToRelativeWidth(e.x)-this.mainPanelDimensions.relativeWidth/2;this.setPositions(t)},onDragEnd(){setTimeout(()=>{this.isDragging=!1,this.$emit("dragend",{windowWidth:this.windowWidth,position:this.mainPanelDimensions.relativeLeft})},0),this.storePositionData()},setTotalWidth(){this.windowWidth=window.innerWidth},close(){this.$emit("close")}}}),Wr="_dataPanel_w56ig_5",Vr="_inputPanel_w56ig_14 _dataPanel_w56ig_5",Br="_outputPanel_w56ig_22 _dataPanel_w56ig_5",Ur="_mainPanel_w56ig_30",Lr="_draggable_w56ig_34",xr="_mainPanelInner_w56ig_38",Hr="_dragging_w56ig_45",Fr="_dragButtonContainer_w56ig_58",zr="_visible_w56ig_74",Yr={dataPanel:Wr,inputPanel:Vr,outputPanel:Br,mainPanel:Ur,draggable:Lr,mainPanelInner:xr,dragging:Hr,"double-width":"_double-width_w56ig_54",dragButtonContainer:Fr,visible:zr};function Kr(e,t,o,n,s,i){const a=S("NDVFloatingNodes"),r=S("PanelDragButton"),l=S("n8n-resize-wrapper");return c(),b("div",null,[e.activeNode?(c(),P(a,{key:0,"root-node":e.activeNode,type:"input",onSwitchSelectedNode:e.onSwitchSelectedNode},null,8,["root-node","onSwitchSelectedNode"])):C("",!0),e.hideInputAndOutput?C("",!0):(c(),b("div",{key:1,class:D(e.$style.inputPanel),style:oe(e.inputPanelStyles)},[ne(e.$slots,"input")],6)),e.hideInputAndOutput?C("",!0):(c(),b("div",{key:2,class:D(e.$style.outputPanel),style:oe(e.outputPanelStyles)},[ne(e.$slots,"output")],6)),g("div",{class:D(e.$style.mainPanel),style:oe(e.mainPanelStyles)},[m(l,{"is-resizing-enabled":e.currentNodePaneType!=="unknown",width:e.relativeWidthToPx(e.mainPanelDimensions.relativeWidth),"min-width":e.MIN_PANEL_WIDTH,"grid-size":20,"supported-directions":e.supportedResizeDirections,onResize:e.onResizeDebounced,onResizestart:e.onResizeStart,onResizeend:e.onResizeEnd},{default:y(()=>[g("div",{class:D(e.$style.dragButtonContainer)},[!e.hideInputAndOutput&&e.isDraggable?(c(),P(r,{key:0,class:D({[e.$style.draggable]:!0,[e.$style.visible]:e.isDragging}),"can-move-left":e.canMoveLeft,"can-move-right":e.canMoveRight,onDragstart:e.onDragStart,onDrag:e.onDrag,onDragend:e.onDragEnd},null,8,["class","can-move-left","can-move-right","onDragstart","onDrag","onDragend"])):C("",!0)],2),g("div",{class:D({[e.$style.mainPanelInner]:!0,[e.$style.dragging]:e.isDragging})},[ne(e.$slots,"main")],2)]),_:3},8,["is-resizing-enabled","width","min-width","supported-directions","onResize","onResizestart","onResizeend"])],6)])}const jr={$style:Yr},qr=L(Mr,[["render",Kr],["__cssModules",jr]]),Gr={allowVulnerableTags:!1,enforceHtmlBoundary:!1,disallowedTagsMode:"discard",allowedTags:[...to.defaults.allowedTags,"style","img","title"],allowedAttributes:{...to.defaults.allowedAttributes,"*":["class","style"]},transformTags:{head:""}},Jr={name:"RunDataHtml",props:{inputHtml:{type:String}},computed:{sanitizedHtml(){return Yn(this.inputHtml,Gr)}}},Xr=["srcdoc"];function Qr(e,t,o,n,s,i){return c(),b("iframe",{class:"__html-display",srcdoc:i.sanitizedHtml},null,8,Xr)}const On=L(Jr,[["render",Qr]]),Zr=Object.freeze(Object.defineProperty({__proto__:null,default:On},Symbol.toStringTag,{value:"Module"})),el=x({name:"BinaryDataDisplayEmbed",components:{VueJsonPretty:In,RunDataHtml:On},props:{binaryData:{type:Object,required:!0}},data(){return{isLoading:!0,embedSource:"",error:!1,data:""}},computed:{...G(z)},async mounted(){const{id:e,data:t,fileName:o,fileType:n,mimeType:s}=this.binaryData,i=n==="json",a=n==="html";if(!e)i||a?this.data=gt(atob(t)):this.embedSource="data:"+s+";base64,"+t;else try{const r=this.workflowsStore.getBinaryUrl(e,"view",o,s);if(i||a){const l=await fetch(r,{credentials:"include"});this.data=await(i?l.json():l.text())}else this.embedSource=r}catch{this.error=!0}this.isLoading=!1},methods:{embedClass(){const{fileType:e}=this.binaryData;return[e??"other"]}}}),tl={key:0},ol={key:1},nl={key:2},sl={key:0,controls:"",autoplay:""},il=["src","type"],al={key:1,controls:"",autoplay:""},rl=["src","type"],ll=["src"];function dl(e,t,o,n,s,i){const a=S("VueJsonPretty"),r=S("RunDataHtml");return c(),b("span",null,[e.isLoading?(c(),b("div",tl,"Loading binary data...")):e.error?(c(),b("div",ol,"Error loading binary data")):(c(),b("span",nl,[e.binaryData.fileType==="video"?(c(),b("video",sl,[g("source",{src:e.embedSource,type:e.binaryData.mimeType},null,8,il),I(" "+T(e.$locale.baseText("binaryDataDisplay.yourBrowserDoesNotSupport")),1)])):e.binaryData.fileType==="audio"?(c(),b("audio",al,[g("source",{src:e.embedSource,type:e.binaryData.mimeType},null,8,rl),I(" "+T(e.$locale.baseText("binaryDataDisplay.yourBrowserDoesNotSupport")),1)])):e.binaryData.fileType==="json"?(c(),P(a,{key:2,data:e.data,deep:3,"show-length":!0},null,8,["data"])):e.binaryData.fileType==="html"?(c(),P(r,{key:3,"input-html":e.data},null,8,["input-html"])):(c(),b("embed",{key:4,src:e.embedSource,class:D(["binary-data",e.embedClass()])},null,10,ll))]))])}const ul=L(el,[["render",dl]]),cl=x({name:"BinaryDataDisplay",components:{BinaryDataDisplayEmbed:ul},props:["displayData","windowVisible"],setup(){return{nodeHelpers:xe()}},computed:{...G(z),binaryData(){const e=this.nodeHelpers.getBinaryData(this.workflowRunData,this.displayData.node,this.displayData.runIndex,this.displayData.outputIndex);return e.length===0||this.displayData.index>=e.length||e[this.displayData.index][this.displayData.key]===void 0?null:e[this.displayData.index][this.displayData.key]},workflowRunData(){const e=this.workflowsStore.getWorkflowExecution;if(e===null)return null;const t=e.data;return t?t.resultData.runData:null}},methods:{closeWindow(){return this.$emit("close"),!1}}}),hl={class:"binary-data-window-wrapper"},pl={key:0};function fl(e,t,o,n,s,i){var l;const a=S("n8n-button"),r=S("BinaryDataDisplayEmbed");return e.windowVisible?(c(),b("div",{key:0,class:D(["binary-data-window",(l=e.binaryData)==null?void 0:l.fileType])},[m(a,{size:"small",class:"binary-data-window-back",title:e.$locale.baseText("binaryDataDisplay.backToOverviewPage"),icon:"arrow-left",label:e.$locale.baseText("binaryDataDisplay.backToList"),onClick:te(e.closeWindow,["stop"])},null,8,["title","label","onClick"]),g("div",hl,[e.binaryData?(c(),P(r,{key:1,"binary-data":e.binaryData},null,8,["binary-data"])):(c(),b("div",pl,T(e.$locale.baseText("binaryDataDisplay.noDataFoundToDisplay")),1))])],2)):C("",!0)}const gl=L(cl,[["render",fl]]),ml=x({name:"NodeErrorView",components:{VueJsonPretty:In},props:["error"],setup(){return{clipboard:Ht(),...Le()}},computed:{...G(j,q),displayCause(){return JSON.stringify(this.error.cause).length<hn},parameters(){const e=this.ndvStore.activeNode;if(!e)return[];const t=this.nodeTypesStore.getNodeType(e.type,e.typeVersion);return t===null?[]:t.properties}},methods:{replacePlaceholders(e,t){const o=this.parameterDisplayName(e,!1),n=this.parameterDisplayName(e,!0);return t.replace(/%%PARAMETER%%/g,o).replace(/%%PARAMETER_FULL%%/g,n)},getErrorDescription(){var o;if(this.error.name==="NodeOperationError"&&this.error.functionality==="configuration-node")return vt(this.error.description+this.$locale.baseText("pushConnection.executionError.openNode",{interpolate:{node:this.error.node.name}}));if(!((o=this.error.context)!=null&&o.descriptionTemplate))return vt(this.error.description);const t=this.parameterDisplayName(this.error.context.parameter);return vt(this.error.context.descriptionTemplate.replace(/%%PARAMETER%%/g,t))},getErrorMessage(){var n;const e=this.$locale.baseText("nodeErrorView.error")+": ";if(this.error.name==="NodeOperationError"&&this.error.functionality==="configuration-node")return this.$locale.baseText("nodeErrorView.errorSubNode",{interpolate:{node:this.error.node.name}});if(this.error.message===this.error.description)return e;if(!((n=this.error.context)!=null&&n.messageTemplate))return e+this.error.message;const o=this.parameterDisplayName(this.error.context.parameter);return e+this.error.context.messageTemplate.replace(/%%PARAMETER%%/g,o)},parameterDisplayName(e,t=!0){try{const o=this.parameterName(this.parameters,e.split("."));if(!o.length)throw new Error;return t?o.map(n=>n.displayName).join(" > "):o.pop().displayName}catch{return`Could not find parameter "${e}"`}},parameterName(e,t){let o=t.shift();if(o===void 0)return[];const n=o.match(/(.*)\[([\d])\]$/);n!==null&&n.length>0&&(o=n[1]);const s=e.find(i=>i.name===o);if(s===void 0)throw new Error(`Could not find parameter "${o}"`);return t.length===0?[s]:s.hasOwnProperty("options")?[s,...this.parameterName(s.options,t)]:s.hasOwnProperty("values")?[s,...this.parameterName(s.values,t)]:[s]},copyCause(){this.clipboard.copy(JSON.stringify(this.error.cause)),this.copySuccess()},copySuccess(){this.showMessage({title:this.$locale.baseText("nodeErrorView.showMessage.title"),type:"info"})}}}),yl={class:"error-header"},wl=["textContent"],vl=["innerHTML"],Nl={class:"error-details__summary"},kl={class:"error-details__content"},bl={key:0},Tl={key:1},Sl={class:"clearfix box-card__title"},Dl={key:2,class:"el-card box-card is-never-shadow el-card__body"},El={class:"error-details__summary"},Cl={key:0},Il={class:"error-details__summary"},Pl={key:1},Ol={class:"error-details__summary"},$l={key:3},Rl={class:"clearfix box-card__title"},_l={key:4},Al={class:"clearfix box-card__title"},Ml=g("br",null,null,-1),Wl={class:"box-card__subtitle"},Vl={key:0,class:"copy-button"},Bl={key:2},Ul={key:5},Ll={class:"clearfix box-card__title"};function xl(e,t,o,n,s,i){const a=S("font-awesome-icon"),r=S("el-card"),l=S("n8n-icon-button"),d=S("VueJsonPretty");return c(),b("div",null,[g("div",yl,[g("div",{class:"error-message",textContent:T(e.getErrorMessage())},null,8,wl),e.error.description?(c(),b("div",{key:0,class:"error-description",innerHTML:e.getErrorDescription()},null,8,vl)):C("",!0)]),g("details",null,[g("summary",Nl,[m(a,{class:"error-details__icon",icon:"angle-right"}),I(" "+T(e.$locale.baseText("nodeErrorView.details")),1)]),g("div",kl,[e.error.context&&e.error.context.causeDetailed?(c(),b("div",bl,[m(r,{class:"box-card",shadow:"never"},{default:y(()=>[g("div",null,T(e.error.context.causeDetailed),1)]),_:1})])):C("",!0),e.error.timestamp?(c(),b("div",Tl,[m(r,{class:"box-card",shadow:"never"},{header:y(()=>[g("div",Sl,[g("span",null,T(e.$locale.baseText("nodeErrorView.time")),1)])]),default:y(()=>[g("div",null,T(new Date(e.error.timestamp).toLocaleString()),1)]),_:1})])):C("",!0),e.error.context&&e.error.context.itemIndex!==void 0?(c(),b("div",Dl,[g("span",El,T(e.$locale.baseText("nodeErrorView.itemIndex"))+":",1),I(" "+T(e.error.context.itemIndex)+" ",1),e.error.context.runIndex?(c(),b("span",Cl,[I(" | "),g("span",Il,T(e.$locale.baseText("nodeErrorView.itemIndex"))+":",1),I(" "+T(e.error.context.runIndex),1)])):C("",!0),e.error.context.parameter?(c(),b("span",Pl,[I(" | "),g("span",Ol,T(e.$locale.baseText("nodeErrorView.inParameter"))+":",1),I(" "+T(e.parameterDisplayName(e.error.context.parameter)),1)])):C("",!0)])):C("",!0),e.error.httpCode?(c(),b("div",$l,[m(r,{class:"box-card",shadow:"never"},{header:y(()=>[g("div",Rl,[g("span",null,T(e.$locale.baseText("nodeErrorView.httpCode")),1)])]),default:y(()=>[g("div",null,T(e.error.httpCode),1)]),_:1})])):C("",!0),e.error.cause?(c(),b("div",_l,[m(r,{class:"box-card",shadow:"never"},{header:y(()=>[g("div",Al,[g("span",null,T(e.$locale.baseText("nodeErrorView.cause")),1),Ml,g("span",Wl,T(e.$locale.baseText("nodeErrorView.dataBelowMayContain")),1)])]),default:y(()=>[g("div",null,[e.displayCause?(c(),b("div",Vl,[m(l,{title:e.$locale.baseText("nodeErrorView.copyToClipboard"),icon:"copy",onClick:e.copyCause},null,8,["title","onClick"])])):C("",!0),e.displayCause?(c(),P(d,{key:1,data:e.error.cause,deep:3,"show-length":!0,"selectable-type":"single",path:"error",class:"json-data"},null,8,["data"])):(c(),b("span",Bl,[m(a,{icon:"info-circle"}),I(T(e.$locale.baseText("nodeErrorView.theErrorCauseIsTooLargeToBeDisplayed")),1)]))])]),_:1})])):C("",!0),e.error.stack?(c(),b("div",Ul,[m(r,{class:"box-card",shadow:"never"},{header:y(()=>[g("div",Ll,[g("span",null,T(e.$locale.baseText("nodeErrorView.stack")),1)])]),default:y(()=>[g("div",null,[g("pre",null,[g("code",null,T(e.error.stack),1)])])]),_:1})])):C("",!0)])])])}const Hl=L(ml,[["render",xl]]),Fl={key:0},zl={key:1},Yl={key:2},Kl=x({__name:"RunDataPinButton",props:{tooltipContentsVisibility:{},dataPinningDocsUrl:{},pinnedData:{},disabled:{type:Boolean}},emits:["togglePinData"],setup(e,{emit:t}){const o=e,n=ge(),s=K(()=>o.tooltipContentsVisibility.pinDataDiscoveryTooltipContent?!0:void 0);return(i,a)=>{const r=S("n8n-link"),l=S("n8n-text"),d=S("n8n-icon-button"),h=S("n8n-tooltip");return c(),P(h,{placement:"bottom-end",visible:s.value},{content:y(()=>[o.tooltipContentsVisibility.binaryDataTooltipContent?(c(),b("div",Fl,T(B(n).baseText("ndv.pinData.pin.binary")),1)):o.tooltipContentsVisibility.pinDataDiscoveryTooltipContent?(c(),b("div",zl,T(B(n).baseText("node.discovery.pinData.ndv")),1)):(c(),b("div",Yl,[g("strong",null,T(B(n).baseText("ndv.pinData.pin.title")),1),m(l,{size:"small",tag:"p"},{default:y(()=>[I(T(B(n).baseText("ndv.pinData.pin.description"))+" ",1),m(r,{to:o.dataPinningDocsUrl,size:"small"},{default:y(()=>[I(T(B(n).baseText("ndv.pinData.pin.link")),1)]),_:1},8,["to"])]),_:1})]))]),default:y(()=>[m(d,{class:D(i.$style.pinDataButton),type:"tertiary",active:o.pinnedData.hasData.value,icon:"thumbtack",disabled:o.disabled,"data-test-id":"ndv-pin-data",onClick:a[0]||(a[0]=p=>t("togglePinData"))},null,8,["class","active","disabled"])]),_:1},8,["visible"])}}}),jl="_pinDataButton_fzux8_5",ql={pinDataButton:jl},Gl={$style:ql},Jl=L(Kl,[["__cssModules",Gl]]),Xl=Se(async()=>await Te(()=>import("./RunDataTable-5BP-mJaN.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41]))),Ql=Se(async()=>await Te(()=>import("./RunDataJson-pCteLtYj.js"),__vite__mapDeps([42,2,3,4,5,6,7,8,1,9,10,11,12,13,35,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,36,37,38,39,40,43]))),Zl=Se(async()=>await Te(()=>import("./RunDataSchema-bFDumJlX.js"),__vite__mapDeps([44,2,3,4,5,6,7,8,1,9,10,11,12,13,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,14,15,33,34,35,36,37,38,39,40,45]))),ed=Se(async()=>await Te(()=>Promise.resolve().then(()=>Zr),void 0)),td=Se(async()=>await Te(()=>import("./RunDataSearch-ZHNpHbv8.js"),__vite__mapDeps([46,2,3,4,5,6,7,8,1,9,10,11,12,13,47]))),od=x({name:"RunData",components:{BinaryDataDisplay:gl,NodeErrorView:Hl,JsonEditor:Zs,RunDataTable:Xl,RunDataJson:Ql,RunDataSchema:Zl,RunDataHtml:ed,RunDataSearch:td,RunDataPinButton:Jl},props:{node:{type:Object,default:null},runIndex:{type:Number,required:!0},linkedRuns:{type:Boolean},canLinkRuns:{type:Boolean},tooMuchDataTitle:{type:String},noDataInBranchMessage:{type:String},isExecuting:{type:Boolean},executingMessage:{type:String},sessionId:{type:String},paneType:{type:String,required:!0},overrideOutputs:{type:Array},mappingEnabled:{type:Boolean},distanceFromActive:{type:Number},blockUI:{type:Boolean,default:!1},isProductionExecutionPreview:{type:Boolean,default:!1},isPaneActive:{type:Boolean,default:!1}},setup(e){const t=q(),o=xe(),n=be(),s=Ui(e,"node"),i=Ne(s,{runIndex:e.runIndex,displayMode:t.getPanelDisplayMode(e.paneType)});return{...Le(),externalHooks:n,nodeHelpers:o,pinnedData:i}},data(){return{connectionType:_.Main,binaryDataPreviewActive:!1,dataSize:0,showData:!1,outputIndex:0,binaryDataDisplayVisible:!1,binaryDataDisplayData:null,MAX_DISPLAY_DATA_SIZE:hn,MAX_DISPLAY_ITEMS_AUTO_ALL:Kn,currentPage:1,pageSize:10,pageSizes:[10,25,50,100],pinDataDiscoveryTooltipVisible:!1,isControlledPinDataTooltip:!1,search:""}},mounted(){this.init(),this.isPaneTypeInput||this.showPinDataDiscoveryTooltip(this.jsonData),this.ndvStore.setNDVBranchIndex({pane:this.paneType,branchIndex:this.currentOutputIndex}),this.paneType==="output"&&(this.setDisplayMode(),this.activatePane())},beforeUnmount(){this.hidePinDataDiscoveryTooltip()},computed:{...G(j,q,z,Lt),isReadOnlyRoute(){var e,t;return((t=(e=this.$route)==null?void 0:e.meta)==null?void 0:t.readOnlyCanvas)===!0},activeNode(){return this.ndvStore.activeNode},dataPinningDocsUrl(){return jn},dataEditingDocsUrl(){return qn},displayMode(){return this.ndvStore.getPanelDisplayMode(this.paneType)},nodeType(){return this.node?this.nodeTypesStore.getNodeType(this.node.type,this.node.typeVersion):null},isSchemaView(){return this.displayMode==="schema"},isTriggerNode(){return this.node===null?!1:this.nodeTypesStore.isTriggerNode(this.node.type)},canPinData(){if(this.node===null)return!1;const e=this.workflowsStore.getCurrentWorkflow(),t=e.getNode(this.node.name),o=pe(e,t,this.nodeType);return!!!re(o).find(i=>i!==_.Main)&&!this.isPaneTypeInput&&this.pinnedData.isValidNodeType.value&&!(this.binaryData&&this.binaryData.length>0)},buttons(){var o;const e=[{label:this.$locale.baseText("runData.table"),value:"table"},{label:this.$locale.baseText("runData.json"),value:"json"}];this.binaryData.length&&e.push({label:this.$locale.baseText("runData.binary"),value:"binary"});const t={label:this.$locale.baseText("runData.schema"),value:"schema"};return this.isPaneTypeInput&&!oo(this.jsonData)?e.unshift(t):e.push(t),this.isPaneTypeOutput&&((o=this.activeNode)==null?void 0:o.type)===Pt&&this.activeNode.parameters.operation==="generateHtmlTemplate"&&e.unshift({label:"HTML",value:"html"}),e},hasNodeRun(){return!!(!this.isExecuting&&this.node&&(this.workflowRunData&&this.workflowRunData.hasOwnProperty(this.node.name)||this.pinnedData.hasData.value))},isArtificialRecoveredEventItem(){var e,t,o;return!!((o=(t=(e=this.rawInputData)==null?void 0:e[0])==null?void 0:t.json)!=null&&o.isArtificialRecoveredEventItem)},subworkflowExecutionError(){return this.workflowsStore.subWorkflowExecutionError},hasSubworkflowExecutionError(){return!!this.subworkflowExecutionError},hasRunError(){var e,t,o;return!!(this.node&&((o=(t=(e=this.workflowRunData)==null?void 0:e[this.node.name])==null?void 0:t[this.runIndex])!=null&&o.error))},workflowExecution(){return this.workflowsStore.getWorkflowExecution},workflowRunData(){if(this.workflowExecution===null)return null;const e=this.workflowExecution.data;return e!=null&&e.resultData?e.resultData.runData:null},dataCount(){return this.getDataCount(this.runIndex,this.currentOutputIndex)},unfilteredDataCount(){return this.pinnedData.data.value?this.pinnedData.data.value.length:this.rawInputData.length},dataSizeInMB(){return(this.dataSize/1024/1e3).toLocaleString()},maxOutputIndex(){if(this.node===null||this.runIndex===void 0)return 0;const e=this.workflowRunData;if(e===null||!e.hasOwnProperty(this.node.name)||e[this.node.name].length<this.runIndex)return 0;if(e[this.node.name][this.runIndex]){const t=e[this.node.name][this.runIndex].data;if(t!=null&&t.main)return t.main.length-1}return 0},currentPageOffset(){return this.pageSize*(this.currentPage-1)},maxRunIndex(){if(this.node===null)return 0;const e=this.workflowRunData;return e===null||!e.hasOwnProperty(this.node.name)?0:e[this.node.name].length?e[this.node.name].length-1:0},rawInputData(){return this.getRawInputData(this.runIndex,this.currentOutputIndex,this.connectionType)},inputData(){const e=this.getPinDataOrLiveData(this.rawInputData);return this.getFilteredData(e)},inputDataPage(){const e=this.pageSize*(this.currentPage-1);return this.inputData.slice(e,e+this.pageSize)},jsonData(){return no(this.inputData)},binaryData(){return this.node?this.nodeHelpers.getBinaryData(this.workflowRunData,this.node.name,this.runIndex,this.currentOutputIndex).filter(t=>!!(t&&Object.keys(t).length)):[]},currentOutputIndex(){var e;return(e=this.overrideOutputs)!=null&&e.length&&!this.overrideOutputs.includes(this.outputIndex)?this.overrideOutputs[0]:this.outputIndex},branches(){var o;const e=n=>n.charAt(0).toLocaleUpperCase()+n.slice(1),t=[];for(let n=0;n<=this.maxOutputIndex;n++){if(this.overrideOutputs&&!this.overrideOutputs.includes(n))continue;const s=this.getRawInputData(this.runIndex,n).length,i=this.getDataCount(this.runIndex,n),a=this.search?this.$locale.baseText("ndv.search.items",{adjustToNumber:s,interpolate:{matched:i,total:s}}):this.$locale.baseText("ndv.output.items",{adjustToNumber:i,interpolate:{count:i}});let r=this.getOutputName(n);if(`${r}`==`${n}`)r=`${this.$locale.baseText("ndv.output")} ${r}`;else{const l=Gn.includes((o=this.node)==null?void 0:o.type)?"":` ${this.$locale.baseText("ndv.output.branch")}`;r=e(`${this.getOutputName(n)}${l}`)}t.push({label:this.search&&i||s?`${r} (${a})`:r,value:n})}return t},editMode(){return this.isPaneTypeInput?{enabled:!1,value:""}:this.ndvStore.outputPanelEditMode},isPaneTypeInput(){return this.paneType==="input"},isPaneTypeOutput(){return this.paneType==="output"},readOnlyEnv(){return this.sourceControlStore.preferences.branchReadOnly},showIOSearch(){return this.hasNodeRun&&!this.hasRunError},showIoSearchNoMatchContent(){return this.hasNodeRun&&!this.inputData.length&&this.search}},methods:{getResolvedNodeOutputs(){if(this.node&&this.nodeType){const e=this.workflowsStore.getCurrentWorkflow(),t=e.getNode(this.node.name);if(t)return ve(e,t,this.nodeType)}return[]},onItemHover(e){if(e===null){this.$emit("itemHover",null);return}this.$emit("itemHover",{outputIndex:this.currentOutputIndex,itemIndex:e})},onClickDataPinningDocsLink(){var e;this.$telemetry.track("User clicked ndv link",{workflow_id:this.workflowsStore.workflowId,session_id:this.sessionId,node_type:(e=this.activeNode)==null?void 0:e.type,pane:"output",type:"data-pinning-docs"})},showPinDataDiscoveryTooltip(e){if(!this.isTriggerNode)return;const t=Ie(io).value;e&&e.length>0&&!this.isReadOnlyRoute&&!t&&(this.pinDataDiscoveryComplete(),setTimeout(()=>{this.isControlledPinDataTooltip=!0,this.pinDataDiscoveryTooltipVisible=!0,ye.emit("data-pinning-discovery",{isTooltipVisible:!0})},500))},hidePinDataDiscoveryTooltip(){this.pinDataDiscoveryTooltipVisible&&(this.isControlledPinDataTooltip=!1,this.pinDataDiscoveryTooltipVisible=!1,ye.emit("data-pinning-discovery",{isTooltipVisible:!1}))},pinDataDiscoveryComplete(){Ie(io).value="true",Ie(Ot).value="true"},enterEditMode({origin:e}){var n;const t=this.pinnedData.data.value?so(this.pinnedData.data.value):no(this.rawInputData),o=t.length>0?t:Jn;this.ndvStore.setOutputPanelEditModeEnabled(!0),this.ndvStore.setOutputPanelEditModeValue(JSON.stringify(o,null,2)),this.$telemetry.track("User opened ndv edit state",{node_type:(n=this.activeNode)==null?void 0:n.type,click_type:e==="editIconButton"?"button":"link",session_id:this.sessionId,run_index:this.runIndex,is_output_present:this.hasNodeRun||this.pinnedData.hasData.value,view:!this.hasNodeRun&&!this.pinnedData.hasData.value?"undefined":this.displayMode,is_data_pinned:this.pinnedData.hasData.value})},onClickCancelEdit(){this.ndvStore.setOutputPanelEditModeEnabled(!1),this.ndvStore.setOutputPanelEditModeValue(""),this.onExitEditMode({type:"cancel"})},onClickSaveEdit(){if(!this.node)return;const{value:e}=this.editMode;this.clearAllStickyNotifications();try{this.pinnedData.setData(so(e),"save-edit")}catch(t){console.error(t);return}this.ndvStore.setOutputPanelEditModeEnabled(!1),this.onExitEditMode({type:"save"})},onExitEditMode({type:e}){var t;this.$telemetry.track("User closed ndv edit state",{node_type:(t=this.activeNode)==null?void 0:t.type,session_id:this.sessionId,run_index:this.runIndex,view:this.displayMode,type:e})},async onTogglePinData({source:e}){if(this.node){if(e==="pin-icon-click"){const t={node_type:this.activeNode.type,session_id:this.sessionId,run_index:this.runIndex,view:!this.hasNodeRun&&!this.pinnedData.hasData.value?"none":this.displayMode};this.externalHooks.run("runData.onTogglePinData",t),this.$telemetry.track("User clicked pin data icon",t)}if(this.nodeHelpers.updateNodeParameterIssues(this.node),this.pinnedData.hasData.value){this.pinnedData.unsetData(e);return}try{this.pinnedData.setData(this.rawInputData,"pin-icon-click")}catch(t){console.error(t);return}this.maxRunIndex>0&&this.showToast({title:this.$locale.baseText("ndv.pinData.pin.multipleRuns.title",{interpolate:{index:`${this.runIndex}`}}),message:this.$locale.baseText("ndv.pinData.pin.multipleRuns.description"),type:"success",duration:2e3}),this.hidePinDataDiscoveryTooltip(),this.pinDataDiscoveryComplete()}},switchToBinary(){this.onDisplayModeChange("binary")},onBranchChange(e){this.outputIndex=e,this.$telemetry.track("User changed ndv branch",{session_id:this.sessionId,branch_index:e,node_type:this.activeNode.type,node_type_input_selection:this.nodeType?this.nodeType.name:"",pane:this.paneType})},showTooMuchData(){this.showData=!0,this.$telemetry.track("User clicked ndv button",{node_type:this.activeNode.type,workflow_id:this.workflowsStore.workflowId,session_id:this.sessionId,pane:this.paneType,type:"showTooMuchData"})},toggleLinkRuns(){this.linkedRuns?this.unlinkRun():this.linkRun()},linkRun(){this.$emit("linkRun")},unlinkRun(){this.$emit("unlinkRun")},onCurrentPageChange(e){var t;this.currentPage=e,this.$telemetry.track("User changed ndv page",{node_type:(t=this.activeNode)==null?void 0:t.type,workflow_id:this.workflowsStore.workflowId,session_id:this.sessionId,pane:this.paneType,page_selected:this.currentPage,page_size:this.pageSize,items_total:this.dataCount})},onPageSizeChange(e){var o;this.pageSize=e;const t=Math.ceil(this.dataCount/this.pageSize);t<this.currentPage&&(this.currentPage=t),this.$telemetry.track("User changed ndv page size",{node_type:(o=this.activeNode)==null?void 0:o.type,workflow_id:this.workflowsStore.workflowId,session_id:this.sessionId,pane:this.paneType,page_selected:this.currentPage,page_size:this.pageSize,items_total:this.dataCount})},onDisplayModeChange(e){const t=this.displayMode;this.ndvStore.setPanelDisplayMode({pane:this.paneType,mode:e});const o=this.$refs.dataContainer;if(o){const n=o.children[0];n&&n.scrollTo(0,0)}this.closeBinaryDataDisplay(),this.externalHooks.run("runData.displayModeChanged",{newValue:e,oldValue:t}),this.activeNode&&this.$telemetry.track("User changed ndv item view",{previous_view:t,new_view:e,node_type:this.activeNode.type,workflow_id:this.workflowsStore.workflowId,session_id:this.sessionId,pane:this.paneType})},getRunLabel(e){let t=0;for(let s=0;s<=this.maxOutputIndex;s++)t+=this.getPinDataOrLiveData(this.getRawInputData(e-1,s)).length;const o=this.$locale.baseText("ndv.output.items",{adjustToNumber:t,interpolate:{count:t}}),n=t>0?` (${o})`:"";return e+this.$locale.baseText("ndv.output.of")+(this.maxRunIndex+1)+n},getRawInputData(e,t,o=_.Main){let n=[];return this.node&&(n=this.nodeHelpers.getNodeInputData(this.node,e,t,this.paneType,o)),n.length===0||!Array.isArray(n)?[]:n},getPinDataOrLiveData(e){return this.pinnedData.data.value&&!this.isProductionExecutionPreview?Array.isArray(this.pinnedData.data.value)?this.pinnedData.data.value.map(t=>({json:t})):[{json:this.pinnedData.data.value}]:e},getFilteredData(e){return this.search?(this.currentPage=1,e.filter(({json:t})=>Xn(t,this.search))):e},getDataCount(e,t,o=_.Main){var i,a,r;if(!this.node)return 0;if((r=(a=(i=this.workflowRunData)==null?void 0:i[this.node.name])==null?void 0:a[e])!=null&&r.hasOwnProperty("error"))return 1;const n=this.getRawInputData(e,t,o),s=this.getPinDataOrLiveData(n);return this.getFilteredData(s).length},init(){this.outputIndex=0,this.refreshDataSize(),this.closeBinaryDataDisplay();let e=[];if(this.nodeType!==null&&this.node!==null){const t=this.getResolvedNodeOutputs();e=re(t)}this.connectionType=e.length===0?_.Main:e[0],this.binaryData.length>0?this.ndvStore.setPanelDisplayMode({pane:this.paneType,mode:"binary"}):this.displayMode==="binary"&&this.ndvStore.setPanelDisplayMode({pane:this.paneType,mode:"table"})},closeBinaryDataDisplay(){this.binaryDataDisplayVisible=!1,this.binaryDataDisplayData=null},clearExecutionData(){this.workflowsStore.setWorkflowExecutionData(null),this.nodeHelpers.updateNodesExecutionIssues()},isViewable(e,t){const{fileType:o}=this.binaryData[e][t];return!!o&&["image","audio","video","text","json","pdf","html"].includes(o)},isDownloadable(e,t){const{mimeType:o,fileName:n}=this.binaryData[e][t];return!!(o&&n)},async downloadBinaryData(e,t){const{id:o,data:n,fileName:s,fileExtension:i,mimeType:a}=this.binaryData[e][t];if(o){const r=this.workflowsStore.getBinaryUrl(o,"download",s,a);Et.saveAs(r,[s,i].join("."));return}else{const r="data:"+a+";base64,"+n,l=await fetch(r).then(async d=>await d.blob());Et.saveAs(l,s)}},async downloadJsonData(){const e=this.node.name.replace(/[^\w\d]/g,"_"),t=new Blob([JSON.stringify(this.rawInputData,null,2)],{type:"application/json"});Et.saveAs(t,`${e}.json`)},displayBinaryData(e,t){this.binaryDataDisplayVisible=!0,this.binaryDataDisplayData={node:this.node.name,runIndex:this.runIndex,outputIndex:this.currentOutputIndex,index:e,key:t}},getOutputName(e){if(this.node===null)return e+1;const t=this.nodeType,o=this.getResolvedNodeOutputs(),n=o==null?void 0:o[e];return n&&Fi(n)?n==null?void 0:n.displayName:!(t!=null&&t.outputNames)||t.outputNames.length<=e?e+1:t.outputNames[e]},refreshDataSize(){this.showData=!1;const e=this.inputDataPage.map(t=>t.json);this.dataSize=JSON.stringify(e).length,this.dataSize<this.MAX_DISPLAY_DATA_SIZE&&(this.showData=!0)},onRunIndexChange(e){this.$emit("runChange",e)},enableNode(){if(this.node){const e={name:this.node.name,properties:{disabled:!this.node.disabled}};this.workflowsStore.updateNodeProperties(e)}},setDisplayMode(){if(!this.activeNode)return;this.activeNode.type===Pt&&this.activeNode.parameters.operation==="generateHtmlTemplate"&&this.ndvStore.setPanelDisplayMode({pane:"output",mode:"html"})},activatePane(){this.$emit("activatePane")},onSearchClear(){this.search="",document.dispatchEvent(new KeyboardEvent("keyup",{key:"/"}))}},watch:{node(){this.init()},hasNodeRun(){this.paneType==="output"&&this.setDisplayMode()},inputDataPage:{handler(e){this.paneType&&e&&this.ndvStore.setNDVPanelDataIsEmpty({panel:this.paneType,isEmpty:e.every(t=>oo(t.json))})},immediate:!0,deep:!0},jsonData(e){this.refreshDataSize(),this.showPinDataDiscoveryTooltip(e)},binaryData(e,t){e.length&&!t.length&&this.displayMode!=="binary"?this.switchToBinary():!e.length&&this.displayMode==="binary"&&this.onDisplayModeChange("table")},currentOutputIndex(e){this.ndvStore.setNDVBranchIndex({pane:this.paneType,branchIndex:e})},search(e){this.$emit("search",e)}}}),nd="_infoIcon_1s3ok_5",sd="_center_1s3ok_9",id="_container_1s3ok_23",ad="_pinnedDataCallout_1s3ok_32",rd="_header_1s3ok_40",ld="_dataContainer_1s3ok_54",dd="_dataDisplay_1s3ok_63",ud="_tabs_1s3ok_75",cd="_itemsCount_1s3ok_82",hd="_runSelector_1s3ok_90",pd="_runSelectorWrapper_1s3ok_99",fd="_pagination_1s3ok_104",gd="_pageSizeSelector_1s3ok_114",md="_binaryIndex_1s3ok_120",yd="_binaryRow_1s3ok_137",wd="_binaryCell_1s3ok_142",vd="_binaryHeader_1s3ok_154",Nd="_binaryButtonContainer_1s3ok_163",kd="_binaryValue_1s3ok_174",bd="_displayModes_1s3ok_179",Td="_tooltipContain_1s3ok_185",Sd="_spinner_1s3ok_189",Dd="_editMode_1s3ok_200",Ed="_editModeBody_1s3ok_209",Cd="_editModeFooter_1s3ok_216",Id="_editModeFooterInfotip_1s3ok_226",Pd="_editModeActions_1s3ok_232",Od="_stretchVertically_1s3ok_239",$d="_uiBlocker_1s3ok_243",Rd={infoIcon:nd,center:sd,container:id,pinnedDataCallout:ad,header:rd,dataContainer:ld,"actions-group":"_actions-group_1s3ok_59",dataDisplay:dd,tabs:ud,itemsCount:cd,runSelector:hd,runSelectorWrapper:pd,pagination:fd,pageSizeSelector:gd,binaryIndex:md,binaryRow:yd,binaryCell:wd,binaryHeader:vd,binaryButtonContainer:Nd,binaryValue:kd,displayModes:bd,tooltipContain:Td,spinner:Sd,editMode:Dd,editModeBody:Ed,editModeFooter:Cd,editModeFooterInfotip:Id,editModeActions:Pd,stretchVertically:Od,uiBlocker:$d},_d={key:0,class:"ml-4xs"},Ad={key:0},Md=["innerHTML"],Wd=["data-test-id"],Vd={key:0},Bd={key:1},Ud={key:2},Ld={key:3},xd={key:4};function Hd(e,t,o,n,s,i){var Gt,Jt,Xt;const a=S("n8n-link"),r=S("n8n-callout"),l=S("BinaryDataDisplay"),d=S("n8n-radio-buttons"),h=S("n8n-icon-button"),p=S("RunDataPinButton"),w=S("n8n-button"),f=S("n8n-option"),N=S("n8n-select"),E=S("n8n-tooltip"),u=S("RunDataSearch"),k=S("n8n-tabs"),v=S("n8n-text"),$=S("n8n-spinner"),M=S("JsonEditor"),R=S("n8n-info-tip"),A=S("NodeErrorView"),O=S("i18n-t"),W=S("RunDataTable"),V=S("RunDataJson"),Z=S("RunDataHtml"),fe=S("RunDataSchema"),$e=S("el-pagination"),wt=S("n8n-block-ui");return c(),b("div",{class:D(["run-data",e.$style.container]),onMouseover:t[14]||(t[14]=(...U)=>e.activatePane&&e.activatePane(...U))},[e.canPinData&&e.pinnedData.hasData.value&&!e.editMode.enabled&&!e.isProductionExecutionPreview?(c(),P(r,{key:0,theme:"secondary",icon:"thumbtack",class:D(e.$style.pinnedDataCallout)},{trailingContent:y(()=>[m(a,{to:e.dataPinningDocsUrl,size:"small",theme:"secondary",bold:"",underline:"",onClick:e.onClickDataPinningDocsLink},{default:y(()=>[I(T(e.$locale.baseText("runData.pindata.learnMore")),1)]),_:1},8,["to","onClick"])]),default:y(()=>[I(T(e.$locale.baseText("runData.pindata.thisDataIsPinned"))+" ",1),!e.isReadOnlyRoute&&!e.readOnlyEnv?(c(),b("span",_d,[m(a,{theme:"secondary",size:"small",underline:"",bold:"",onClick:t[0]||(t[0]=te(U=>e.onTogglePinData({source:"banner-link"}),["stop"]))},{default:y(()=>[I(T(e.$locale.baseText("runData.pindata.unpin")),1)]),_:1})])):C("",!0)]),_:1},8,["class"])):C("",!0),m(l,{"window-visible":e.binaryDataDisplayVisible,"display-data":e.binaryDataDisplayData,onClose:e.closeBinaryDataDisplay},null,8,["window-visible","display-data","onClose"]),g("div",{class:D(e.$style.header)},[ne(e.$slots,"header",{},void 0,!0),Y(g("div",{class:D(e.$style.displayModes),"data-test-id":"run-data-pane-header",onClick:t[3]||(t[3]=te(()=>{},["stop"]))},[Y(m(d,{"model-value":e.displayMode,options:e.buttons,"data-test-id":"ndv-run-data-display-mode","onUpdate:modelValue":e.onDisplayModeChange},null,8,["model-value","options","onUpdate:modelValue"]),[[J,e.hasNodeRun&&(e.inputData.length||e.binaryData.length||e.search)&&!e.editMode.enabled]]),e.canPinData&&!e.isReadOnlyRoute&&!e.readOnlyEnv?Y((c(),P(h,{key:0,title:e.$locale.baseText("runData.editOutput"),circle:!1,disabled:e.node.disabled,class:"ml-2xs",icon:"pencil-alt",type:"tertiary","data-test-id":"ndv-edit-pinned-data",onClick:t[1]||(t[1]=U=>e.enterEditMode({origin:"editIconButton"}))},null,8,["title","disabled"])),[[J,!e.editMode.enabled]]):C("",!0),(e.canPinData||(Gt=e.binaryData)!=null&&Gt.length)&&e.rawInputData.length&&!e.editMode.enabled?(c(),P(p,{key:1,disabled:!e.rawInputData.length&&!e.pinnedData.hasData.value||e.isReadOnlyRoute||e.readOnlyEnv||!!((Jt=e.binaryData)!=null&&Jt.length),"tooltip-contents-visibility":{binaryDataTooltipContent:!!((Xt=e.binaryData)!=null&&Xt.length),pinDataDiscoveryTooltipContent:e.isControlledPinDataTooltip&&e.pinDataDiscoveryTooltipVisible},"data-pinning-docs-url":e.dataPinningDocsUrl,"pinned-data":e.pinnedData,onTogglePinData:t[2]||(t[2]=U=>e.onTogglePinData({source:"pin-icon-click"}))},null,8,["disabled","tooltip-contents-visibility","data-pinning-docs-url","pinned-data"])):C("",!0),Y(g("div",{class:D(e.$style.editModeActions)},[m(w,{type:"tertiary",label:e.$locale.baseText("runData.editor.cancel"),onClick:e.onClickCancelEdit},null,8,["label","onClick"]),m(w,{class:"ml-2xs",type:"primary",label:e.$locale.baseText("runData.editor.save"),onClick:e.onClickSaveEdit},null,8,["label","onClick"])],2),[[J,e.editMode.enabled]])],2),[[J,!e.hasRunError]])],2),e.maxRunIndex>0?Y((c(),b("div",{key:1,class:D(e.$style.runSelector),"data-test-id":"run-selector"},[g("div",{class:D(e.$style.runSelectorWrapper)},[m(N,{size:"small","model-value":e.runIndex,teleported:"","onUpdate:modelValue":e.onRunIndexChange,onClick:t[4]||(t[4]=te(()=>{},["stop"]))},{prepend:y(()=>[I(T(e.$locale.baseText("ndv.output.run")),1)]),default:y(()=>[(c(!0),b(Q,null,ae(e.maxRunIndex+1,U=>(c(),P(f,{key:U,label:e.getRunLabel(U),value:U-1},null,8,["label","value"]))),128))]),_:1},8,["model-value","onUpdate:modelValue"]),e.canLinkRuns?(c(),P(E,{key:0,placement:"right"},{content:y(()=>[I(T(e.$locale.baseText(e.linkedRuns?"runData.unlinking.hint":"runData.linking.hint")),1)]),default:y(()=>[m(h,{class:"linkRun",icon:e.linkedRuns?"unlink":"link",text:"",type:"tertiary",size:"small",onClick:e.toggleLinkRuns},null,8,["icon","onClick"])]),_:1})):C("",!0),ne(e.$slots,"run-info",{},void 0,!0)],2),e.showIOSearch?(c(),P(u,{key:0,modelValue:e.search,"onUpdate:modelValue":t[5]||(t[5]=U=>e.search=U),"pane-type":e.paneType,"is-area-active":e.isPaneActive,onFocus:e.activatePane},null,8,["modelValue","pane-type","is-area-active","onFocus"])):C("",!0)],2)),[[J,!e.editMode.enabled]]):C("",!0),ne(e.$slots,"before-data",{},void 0,!0),e.maxOutputIndex>0&&e.branches.length>1?(c(),b("div",{key:2,class:D(e.$style.tabs),"data-test-id":"branches"},[m(k,{"model-value":e.currentOutputIndex,options:e.branches,"onUpdate:modelValue":e.onBranchChange},null,8,["model-value","options","onUpdate:modelValue"]),e.showIOSearch?(c(),P(u,{key:0,modelValue:e.search,"onUpdate:modelValue":t[6]||(t[6]=U=>e.search=U),"pane-type":e.paneType,"is-area-active":e.isPaneActive,onFocus:e.activatePane},null,8,["modelValue","pane-type","is-area-active","onFocus"])):C("",!0)],2)):e.hasNodeRun&&(e.dataCount>0&&e.maxRunIndex===0||e.search)&&!e.isArtificialRecoveredEventItem?Y((c(),b("div",{key:3,class:D(e.$style.itemsCount),"data-test-id":"ndv-items-count"},[e.search?(c(),P(v,{key:0},{default:y(()=>[I(T(e.$locale.baseText("ndv.search.items",{adjustToNumber:e.unfilteredDataCount,interpolate:{matched:e.dataCount,total:e.unfilteredDataCount}})),1)]),_:1})):(c(),P(v,{key:1},{default:y(()=>[I(T(e.$locale.baseText("ndv.output.items",{adjustToNumber:e.dataCount,interpolate:{count:e.dataCount}})),1)]),_:1})),e.showIOSearch?(c(),P(u,{key:2,modelValue:e.search,"onUpdate:modelValue":t[7]||(t[7]=U=>e.search=U),"pane-type":e.paneType,"is-area-active":e.isPaneActive,onFocus:e.activatePane},null,8,["modelValue","pane-type","is-area-active","onFocus"])):C("",!0)],2)),[[J,!e.editMode.enabled]]):C("",!0),g("div",{ref:"dataContainer",class:D(e.$style.dataContainer),"data-test-id":"ndv-data-container"},[e.isExecuting?(c(),b("div",{key:0,class:D(e.$style.center),"data-test-id":"ndv-executing"},[g("div",{class:D(e.$style.spinner)},[m($,{type:"ring"})],2),m(v,null,{default:y(()=>[I(T(e.executingMessage),1)]),_:1})],2)):e.editMode.enabled?(c(),b("div",{key:1,class:D(e.$style.editMode)},[g("div",{class:D([e.$style.editModeBody,"ignore-key-press"])},[m(M,{"model-value":e.editMode.value,"onUpdate:modelValue":t[8]||(t[8]=U=>e.ndvStore.setOutputPanelEditModeValue(U))},null,8,["model-value"])],2),g("div",{class:D(e.$style.editModeFooter)},[m(R,{bold:!1,class:D(e.$style.editModeFooterInfotip)},{default:y(()=>[I(T(e.$locale.baseText("runData.editor.copyDataInfo"))+" ",1),m(a,{to:e.dataEditingDocsUrl,size:"small"},{default:y(()=>[I(T(e.$locale.baseText("generic.learnMore")),1)]),_:1},8,["to"])]),_:1},8,["class"])],2)],2)):e.paneType==="output"&&e.hasSubworkflowExecutionError?(c(),b("div",{key:2,class:D(e.$style.stretchVertically)},[m(A,{error:e.subworkflowExecutionError,class:D(e.$style.errorDisplay)},null,8,["error","class"])],2)):e.hasNodeRun?e.paneType==="input"&&e.node.disabled?(c(),b("div",{key:4,class:D(e.$style.center)},[m(v,null,{default:y(()=>[I(T(e.$locale.baseText("ndv.input.disabled",{interpolate:{nodeName:e.node.name}}))+" ",1),m(a,{onClick:e.enableNode},{default:y(()=>[I(T(e.$locale.baseText("ndv.input.disabled.cta")),1)]),_:1},8,["onClick"])]),_:1})],2)):e.hasNodeRun&&e.isArtificialRecoveredEventItem?(c(),b("div",{key:5,class:D(e.$style.center)},[ne(e.$slots,"recovered-artificial-output-data",{},void 0,!0)],2)):e.hasNodeRun&&e.hasRunError?(c(),b("div",{key:6,class:D(e.$style.stretchVertically)},[e.isPaneTypeInput?(c(),P(v,{key:0,class:D(e.$style.center),size:"large",tag:"p",bold:""},{default:y(()=>[I(T(e.$locale.baseText("nodeErrorView.inputPanel.previousNodeError.title",{interpolate:{nodeName:e.node.name}})),1)]),_:1},8,["class"])):e.$slots.content?ne(e.$slots,"content",{key:1},void 0,!0):(c(),P(A,{key:2,error:e.workflowRunData[e.node.name][e.runIndex].error,class:D(e.$style.dataDisplay)},null,8,["error","class"]))],2)):e.hasNodeRun&&(!e.unfilteredDataCount||e.search&&!e.dataCount)&&e.branches.length>1?(c(),b("div",{key:7,class:D(e.$style.center)},[e.search?(c(),b("div",Ad,[m(v,{tag:"h3",size:"large"},{default:y(()=>[I(T(e.$locale.baseText("ndv.search.noMatch.title")),1)]),_:1}),m(v,null,{default:y(()=>[m(O,{keypath:"ndv.search.noMatch.description",tag:"span"},{link:y(()=>[g("a",{href:"#",onClick:t[9]||(t[9]=(...U)=>e.onSearchClear&&e.onSearchClear(...U))},T(e.$locale.baseText("ndv.search.noMatch.description.link")),1)]),_:1})]),_:1})])):(c(),P(v,{key:1},{default:y(()=>[I(T(e.noDataInBranchMessage),1)]),_:1}))],2)):e.hasNodeRun&&!e.inputData.length&&!e.search?(c(),b("div",{key:8,class:D(e.$style.center)},[ne(e.$slots,"no-output-data",{},()=>[I("xxx")],!0)],2)):e.hasNodeRun&&!e.showData?(c(),b("div",{key:9,class:D(e.$style.center)},[m(v,{bold:!0,color:"text-dark",size:"large"},{default:y(()=>[I(T(e.tooMuchDataTitle),1)]),_:1}),m(v,{align:"center",tag:"div"},{default:y(()=>[g("span",{innerHTML:e.$locale.baseText("ndv.output.tooMuchData.message",{interpolate:{size:e.dataSizeInMB}})},null,8,Md)]),_:1}),m(w,{outline:"",label:e.$locale.baseText("ndv.output.tooMuchData.showDataAnyway"),onClick:e.showTooMuchData},null,8,["label","onClick"]),m(w,{size:"small",label:e.$locale.baseText("runData.downloadBinaryData"),onClick:t[10]||(t[10]=U=>e.downloadJsonData())},null,8,["label"])],2)):e.hasNodeRun&&e.$slots.content?ne(e.$slots,"content",{key:10},void 0,!0):e.hasNodeRun&&e.displayMode==="table"&&e.binaryData.length>0&&e.inputData.length===1&&Object.keys(e.jsonData[0]||{}).length===0?(c(),b("div",{key:11,class:D(e.$style.center)},[m(v,null,{default:y(()=>[I(T(e.$locale.baseText("runData.switchToBinary.info"))+" ",1),g("a",{onClick:t[11]||(t[11]=(...U)=>e.switchToBinary&&e.switchToBinary(...U))},T(e.$locale.baseText("runData.switchToBinary.binary")),1)]),_:1})],2)):e.showIoSearchNoMatchContent?(c(),b("div",{key:12,class:D(e.$style.center)},[m(v,{tag:"h3",size:"large"},{default:y(()=>[I(T(e.$locale.baseText("ndv.search.noMatch.title")),1)]),_:1}),m(v,null,{default:y(()=>[m(O,{keypath:"ndv.search.noMatch.description",tag:"span"},{link:y(()=>[g("a",{href:"#",onClick:t[12]||(t[12]=(...U)=>e.onSearchClear&&e.onSearchClear(...U))},T(e.$locale.baseText("ndv.search.noMatch.description.link")),1)]),_:1})]),_:1})],2)):e.hasNodeRun&&e.displayMode==="table"?(c(),P(we,{key:13},{default:y(()=>[m(W,{node:e.node,"input-data":e.inputDataPage,"mapping-enabled":e.mappingEnabled,"distance-from-active":e.distanceFromActive,"run-index":e.runIndex,"page-offset":e.currentPageOffset,"total-runs":e.maxRunIndex,"has-default-hover-state":e.paneType==="input"&&!e.search,search:e.search,onMounted:t[13]||(t[13]=U=>e.$emit("tableMounted",U)),onActiveRowChanged:e.onItemHover,onDisplayModeChange:e.onDisplayModeChange},null,8,["node","input-data","mapping-enabled","distance-from-active","run-index","page-offset","total-runs","has-default-hover-state","search","onActiveRowChanged","onDisplayModeChange"])]),_:1})):e.hasNodeRun&&e.displayMode==="json"?(c(),P(we,{key:14},{default:y(()=>[m(V,{"pane-type":e.paneType,"edit-mode":e.editMode,"sessio-id":e.sessionId,node:e.node,"input-data":e.inputDataPage,"mapping-enabled":e.mappingEnabled,"distance-from-active":e.distanceFromActive,"run-index":e.runIndex,"total-runs":e.maxRunIndex,search:e.search},null,8,["pane-type","edit-mode","sessio-id","node","input-data","mapping-enabled","distance-from-active","run-index","total-runs","search"])]),_:1})):e.hasNodeRun&&e.isPaneTypeOutput&&e.displayMode==="html"?(c(),P(we,{key:15},{default:y(()=>[m(Z,{"input-html":e.inputDataPage[0].json.html},null,8,["input-html"])]),_:1})):e.hasNodeRun&&e.isSchemaView?(c(),P(we,{key:16},{default:y(()=>[m(fe,{data:e.jsonData,"mapping-enabled":e.mappingEnabled,"distance-from-active":e.distanceFromActive,node:e.node,"pane-type":e.paneType,"run-index":e.runIndex,"total-runs":e.maxRunIndex,search:e.search},null,8,["data","mapping-enabled","distance-from-active","node","pane-type","run-index","total-runs","search"])]),_:1})):e.displayMode==="binary"&&e.binaryData.length===0?(c(),b("div",{key:17,class:D(e.$style.center)},[m(v,{align:"center",tag:"div"},{default:y(()=>[I(T(e.$locale.baseText("runData.noBinaryDataFound")),1)]),_:1})],2)):e.displayMode==="binary"?(c(),b("div",{key:18,class:D(e.$style.dataDisplay)},[(c(!0),b(Q,null,ae(e.binaryData,(U,me)=>(c(),b("div",{key:me},[e.binaryData.length>1?(c(),b("div",{key:0,class:D(e.$style.binaryIndex)},[g("div",null,T(me+1),1)],2)):C("",!0),g("div",{class:D(e.$style.binaryRow)},[(c(!0),b(Q,null,ae(U,(de,Re)=>(c(),b("div",{key:me+"_"+Re,class:D(e.$style.binaryCell)},[g("div",{"data-test-id":"ndv-binary-data_"+me},[g("div",{class:D(e.$style.binaryHeader)},T(Re),3),de.fileName?(c(),b("div",Vd,[g("div",null,[m(v,{size:"small",bold:!0},{default:y(()=>[I(T(e.$locale.baseText("runData.fileName"))+": ",1)]),_:1})]),g("div",{class:D(e.$style.binaryValue)},T(de.fileName),3)])):C("",!0),de.directory?(c(),b("div",Bd,[g("div",null,[m(v,{size:"small",bold:!0},{default:y(()=>[I(T(e.$locale.baseText("runData.directory"))+": ",1)]),_:1})]),g("div",{class:D(e.$style.binaryValue)},T(de.directory),3)])):C("",!0),de.fileExtension?(c(),b("div",Ud,[g("div",null,[m(v,{size:"small",bold:!0},{default:y(()=>[I(T(e.$locale.baseText("runData.fileExtension"))+":",1)]),_:1})]),g("div",{class:D(e.$style.binaryValue)},T(de.fileExtension),3)])):C("",!0),de.mimeType?(c(),b("div",Ld,[g("div",null,[m(v,{size:"small",bold:!0},{default:y(()=>[I(T(e.$locale.baseText("runData.mimeType"))+": ",1)]),_:1})]),g("div",{class:D(e.$style.binaryValue)},T(de.mimeType),3)])):C("",!0),de.fileSize?(c(),b("div",xd,[g("div",null,[m(v,{size:"small",bold:!0},{default:y(()=>[I(T(e.$locale.baseText("runData.fileSize"))+": ",1)]),_:1})]),g("div",{class:D(e.$style.binaryValue)},T(de.fileSize),3)])):C("",!0),g("div",{class:D(e.$style.binaryButtonContainer)},[e.isViewable(me,Re)?(c(),P(w,{key:0,size:"small",label:e.$locale.baseText("runData.showBinaryData"),"data-test-id":"ndv-view-binary-data",onClick:Mn=>e.displayBinaryData(me,Re)},null,8,["label","onClick"])):C("",!0),e.isDownloadable(me,Re)?(c(),P(w,{key:1,size:"small",type:"secondary",label:e.$locale.baseText("runData.downloadBinaryData"),"data-test-id":"ndv-download-binary-data",onClick:Mn=>e.downloadBinaryData(me,Re)},null,8,["label","onClick"])):C("",!0)],2)],8,Wd)],2))),128))],2)]))),128))],2)):C("",!0):(c(),b("div",{key:3,class:D(e.$style.center)},[ne(e.$slots,"node-not-run",{},void 0,!0)],2))],2),e.hasNodeRun&&!e.hasRunError&&e.binaryData.length===0&&e.dataCount>e.pageSize&&!e.isSchemaView&&!e.isArtificialRecoveredEventItem?Y((c(),b("div",{key:4,class:D(e.$style.pagination),"data-test-id":"ndv-data-pagination"},[m($e,{background:"","hide-on-single-page":!0,"current-page":e.currentPage,"pager-count":5,"page-size":e.pageSize,layout:"prev, pager, next",total:e.dataCount,"onUpdate:currentPage":e.onCurrentPageChange},null,8,["current-page","page-size","total","onUpdate:currentPage"]),g("div",{class:D(e.$style.pageSizeSelector)},[m(N,{size:"mini","model-value":e.pageSize,teleported:"","onUpdate:modelValue":e.onPageSizeChange},{prepend:y(()=>[I(T(e.$locale.baseText("ndv.output.pageSize")),1)]),default:y(()=>[(c(!0),b(Q,null,ae(e.pageSizes,U=>(c(),P(f,{key:U,label:U,value:U},null,8,["label","value"]))),128)),m(f,{label:e.$locale.baseText("ndv.output.all"),value:e.dataCount},null,8,["label","value"])]),_:1},8,["model-value","onUpdate:modelValue"])],2)],2)),[[J,!e.editMode.enabled]]):C("",!0),m(wt,{show:e.blockUI,class:D(e.$style.uiBlocker)},null,8,["show","class"])],34)}const Fd={$style:Rd},$n=L(od,[["render",Hd],["__cssModules",Fd],["__scopeId","data-v-956952a7"]]),zd=x({props:{taskData:{},hasStaleData:Boolean,hasPinData:Boolean},computed:{theme(){var e;return(e=this.runTaskData)!=null&&e.error?"danger":"success"},runTaskData(){return this.taskData},runMetadata(){if(!this.runTaskData)return null;const{date:e,time:t}=zi(this.runTaskData.startTime);return{executionTime:this.runTaskData.executionTime,startTime:`${e} at ${t}`}}}}),Yd=["innerHTML"],Kd=g("br",null,null,-1),jd=g("br",null,null,-1);function qd(e,t,o,n,s,i){const a=S("n8n-info-tip"),r=S("n8n-text");return e.hasStaleData?(c(),P(a,{key:0,theme:"warning",type:"tooltip","tooltip-placement":"right","data-test-id":"node-run-info-stale"},{default:y(()=>[g("span",{innerHTML:e.$locale.baseText(e.hasPinData?"ndv.output.staleDataWarning.pinData":"ndv.output.staleDataWarning.regular")},null,8,Yd)]),_:1})):e.runMetadata?(c(),P(a,{key:1,type:"tooltip",theme:e.theme,"data-test-id":`node-run-info-${e.theme}`,"tooltip-placement":"right"},{default:y(()=>[g("div",null,[m(r,{bold:!0,size:"small"},{default:y(()=>[I(T(e.runTaskData.error?e.$locale.baseText("runData.executionStatus.failed"):e.$locale.baseText("runData.executionStatus.success")),1)]),_:1}),Kd,m(r,{bold:!0,size:"small"},{default:y(()=>[I(T(e.$locale.baseText("runData.startTime")+":"),1)]),_:1}),I(" "+T(e.runMetadata.startTime),1),jd,m(r,{bold:!0,size:"small"},{default:y(()=>[I(T(e.$locale.baseText("runData.executionTime")+":"),1)]),_:1}),I(" "+T(e.runMetadata.executionTime)+" "+T(e.$locale.baseText("runData.ms")),1)])]),_:1},8,["theme","data-test-id"])):C("",!0)}const Gd=L(zd,[["render",qd]]),It={REGULAR:"regular",LOGS:"logs"},Jd=x({name:"OutputPanel",components:{RunData:$n,RunInfo:Gd,RunDataAi:Yi},props:{runIndex:{type:Number,required:!0},isReadOnly:{type:Boolean},linkedRuns:{type:Boolean},canLinkRuns:{type:Boolean},sessionId:{type:String},blockUI:{type:Boolean,default:!1},isProductionExecutionPreview:{type:Boolean,default:!1},isPaneActive:{type:Boolean,default:!1}},setup(e){const t=q(),{activeNode:o}=mt(t),{isSubNodeType:n}=Pn({node:o});return{pinnedData:Ne(o,{runIndex:e.runIndex,displayMode:t.getPanelDisplayMode("output")}),isSubNodeType:n}},data(){return{outputMode:"regular",outputTypes:[{label:this.$locale.baseText("ndv.output.outType.regular"),value:It.REGULAR},{label:this.$locale.baseText("ndv.output.outType.logs"),value:It.LOGS}]}},computed:{...G(j,q,le,z),node(){return this.ndvStore.activeNode},nodeType(){return this.node?this.nodeTypesStore.getNodeType(this.node.type,this.node.typeVersion):null},isTriggerNode(){return this.nodeTypesStore.isTriggerNode(this.node.type)},hasAiMetadata(){if(this.node){const e=this.workflowsStore.getWorkflowResultDataByNodeName(this.node.name);return!e||!Array.isArray(e)||e.length===0?!1:!!e[e.length-1].metadata}return!1},isPollingTypeNode(){var e;return!!((e=this.nodeType)!=null&&e.polling)},isScheduleTrigger(){return!!(this.nodeType&&this.nodeType.group.includes("schedule"))},isNodeRunning(){return this.node&&this.workflowsStore.isNodeExecuting(this.node.name)},workflowRunning(){return this.uiStore.isActionActive("workflowRunning")},workflowExecution(){return this.workflowsStore.getWorkflowExecution},workflowRunData(){var t;if(this.workflowExecution===null)return null;const e=this.workflowExecution.data;return(t=e==null?void 0:e.resultData)!=null&&t.runData?e.resultData.runData:null},hasNodeRun(){return this.workflowsStore.subWorkflowExecutionError?!0:!!(this.node&&this.workflowRunData&&this.workflowRunData.hasOwnProperty(this.node.name))},runTaskData(){if(!this.node||this.workflowExecution===null)return null;const e=this.workflowRunData;return e===null||!e.hasOwnProperty(this.node.name)||e[this.node.name].length<=this.runIndex?null:e[this.node.name][this.runIndex]},runsCount(){if(this.node===null)return 0;const e=this.workflowRunData;return e===null||!e.hasOwnProperty(this.node.name)?0:e[this.node.name].length?e[this.node.name].length:0},staleData(){if(!this.node)return!1;const e=this.workflowsStore.getParametersLastUpdate(this.node.name);if(!e||!this.runTaskData)return!1;const t=this.runTaskData.startTime;return e>t},outputPanelEditMode(){return this.ndvStore.outputPanelEditMode},canPinData(){return this.pinnedData.isValidNodeType.value&&!this.isReadOnly}},methods:{insertTestData(){const e=this.$refs.runData;e&&(e.enterEditMode({origin:"insertTestDataLink"}),this.$telemetry.track("User clicked ndv link",{workflow_id:this.workflowsStore.workflowId,session_id:this.sessionId,node_type:this.node.type,pane:"output",type:"insert-test-data"}))},onLinkRun(){this.$emit("linkRun")},onUnlinkRun(){this.$emit("unlinkRun")},openSettings(){this.$emit("openSettings"),this.$telemetry.track("User clicked ndv link",{node_type:this.node.type,workflow_id:this.workflowsStore.workflowId,session_id:this.sessionId,pane:"output",type:"settings"})},onRunIndexChange(e){this.$emit("runChange",e)},onUpdateOutputMode(e){e===It.LOGS?ut.emit("setPositionByName","minLeft"):ut.emit("setPositionByName","initial")},activatePane(){this.$emit("activatePane")}}}),Xd="_outputTypeSelect_1tinm_10",Qd="_titleSection_1tinm_15",Zd="_title_1tinm_15",eu="_noOutputData_1tinm_31",tu="_recoveredOutputData_1tinm_41",ou={outputTypeSelect:Xd,titleSection:Qd,title:Zd,noOutputData:eu,recoveredOutputData:tu},nu=g("br",null,null,-1);function su(e,t,o,n,s,i){const a=S("n8n-radio-buttons"),r=S("RunInfo"),l=S("n8n-text"),d=S("RunDataAi"),h=S("RunData");return c(),P(h,{ref:"runData",node:e.node,"run-index":e.runIndex,"linked-runs":e.linkedRuns,"can-link-runs":e.canLinkRuns,"too-much-data-title":e.$locale.baseText("ndv.output.tooMuchData.title"),"no-data-in-branch-message":e.$locale.baseText("ndv.output.noOutputDataInBranch"),"is-executing":e.isNodeRunning,"executing-message":e.$locale.baseText("ndv.output.executing"),"session-id":e.sessionId,"block-u-i":e.blockUI,"is-production-execution-preview":e.isProductionExecutionPreview,"is-pane-active":e.isPaneActive,"pane-type":"output","data-output-type":e.outputMode,onActivatePane:e.activatePane,onRunChange:e.onRunIndexChange,onLinkRun:e.onLinkRun,onUnlinkRun:e.onUnlinkRun,onTableMounted:t[3]||(t[3]=p=>e.$emit("tableMounted",p)),onItemHover:t[4]||(t[4]=p=>e.$emit("itemHover",p)),onSearch:t[5]||(t[5]=p=>e.$emit("search",p))},Yt({header:y(()=>[g("div",{class:D(e.$style.titleSection)},[e.hasAiMetadata?(c(),P(a,{key:0,modelValue:e.outputMode,"onUpdate:modelValue":[t[0]||(t[0]=p=>e.outputMode=p),e.onUpdateOutputMode],options:e.outputTypes},null,8,["modelValue","options","onUpdate:modelValue"])):(c(),b("span",{key:1,class:D(e.$style.title)},T(e.$locale.baseText(e.outputPanelEditMode.enabled?"ndv.output.edit":"ndv.output")),3)),e.hasNodeRun&&!e.pinnedData.hasData.value&&e.runsCount===1?Y((c(),P(r,{key:2,"task-data":e.runTaskData,"has-stale-data":e.staleData,"has-pin-data":e.pinnedData.hasData.value},null,8,["task-data","has-stale-data","has-pin-data"])),[[J,!e.outputPanelEditMode.enabled]]):C("",!0)],2)]),"node-not-run":y(()=>[e.workflowRunning&&!e.isTriggerNode?(c(),P(l,{key:0,"data-test-id":"ndv-output-waiting"},{default:y(()=>[I(T(e.$locale.baseText("ndv.output.waitingToRun")),1)]),_:1})):C("",!0),e.workflowRunning?C("",!0):(c(),P(l,{key:1,"data-test-id":"ndv-output-run-node-hint"},{default:y(()=>[e.isSubNodeType.value?(c(),b(Q,{key:0},[I(T(e.$locale.baseText("ndv.output.runNodeHintSubNode")),1)],64)):(c(),b(Q,{key:1},[I(T(e.$locale.baseText("ndv.output.runNodeHint"))+" ",1),e.canPinData?(c(),b("span",{key:0,onClick:t[1]||(t[1]=(...p)=>e.insertTestData&&e.insertTestData(...p))},[nu,I(" "+T(e.$locale.baseText("generic.or"))+" ",1),m(l,{tag:"a",size:"medium",color:"primary"},{default:y(()=>[I(T(e.$locale.baseText("ndv.output.insertTestData")),1)]),_:1})])):C("",!0)],64))]),_:1}))]),"no-output-data":y(()=>[m(l,{bold:!0,color:"text-dark",size:"large"},{default:y(()=>[I(T(e.$locale.baseText("ndv.output.noOutputData.title")),1)]),_:1}),m(l,null,{default:y(()=>[I(T(e.$locale.baseText("ndv.output.noOutputData.message"))+" ",1),g("a",{onClick:t[2]||(t[2]=(...p)=>e.openSettings&&e.openSettings(...p))},T(e.$locale.baseText("ndv.output.noOutputData.message.settings")),1),I(" "+T(e.$locale.baseText("ndv.output.noOutputData.message.settingsOption")),1)]),_:1})]),"recovered-artificial-output-data":y(()=>[g("div",{class:D(e.$style.recoveredOutputData)},[m(l,{tag:"div",bold:!0,color:"text-dark",size:"large"},{default:y(()=>[I(T(e.$locale.baseText("executionDetails.executionFailed.recoveredNodeTitle")),1)]),_:1}),m(l,null,{default:y(()=>[I(T(e.$locale.baseText("executionDetails.executionFailed.recoveredNodeMessage")),1)]),_:1})],2)]),_:2},[e.outputMode==="logs"?{name:"content",fn:y(()=>[m(d,{node:e.node,"run-index":e.runIndex},null,8,["node","run-index"])]),key:"0"}:void 0,!e.pinnedData.hasData.value&&e.runsCount>1?{name:"run-info",fn:y(()=>[m(r,{"task-data":e.runTaskData},null,8,["task-data"])]),key:"1"}:void 0]),1032,["node","run-index","linked-runs","can-link-runs","too-much-data-title","no-data-in-branch-message","is-executing","executing-message","session-id","block-u-i","is-production-execution-preview","is-pane-active","data-output-type","onActivatePane","onRunChange","onLinkRun","onUnlinkRun"])}const iu={$style:ou},au=L(Jd,[["render",su],["__cssModules",iu]]),ru={},lu={width:"112",height:"80",viewBox:"0 0 112 80",fill:"none",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},du=Li('<mask id="mask0_489_46042" style="mask-type:alpha;" maskUnits="userSpaceOnUse" x="0" y="0" width="112" height="80"><rect width="112" height="80" fill="url(#paint0_linear_489_46042)"></rect></mask><g mask="url(#mask0_489_46042)"><rect x="-0.5" width="112" height="80" fill="url(#pattern0)" fill-opacity="0.6"></rect></g><defs><pattern id="pattern0" patternContentUnits="objectBoundingBox" width="1" height="1"><use xlink:href="#image0_489_46042" transform="scale(0.00357143 0.005)"></use></pattern><linearGradient id="paint0_linear_489_46042" x1="90.5" y1="40.4494" x2="112.5" y2="40.4494" gradientUnits="userSpaceOnUse"><stop></stop><stop offset="1" stop-color="white" stop-opacity="0"></stop></linearGradient><image id="image0_489_46042" width="280" height="200" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARgAAADICAYAAAAzx/4XAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAABhdSURBVHgB7d0JcFTVngbw/72d4IYa0Ie4IK2llgpodNwtB9AaxVILF7ZxynkgWupojaRwASXQGEBqEAI8LXfBpZQS9IFabjMFkXFfijCKyqjQqIiKShCUpdP3vvPdpXP7pjtk6dPdSX+/qlPpJX07UfrL/yz3XEOIPJNiswaZkbKBtkiluC0qRB1gCJW86ntmjzYM81YvWIhyhgFTwlCxGJGyBcJKhTQxhUrSpJraKSpcVgjDhTQqEyo5U+6prbVExmV6TnWT6ixbnuxmSZ262xCLVTUIUTsxYEoMKpdM4aKCZV5ZUmIMFMoljsGUkMk1c9RArjE39HBchcuYadVVdUKUYwyYEjEhVhstj8gqdbMi8HA8kpTBqmqJC5EGHOQtEeVlMkXSw6WB4UK6cQymBKB6UYMso4OPWYZMrWG4kGasYEpAmWGHB3Xj0ydVzRUizRgwJcAwjaFpD9gyVYjygAHTxTndo9Bium2WLBWiPGDAdHFlkWT4/KK6uVzrQnnCgOniDNuIBu/blr1aiPKEAdPF2Xba1DQeYfVCecOAISJtGDBEpA0Dhoi0YcAQkTYMGCLShgFDRNowYIhIGwYMEWnDgCEibRgwRKQNA4aItGHAEJE2DBgi0oYBQ0TaMGCISBsGDBFpw4AhIm0YMESkDQOGiLRhwBCRNgwYItKGAUNE2jBgiEgbBgwRacOAISJtGDBEpA0Dhoi0YcAQkTYMGCLShgFDRNowYIhIGwYMEWnDgCEibRgwRKQNA4aItGHAEJE2DBgi0oYBQ0TaMGCISBsGDBFpw4AhIm0YMESkDQOGiLRhwBCRNgwYItKGAUNE2jBgiEgbBgwRacOAISJtGDBEpA0Dhoi0YcAQkTYMGCLShgFDRNowYIhIGwYMEWnDgCEibRgwRKQNA4aItGHAEJE2DBgi0oYBQ0TaMGCISBsGDBFpw4AhIm0YMESkDQOGiLRhwBCRNgwYItKGAUNE2hhCXc7ll19eUVZWNto0zYFGJDLIamys8J+LRMrilpWst217WSKRqFu6dGlciDRhwHQho0aNilqWVavC4/I2vGyhCpqpDBrSISLUJYwcOfJWFS6vq5vHS9tURiKRcf3795c1a9a8JUQ5xAqmk0N3qLy8/O/q5iDpIMMwlu7evXuMqmYahCgHOMjbyalwWSE5CBdA18o7HlFOsIvUiY0YMaJWfWnLeEtr9FbdpQrVXXpDiDqIXaROavjw4aPVlwWiiapmBi9ZsqROiDqAXaTOa4popMZjtIUXlQ4GTCfkVS9R0SvqvQ9RuzFgOqe/Sn7k632oi+IYTCfjTUtvkTxJJBI9OG1N7cUKppMpKyurlDzK9/tR18KA6Xzy+oG3LCsqRO3EgOl8KiSPTNOMClE7MWCISJsyIUcsVlvRGJEVhm3Nq5k8fqEUr3wPuHKAl9qNFYwnFqtqMND9MMwF1TW16yfXzLl1Qqw2KkXGtu245Fe9ELUTAybAaPprHbXFmFsekfXV02oX3BX7r6KZSUkmk3WSR42NjQwYajcGTIBl2aubPWjL6EikfJWqalZU3zN7tBSYtyalTvJAVUt1XANDHcExmDTofmRdezhIdZ8GqaCZYog9d3fSWDYzVhWXwnhScrRFQ0sMw3hSiDqAFUyAZUi8Fd9W8O5TIpFYqr7ERa/44sWLFwpRBzBggiJm28YbCtR9QrfFsqwq0WuqEHUQz0UKwFR1MiIdOc8nns/u01VXXTXXNM1bJcdUeM174YUXxglRBzFgQlQ1goDp+GpZQxYmGxPzZsTu0DYL4534iC0uc9lNq1ddo1OEKAfYRQoYpyoYI1djG6r7ZEbKF+CYogm6Smo8ZjA265YcwHFwPCHKkZKrYPCB31cSUTEjlaYtUSNi9rVtqTTcqiUqOWKLzCtLql5XrCov07zDhg2LqYBo9y53akq6asmSJXOFKIe6ZMDEYvdGG6W80jKNioiYJ6vfUs38qDBxA0T7yYJqNqpq+qSqvH9YceG1xsZGBE1bNorihddIm04ZMMEqJILAMFWI2E5wYCwiKoUTV0E2Zlp1VZ0UEIImmUwOUjeHRiKRSnU76j9nlpU1WI2NdapieUuF0UIupCOdijZgUIXslkhFhq5MVPRWIQ3tOb4KlnrVJboiVrjFdxlNmjo7ZphmqutkW9bUaVPGx4QoDwq6ktfvyhimEVV/W/uiKyNuFVKRVC110SbEoJ2zNGywMZ1sSL2dtLdahlFvGtKgwqEe4aCmqqNqqnp9Ww6Y7/EWos5Ca8Bk6cpExa1CoipEdJVQ6Ko0uCFibbAMM94tIvWSkPieQgAho6aqpbUKNd5C1Bl0OGCaDaiaUpHelSlv+mZbcimuWr1t2RvUoGbcNiSOKkQ91pCDSiIuex7LccZbVLjUhR5vT2bm9r8MUZHYY8CgCqmQnRVZujKpKiTVnclTV0b0QlBFsz2ZZbzFCH0N3w4dIo3Riu/Z0+NERScVMM5Je1nWhiRlb21dGcGHWQWHWLJahVVDa7syOjlVkZn5Nw6Nt4S/yQg0LGJECJ+n2nGqdVPtO9XeUW2lagnZw4+R4bYdeE8GDRW9VMCURcoX2PhA5HhA1WvNujLFNtsSZBjetg12+mfYErtq+uTx86QpQFIvkab/ZOgTnqlajWpniBssQY2qrVJtumornMOK9BQ3jE5XrY9q3VXbodo61d5U7TPVtgeO4QcNQ4aKWipgsNmS+qvdnnNaAl2ZtAHVhmIOkZbYKmCM9HCJJ3bvGjtz2sT/FffDv7e4/+3wTegl7lJtt3f/JHHD5VzVjH333Ve6deuGZfjYHU62b99eZts2gmS+ajHVvlZtjGqjVNsnw4+DkxkfVW2OapuF1Qx1IoExmBY3W1LPFV9XRhcracUjpulUMKq8WP3Lr1uGPzx/Gk6CPFu1gaqdrNrB4lYjP6n2iWr/p9pG1W5X7Z9UM4499li59NJL5ZRTTnFC5ssvv5Tly5fL+++/L7t370alMkO1TaqdYqr36969uxx44IG42Bm2xpStW7fK77//fqAKpPHiVkYIpR+897Wl5WBh6FDBNQWMaSJAFhZgQLXYGNbO5AZzn4gkLWv+199+O23xgr/tpR7/V9VuUK1fhtdcLW43BhXOaart07NnT5kzZ44MGTLECQxABTN06FAZM2aM1NfXI817oyFcEEbnn3++DBgwwAmZbdu2yTvvvCNvvPGGbN68WRVU9s3ijt9sFbdqOki1fcUNEoTfL9I0rhOsbogKJhUw06qrcEZuTs7K7exmzpy49a7qe8feWzPxKXErh39TrVq1ngiLCjWv1qNHD+ybggpDGhoasMtcf/X8ieJ9sC+88EI599xzU+ECuH3MMcfIyJEjETCpxw8++GCpqqqSa665RtCl8g0fPlzuuusuWbRoEaoZHOhKcSumY8Ttgh0pbjWD6ul/xJ39+i3wq7CKoYLinrzpUlPNM9xwwQAtQuM/VeuJILjgggucdvTRRzsVyTfffCPLli2T9957D1VHauD3zDPPdLpFYfvtt5+cdtppTpD8+eefzmP9+vWTgQMHpoULoAq69tpr5e2333a6S8r54obLaaHDXqTaNar9TbUnVPtVguGC8SSDBQ3lHwOmueA0MwZdMRN01D777COnnnqq1NTUON2ZIHRr7rzzTidkfAcddJBEIpHmB1cfdARV37595YsvvnAeQ0X0l7/8JeMPc8IJJ8ghhxwin3/+ObZU6KUe6uUfPxqNyo4dO2TdunXGzp07D1UP/4dq34hbiWJ2Cq8x8J4MGSoEbjjVJLhQLhgwGNB1xkVQuYTDBc444ww5++yz5YADDkg9tv/++zthkgnCChUQIITQ3cLxM8FxjjrqKCkvb1oRjdCZMWOGzJs3zxnnufrqq3ENaTyFMZ1LxR2ANv3fif0kKhRWMOnCC+XQMMDrjJ+EuzC+vfbay+n2YEB2zZo1zmP+1HQme++9t1OV+LdRwQTHasJQ7SBg1MyTc//mm2+W66+/3jk+xoHw3GuvvSabNm3CQfp4zRmLsdWkO+sWKhRWMJkFF9JhdsYZL9m4cWPWF5x++ulOpeGHSksBg0BCFwdQoWTrHvmOOOKIVAWDMBoxYkTq2KhcevXq5by3Zz9xK5iI83uoAEL3yKlibNYylF8MmHTh6sWfoXEGWT/99NPUwGwYxkMwJY1qA10m3M80BgPoEmGGqbKy0hkMRmsJxn4wOIxQwXuEAwlhhuDx74obMs7vkFRjMIwVKhR2kVzBpf7BbhICZr1qW5LJZA/MGK1du9ZZOBeGLs5ll13mTEPj9mGHHeaPizSDQBg8eLAzZoNqpn///tISjPvMmjVLNmzYIIMGDWr2PN4Hx/Eg1RAyTsBgkDdVubCzRHnGgMkcLH4Fg9vbxK1iBm7evNlZhZspYODII4902h7fUH3QES4ImdbA2M+wYcOcGSNUMpkEwsw/uT01yEtUKKXeRco0c4SG2ZgrVLtRtb+KNxGDBXXvvvsuVtZKvmEMBqGUrdsVkgpIO5k0/HMK2FWifCvlCiZT5YJp6RGqjVXtEO++3+Vwzg/CepS6ujpnlW2RMkKNqGBYwTRVLvuLe8byveIurouKGzKYkUktcME09EsvveSvrC16lhAVTqlWMMHqxe9O3CbuuT7OdMzxxx/vnAmNLsknn3wiK1eudNah7Nq1ywmZVatWZRxwLQScsrBz507/LjIFJz2ygqGCK+Uukj8Iiq/YcW6keOFyww03yN133+2sUcHgKaqV5557TqZOnepMU3/77bfO1gvFEjDougWmzxEuu4WoCJRiwGSaLbpANWdxyVlnnSUPPfRQ2gswuDp27Fhn1ezEiROdr63xww8/yPr16+Wcc85ptugOA8aYkcIpAlg3Ex68xZQ0zrg++eSTpU+fPi0O7qKCCXTZEC47hKgIlOoYTDBk8MnFMlhnqewll1yS8QVYeYvl+Y8++qjMnDnTmTZuCVb94gzp8847T6qrq9OeQxg888wzcvHFF8tNN90kL7/8ctrzv/zyi0yYMEGuvPJKufHGG+Wrr75q8b3QbcNrPOgrdY4BIurySrmCQbj660XKvcdSS/gzwXPXXXedtAbGabBXjG3bznYLQVjP8v333zu3f/vtN6fLFYSw2LJli1Mpff3119hms8X3QsD8+uuv/l30lRAwzsw0l2pTIZXav7/wJUX8CuYP8SZc8IHvTBBgCKA//vjDuStuBfO7EBWBUvwDF5xd8cdgUttNrlu3TjqTRCIh8Xg8dVfczaawCTnX1VHBlXIFHewqob/iBAy6NnYnOusYAYOBZA+ql58leOUBNQvGVXdUKFxo58In1Pmrj5W6GP/o8IEDs0aYRtYFa3NwlrcH/SR/TwlWMFRwpV7B+PChxEhrI3bzf/7556WjsGudHzLZtnjoKExPYzr7448/9h/CANL/S9OpR9gvk0FDBVPKARP84KHEeEu89SNPPPFEh09oxJYNfsDoqmAwsPvqq6/6U9T42dHVQ1Cmn9+In4NbNVABlGLAhK/57DcsRomrlvzoo4/kvvvuS21RWawwIP3444/7dzG4i8vMImgwI8YTqKngSi1ggpdd9ZvlNVwxEbvxO4tO8MFdunRpq1ft5hsGonH6gjfrhSTEJWhxWYNguLCLRAVV6l0kS9JD5lVxr87oLFybPXu2rFixQnINXSd/gygERXtCDCdfPvvss/5d9JH+W7Ufpel3SS20S80gsZtEeVaqXaRgwwCJ5X3FwMsDqq3CN+JcICzz/+CDDySXcF6Rv8UlBmrb2hVbvXq1cyVIbxNyTK9jqTACxgo1VjBUUKVawQS7R37I+A19DlwhcR0++NiWAdce+uyzzySXgicvtqWCQWU1efJk5+cS9+fHz/uCuDNIflimmmFGbFYuVCilXMH4H0L/Q9no3cbXD1Wbr9pm7LPyyiuvSG1tbcFX+SKIHnzwQXn99df9hzCw+4i4ewYHQ5KDvFQUSn0Mxg+a4IcTAYM+CwZfZqm2BetYsDYGlcN3333XqoMfeuihqbUwuMJAEK4qgEuXADb0Dp9giX1ounfv7rwWx8HF2QAXV3vssceCXaoHxb3o/W7v5/ZD0g9PB8dfqFBatYN0F5TppMdwQ/g0iLv0/sxEIlGOcEFFc+KJJ2a91KsPwYFrUGNnPGy5cPjhh6eewxoZvB7PY9OqK664wgkVHwIFe9DgciWjRo2Sk046yTkDe/z48c64kKdO3IDBVQ8QLAlJr8KcKmbg4Iv+WQXVoFTA2PZbK+verBOiPCjVHe0QHn6I+GMwqOYS3vP+SZAIl9dU66Vme67fsmVL+YIFC+Tnn3+W6dOnOxdZywZVysiRI51qI3ypEYy/IHjuuOOO8DWNUq+96KKLnMua4Htx//777xesz/HOk8Ks0Qxxt2VISnq4sItERaPUr4sUnk0KngDp38bWB4vFvUb1v2/durUcm36j4sBMznHHHZf14AiOcHgEZbvWNaDK8a9XjbGXxYsXC05j8Dyh2iZp6hZlC5emlbxEBVDKAROsYvzxiuAVHYMnIP+k2jOq7VIVxLXbt2/f++mnn3bOMbrttttkwIABohO23sSWDN5sE6qVl6SpagmHS7ARFVSpn02daU1MIktDyDyl2gMqZLbhPKCnnnpKbr/9dmeLh/ZAcNxyyy3Su3dv6devnzz88MPBKiUF2zFg1zoPRpl/C/1smWaQRNhFogLjpWObPoTBv/jB7pIEvqK7hDUn+LTfotoBb775pnOdJAziBi5Av0c//vijzJ8/Xx544AHn/k8//SRTpkxxFt5hn97gda2xQXjghMmNkh4o4XDh+AsVDW7Zmnm62p+V8S8BEqwWMLD6d9UeVu1nDLouX77cuYxJa2FbTgQTAsZ7b6e7g5BZtGiRfPjhh2lnYKN6CWyCtUOyj70EqxeigmPAuIJdinDQBMPGb9jg5RPVPseLsGQfVUZrYYOoWbNmOVPP4p5cWe8dy8a1r1ER4Zh+qIQueWJK5vEWW9g1oiLDLlKTTFPXRuh5/3vQsO2ds7k2LkPiX4wNMLUcvg4SwgLbW2ItDS7g5p16gLDCiU4LVTtBtR5qILcPVuuiizRkyBBnvQwqG7zWg+s3ZQsXdo2oqDBg0vkBgg+tXymINL9YW3DTcKfL88gjj8iLL77oBAMWygXHUABjK9iKEwHj7aGLY8dVW6baN+IO3PZW7SpVDVXgTO4lS5Y44zp4XWBXvL7e+zJYqOgxYJoLhox4t4NB4y/CA2clNFb34vrVbYBuF1IG+898JE1ncmO7CKzK+xd1zB5r167N1IXtJu51nFi9UNFjwGQWDhlfsILBtDVOisSJRPuGno9I8038cUzMPmHnf8wEYd+ZleKGjR8MOJtyobhbX1aqdqB3LASQf0lY7PD9hzBYqBNgwGQXDBm/e+QP/vrXUkIFgg98T0m/UmQ3aQqi4DQ4ggELXbBvrn/1xeDMD74f4YNFfW94x8WxEt7rMO6zSTKfDsCQoaLDgGlZeLVveJUvQgZBgS5LRJoCxsxwnEzbRPiDyb5gFwxVzEbJvAgwKaxgqBNgwLROOBwQMqb31YcP/Z4CxsrS/IDwqx5T0isgW9L3rOGCOuoUGDB7FuyCBM9bagw8jsf8cMk2/tJSwPiCYzzB2apM+9bwrGkqegyY1guGCzQGHiuTpqom05VagwETDppgQISnws0Mr/cXAPK8Iyp6DJjWC6/2Dd72181ASwETrmQyVR/h7SLCxwhu88kxGCpqDJjWCa/ytaR5WIR3xAu/Pjzj01LA7Cmk2DWiToEB03Z+mJiB28GAEckcMMHbVuhxO/S6TCHlf1+msGLQUFFiwLSeX8X4ty1pHiit2TouU7cmU8BI6Lad5StR0WLAtE0wCMKDs209RkvPtTY8GDJU1Bgw7WNnuW+04TVEXR4DJrcYIkQB3HCKiLRhwBCRNgwYItKGAUNE2jBgiEgbBgwRacOAISJtGDBdnGFI2gWbjIjZV4jyhAHTxdmGHU9/QKJClCcMmC6uLBmpDz1UOS5W2/qLaBN1AAOmi4vFquLiXuDNV7GfaY0WojxgwJQA27KeDN43DXOoEOUBA6YElNnmwtBDg6rvmT1OiDRjwJQAdJNssdOqGDHMKRNitVEh0ogBUyLKkkZMfQlOWVeUR2QFQ4Z0YsCUCGew15CpoYejCJlJNbWDhEiDtmz1SF2ACpOY+p8+pdkThixMNMrUme6sE1FOMGBK0KSaOXMNMW7N8vRSNe20LGkl62fE7qgXog5gwJSorJUMUQ4xYEoYxl7UP4AF6mZUiDRgwJBU31M7Wv1LQDUTFaIcYsBQSmx6bWVjo3W5mOZAww2bqBB1wD8AobUpv0xPqN8AAAAASUVORK5CYII="></image></defs>',3),uu=[du];function cu(e,t){return c(),b("svg",lu,uu)}const hu=L(ru,[["render",cu]]),pu=x({name:"InputPanel",components:{RunData:$n,NodeExecuteButton:qt,WireMeUp:hu},mixins:[Oe],props:{currentNodeName:{type:String},runIndex:{type:Number,required:!0},linkedRuns:{type:Boolean},workflow:{},canLinkRuns:{type:Boolean},sessionId:{type:String},readOnly:{type:Boolean},isProductionExecutionPreview:{type:Boolean,default:!1},isPaneActive:{type:Boolean,default:!1}},data(){return{showDraggableHintWithDelay:!1,draggableHintShown:!1,inputMode:"debugging",mappedNode:null,inputModes:[{value:"mapping",label:this.$locale.baseText("ndv.input.mapping")},{value:"debugging",label:this.$locale.baseText("ndv.input.debugging")}]}},computed:{...G(j,q,z),focusedMappableInput(){return this.ndvStore.focusedMappableInput},isUserOnboarded(){return this.ndvStore.isMappingOnboarded},isMappingMode(){return this.isActiveNodeConfig&&this.inputMode==="mapping"},showDraggableHint(){const e=[Wt,Je,Qn,Zn];return!this.currentNode||e.includes(this.currentNode.type)?!1:!!this.focusedMappableInput&&!this.isUserOnboarded},isActiveNodeConfig(){var o,n;let e=((o=this.activeNodeType)==null?void 0:o.inputs)??[],t=((n=this.activeNodeType)==null?void 0:n.outputs)??[];if(this.activeNode!==null&&this.currentWorkflow!==null){const s=this.currentWorkflow.getNode(this.activeNode.name);e=pe(this.currentWorkflow,s,this.activeNodeType),t=ve(this.currentWorkflow,s,this.activeNodeType)}else Array.isArray(e)||(e=[]),Array.isArray(t)||(t=[]);return!!(e.length===0||e.every(s=>this.filterOutConnectionType(s,_.Main))&&t.find(s=>this.filterOutConnectionType(s,_.Main)))},isMappingEnabled(){return this.readOnly?!1:this.isActiveNodeConfig?this.isMappingMode&&this.mappedNode!==null:!0},isExecutingPrevious(){if(!this.workflowRunning)return!1;const e=this.workflowsStore.executedNode,t=this.workflowsStore.executingNode;return this.activeNode&&e===this.activeNode.name&&!this.workflowsStore.isNodeExecuting(this.activeNode.name)?!0:t.length||e?!!this.parentNodes.find(o=>this.workflowsStore.isNodeExecuting(o.name)||o.name===e):!1},workflowRunning(){return this.uiStore.isActionActive("workflowRunning")},currentWorkflow(){return this.workflow},activeNode(){return this.ndvStore.activeNode},rootNode(){return this.currentWorkflow.getChildNodes(this.activeNode.name,"ALL_NON_MAIN")[0]},rootNodesParents(){return[...this.currentWorkflow.getParentNodes(this.rootNode,"main")].reverse()},currentNode(){return this.isActiveNodeConfig?this.mappedNode?this.workflowsStore.getNodeByName(this.mappedNode):this.activeNode:this.workflowsStore.getNodeByName(this.currentNodeName)},connectedCurrentNodeOutputs(){const e=this.parentNodes.find(({name:t})=>t===this.currentNodeName);if(e)return e.indicies},parentNodes(){if(!this.activeNode)return[];const e=this.workflow.getParentNodesByDepth(this.activeNode.name);return e.filter(({name:t},o)=>this.activeNode&&t!==this.activeNode.name&&e.findIndex(n=>n.name===t)===o)},currentNodeDepth(){const e=this.parentNodes.find(t=>this.currentNode&&t.name===this.currentNode.name);return e?e.depth:-1},activeNodeType(){return this.activeNode?this.nodeTypesStore.getNodeType(this.activeNode.type,this.activeNode.typeVersion):null},isMultiInputNode(){return this.activeNodeType!==null&&this.activeNodeType.inputs.length>1}},watch:{inputMode:{handler(e){this.onRunIndexChange(-1),e==="mapping"&&(this.onUnlinkRun(),this.mappedNode=this.rootNodesParents[0])},immediate:!0},showDraggableHint(e,t){e&&!t?setTimeout(()=>{this.draggableHintShown||(this.showDraggableHintWithDelay=this.showDraggableHint,this.showDraggableHintWithDelay&&(this.draggableHintShown=!0,this.$telemetry.track("User viewed data mapping tooltip",{type:"unexecuted input pane"})))},1e3):e||(this.showDraggableHintWithDelay=!1)}},methods:{filterOutConnectionType(e,t){return e?typeof e=="string"?e!==t:e.type!==t:!1},onInputModeChange(e){this.inputMode=e},onMappedNodeSelected(e){this.mappedNode=e,this.onRunIndexChange(0),this.onUnlinkRun()},getMultipleNodesText(e){var s;if(!e||!this.isMultiInputNode||!this.activeNode||((s=this.activeNodeType)==null?void 0:s.inputNames)===void 0)return"";const n=(this.currentWorkflow.connectionsByDestinationNode[this.activeNode.name].main||[]).reduce((i,a,r)=>a[0]&&a[0].node===e?[...i,r]:i,[]).map(i=>{var a,r;return(r=(a=this.activeNodeType)==null?void 0:a.inputNames)==null?void 0:r[i]});return n.length===0?"":`(${n.join(" & ")})`},onNodeExecute(){this.$emit("execute"),this.activeNode&&this.$telemetry.track("User clicked ndv button",{node_type:this.activeNode.type,workflow_id:this.workflowsStore.workflowId,session_id:this.sessionId,pane:"input",type:"executePrevious"})},onRunIndexChange(e){this.$emit("runChange",e)},onLinkRun(){this.$emit("linkRun")},onUnlinkRun(){this.$emit("unlinkRun")},onInputNodeChange(e){const t=this.parentNodes.findIndex(o=>o.name===e)+1;this.$emit("changeInputNode",e,t)},onConnectionHelpClick(){this.activeNode&&this.$telemetry.track("User clicked ndv link",{node_type:this.activeNode.type,workflow_id:this.workflowsStore.workflowId,session_id:this.sessionId,pane:"input",type:"not-connected-help"})},truncate(e){const t=e.substring(0,30);return t.length<e.length?`${t}...`:t},activatePane(){this.$emit("activatePane")}}}),fu="_mappedNode_13qhk_5",gu="_titleSection_13qhk_10",mu="_inputModeTab_13qhk_19",yu="_noOutputData_13qhk_23",wu="_recoveredOutputData_13qhk_33",vu="_notConnected_13qhk_42",Nu="_title_13qhk_10",ku={mappedNode:fu,titleSection:gu,inputModeTab:mu,noOutputData:yu,recoveredOutputData:wu,notConnected:vu,title:Nu},bu={key:0},Tu={key:1},Su=["innerHTML"];function Du(e,t,o,n,s,i){const a=S("n8n-option"),r=S("n8n-select"),l=S("n8n-radio-buttons"),d=S("n8n-text"),h=S("NodeExecuteButton"),p=S("n8n-tooltip"),w=S("WireMeUp"),f=S("RunData");return c(),P(f,{node:e.currentNode,"run-index":e.runIndex,"linked-runs":e.linkedRuns,"can-link-runs":!e.mappedNode&&e.canLinkRuns,"too-much-data-title":e.$locale.baseText("ndv.input.tooMuchData.title"),"no-data-in-branch-message":e.$locale.baseText("ndv.input.noOutputDataInBranch"),"is-executing":e.isExecutingPrevious,"executing-message":e.$locale.baseText("ndv.input.executingPrevious"),"session-id":e.sessionId,"override-outputs":e.connectedCurrentNodeOutputs,"mapping-enabled":e.isMappingEnabled,"distance-from-active":e.currentNodeDepth,"is-production-execution-preview":e.isProductionExecutionPreview,"is-pane-active":e.isPaneActive,"pane-type":"input","data-test-id":"ndv-input-panel",onActivatePane:e.activatePane,onItemHover:t[2]||(t[2]=N=>e.$emit("itemHover",N)),onLinkRun:e.onLinkRun,onUnlinkRun:e.onUnlinkRun,onRunChange:e.onRunIndexChange,onTableMounted:t[3]||(t[3]=N=>e.$emit("tableMounted",N)),onSearch:t[4]||(t[4]=N=>e.$emit("search",N))},Yt({header:y(()=>[g("div",{class:D(e.$style.titleSection)},[e.parentNodes.length?(c(),P(r,{key:0,teleported:"",size:"small","model-value":e.currentNodeName,"no-data-text":e.$locale.baseText("ndv.input.noNodesFound"),placeholder:e.$locale.baseText("ndv.input.parentNodes"),filterable:"","data-test-id":"ndv-input-select","onUpdate:modelValue":e.onInputNodeChange},{prepend:y(()=>[g("span",{class:D(e.$style.title)},T(e.$locale.baseText("ndv.input")),3)]),default:y(()=>[(c(!0),b(Q,null,ae(e.parentNodes,N=>(c(),P(a,{key:N.name,value:N.name,class:"node-option",label:`${e.truncate(N.name)} ${e.getMultipleNodesText(N.name)}`,"data-test-id":"ndv-input-option"},{default:y(()=>[g("span",null,T(e.truncate(N.name))+" ",1),e.getMultipleNodesText(N.name)?(c(),b("span",bu,T(e.getMultipleNodesText(N.name)),1)):(c(),b("span",Tu,T(e.$locale.baseText("ndv.input.nodeDistance",{adjustToNumber:N.depth})),1))]),_:2},1032,["value","label"]))),128))]),_:1},8,["model-value","no-data-text","placeholder","onUpdate:modelValue"])):(c(),b("span",{key:1,class:D(e.$style.title)},T(e.$locale.baseText("ndv.input")),3)),e.isActiveNodeConfig&&!e.readOnly?(c(),P(l,{key:2,options:e.inputModes,"model-value":e.inputMode,"onUpdate:modelValue":e.onInputModeChange},null,8,["options","model-value","onUpdate:modelValue"])):C("",!0)],2)]),"node-not-run":y(()=>[e.isActiveNodeConfig&&e.rootNode||e.parentNodes.length?(c(),b("div",{key:0,class:D(e.$style.noOutputData)},[m(d,{tag:"div",bold:!0,color:"text-dark",size:"large"},{default:y(()=>[I(T(e.$locale.baseText("ndv.input.noOutputData.title")),1)]),_:1}),e.readOnly?C("",!0):(c(),P(p,{key:0,visible:e.showDraggableHint&&e.showDraggableHintWithDelay},{content:y(()=>[g("div",{innerHTML:e.$locale.baseText("dataMapping.dragFromPreviousHint",{interpolate:{name:e.focusedMappableInput}})},null,8,Su)]),default:y(()=>[m(h,{type:"secondary",transparent:!0,"node-name":e.isActiveNodeConfig?e.rootNode:e.currentNodeName,label:e.$locale.baseText("ndv.input.noOutputData.executePrevious"),"telemetry-source":"inputs","data-test-id":"execute-previous-node",onExecute:e.onNodeExecute},null,8,["node-name","label","onExecute"])]),_:1},8,["visible"])),e.readOnly?C("",!0):(c(),P(d,{key:1,tag:"div",size:"small"},{default:y(()=>[I(T(e.$locale.baseText("ndv.input.noOutputData.hint")),1)]),_:1}))],2)):(c(),b("div",{key:1,class:D(e.$style.notConnected)},[g("div",null,[m(w)]),m(d,{tag:"div",bold:!0,color:"text-dark",size:"large"},{default:y(()=>[I(T(e.$locale.baseText("ndv.input.notConnected.title")),1)]),_:1}),m(d,{tag:"div"},{default:y(()=>[I(T(e.$locale.baseText("ndv.input.notConnected.message"))+" ",1),g("a",{href:"https://docs.n8n.io/workflows/connections/",target:"_blank",onClick:t[1]||(t[1]=(...N)=>e.onConnectionHelpClick&&e.onConnectionHelpClick(...N))},T(e.$locale.baseText("ndv.input.notConnected.learnMore")),1)]),_:1})],2))]),"no-output-data":y(()=>[m(d,{tag:"div",bold:!0,color:"text-dark",size:"large"},{default:y(()=>[I(T(e.$locale.baseText("ndv.input.noOutputData")),1)]),_:1})]),"recovered-artificial-output-data":y(()=>[g("div",{class:D(e.$style.recoveredOutputData)},[m(d,{tag:"div",bold:!0,color:"text-dark",size:"large"},{default:y(()=>[I(T(e.$locale.baseText("executionDetails.executionFailed.recoveredNodeTitle")),1)]),_:1}),m(d,null,{default:y(()=>[I(T(e.$locale.baseText("executionDetails.executionFailed.recoveredNodeMessage")),1)]),_:1})],2)]),_:2},[e.isMappingMode?{name:"before-data",fn:y(()=>[(c(),P(En("style"),null,{default:y(()=>[I("button.linkRun { display: none }")]),_:1})),g("div",{class:D(e.$style.mappedNode)},[m(r,{"model-value":e.mappedNode,size:"small",teleported:"","onUpdate:modelValue":e.onMappedNodeSelected,onClick:t[0]||(t[0]=te(()=>{},["stop"]))},{prepend:y(()=>[I(T(e.$locale.baseText("ndv.input.previousNode")),1)]),default:y(()=>[(c(!0),b(Q,null,ae(e.rootNodesParents,N=>(c(),P(a,{key:N,label:N,value:N},null,8,["label","value"]))),128))]),_:1},8,["model-value","onUpdate:modelValue"])],2)]),key:"0"}:void 0]),1032,["node","run-index","linked-runs","can-link-runs","too-much-data-title","no-data-in-branch-message","is-executing","executing-message","session-id","override-outputs","mapping-enabled","distance-from-active","is-production-execution-preview","is-pane-active","onActivatePane","onLinkRun","onUnlinkRun","onRunChange"])}const Eu={$style:ku},Cu=L(pu,[["render",Du],["__cssModules",Eu],["__scopeId","data-v-a638dbad"]]),Iu=x({name:"TriggerPanel",components:{NodeExecuteButton:qt,CopyInput:ei,NodeIcon:yt},mixins:[Oe],props:{nodeName:{type:String},sessionId:{type:String}},data:()=>({executionsHelpEventBus:pn()}),computed:{...G(j,q,le,z),node(){return this.workflowsStore.getNodeByName(this.nodeName)},nodeType(){return this.node?this.nodeTypesStore.getNodeType(this.node.type,this.node.typeVersion):null},hideContent(){var e,t,o,n;if(!((e=this.nodeType)!=null&&e.triggerPanel))return!1;if((t=this.nodeType)!=null&&t.triggerPanel&&((o=this.nodeType)!=null&&o.triggerPanel.hasOwnProperty("hideContent"))){const s=(n=this.nodeType)==null?void 0:n.triggerPanel.hideContent;if(typeof s=="boolean")return s;if(this.node){const i=this.getCurrentWorkflow().expression.getSimpleParameterValue(this.node,s,"internal",{});if(typeof i=="boolean")return i}}return!1},hasIssues(){var e;return!!((e=this.node)!=null&&e.issues&&(this.node.issues.parameters||this.node.issues.credentials))},serviceName(){return this.nodeType?dt(this.nodeType):""},displayChatButton(){return!!(this.node&&this.node.type===Ge&&this.node.parameters.mode!=="webhook")},isWebhookNode(){return!!(this.node&&this.node.type===Ce)},webhookHttpMethod(){var e,t;if(!(!this.node||!((t=(e=this.nodeType)==null?void 0:e.webhooks)!=null&&t.length)))return this.getWebhookExpressionValue(this.nodeType.webhooks[0],"httpMethod")},webhookTestUrl(){var e,t;if(!(!this.node||!((t=(e=this.nodeType)==null?void 0:e.webhooks)!=null&&t.length)))return this.getWebhookUrl(this.nodeType.webhooks[0],this.node,"test")},isWebhookBasedNode(){var e,t;return!!((t=(e=this.nodeType)==null?void 0:e.webhooks)!=null&&t.length)},isPollingNode(){var e;return!!((e=this.nodeType)!=null&&e.polling)},isListeningForEvents(){const e=this.workflowsStore.executionWaitingForWebhook,t=this.workflowsStore.executedNode;return!!this.node&&!this.node.disabled&&this.isWebhookBasedNode&&e&&(!t||t===this.nodeName)},workflowRunning(){return this.uiStore.isActionActive("workflowRunning")},isActivelyPolling(){const e=this.workflowsStore.executedNode;return this.workflowRunning&&this.isPollingNode&&this.nodeName===e},isWorkflowActive(){return this.workflowsStore.isWorkflowActive},listeningTitle(){var e;return((e=this.nodeType)==null?void 0:e.name)===Pe?this.$locale.baseText("ndv.trigger.webhookNode.formTrigger.listening"):this.$locale.baseText("ndv.trigger.webhookNode.listening")},listeningHint(){var e;switch((e=this.nodeType)==null?void 0:e.name){case Ge:return this.$locale.baseText("ndv.trigger.webhookBasedNode.chatTrigger.serviceHint");case Pe:return this.$locale.baseText("ndv.trigger.webhookBasedNode.formTrigger.serviceHint");default:return this.$locale.baseText("ndv.trigger.webhookBasedNode.serviceHint",{interpolate:{service:this.serviceName}})}},header(){var t;const e=this.nodeType?dt(this.nodeType):"";return this.isActivelyPolling?this.$locale.baseText("ndv.trigger.pollingNode.fetchingEvent"):(t=this.nodeType)!=null&&t.triggerPanel&&typeof this.nodeType.triggerPanel.header=="string"?this.nodeType.triggerPanel.header:this.isWebhookBasedNode?this.$locale.baseText("ndv.trigger.webhookBasedNode.action",{interpolate:{name:e}}):""},subheader(){const e=this.nodeType?dt(this.nodeType):"";return this.isActivelyPolling?this.$locale.baseText("ndv.trigger.pollingNode.fetchingHint",{interpolate:{name:e}}):""},executionsHelp(){var e,t;if(((t=(e=this.nodeType)==null?void 0:e.triggerPanel)==null?void 0:t.executionsHelp)!==void 0){if(typeof this.nodeType.triggerPanel.executionsHelp=="string")return this.nodeType.triggerPanel.executionsHelp;if(!this.isWorkflowActive&&this.nodeType.triggerPanel.executionsHelp.inactive)return this.nodeType.triggerPanel.executionsHelp.inactive;if(this.isWorkflowActive&&this.nodeType.triggerPanel.executionsHelp.active)return this.nodeType.triggerPanel.executionsHelp.active}return this.isWebhookBasedNode?this.isWorkflowActive?this.$locale.baseText("ndv.trigger.webhookBasedNode.executionsHelp.active",{interpolate:{service:this.serviceName}}):this.$locale.baseText("ndv.trigger.webhookBasedNode.executionsHelp.inactive",{interpolate:{service:this.serviceName}}):this.isPollingNode?this.isWorkflowActive?this.$locale.baseText("ndv.trigger.pollingNode.executionsHelp.active",{interpolate:{service:this.serviceName}}):this.$locale.baseText("ndv.trigger.pollingNode.executionsHelp.inactive",{interpolate:{service:this.serviceName}}):""},activationHint(){var e,t;if(this.isActivelyPolling)return"";if((t=(e=this.nodeType)==null?void 0:e.triggerPanel)!=null&&t.activationHint){if(typeof this.nodeType.triggerPanel.activationHint=="string")return this.nodeType.triggerPanel.activationHint;if(!this.isWorkflowActive&&typeof this.nodeType.triggerPanel.activationHint.inactive=="string")return this.nodeType.triggerPanel.activationHint.inactive;if(this.isWorkflowActive&&typeof this.nodeType.triggerPanel.activationHint.active=="string")return this.nodeType.triggerPanel.activationHint.active}return this.isWebhookBasedNode?this.isWorkflowActive?this.$locale.baseText("ndv.trigger.webhookBasedNode.activationHint.active",{interpolate:{service:this.serviceName}}):this.$locale.baseText("ndv.trigger.webhookBasedNode.activationHint.inactive",{interpolate:{service:this.serviceName}}):this.isPollingNode?this.isWorkflowActive?this.$locale.baseText("ndv.trigger.pollingNode.activationHint.active",{interpolate:{service:this.serviceName}}):this.$locale.baseText("ndv.trigger.pollingNode.activationHint.inactive",{interpolate:{service:this.serviceName}}):""}},methods:{expandExecutionHelp(){this.$refs.help&&this.executionsHelpEventBus.emit("expand")},openWebhookUrl(){this.$telemetry.track("User clicked ndv link",{workflow_id:this.workflowsStore.workflowId,session_id:this.sessionId,pane:"input",type:"open-chat"}),window.open(this.webhookTestUrl,"_blank","noreferrer")},onLinkClick(e){var o;if(!e.target)return;const t=e.target;t.localName==="a"&&(o=t.dataset)!=null&&o.key&&(e.stopPropagation(),e.preventDefault(),t.dataset.key==="activate"?this.$emit("activate"):t.dataset.key==="executions"?(this.$telemetry.track("User clicked ndv link",{workflow_id:this.workflowsStore.workflowId,session_id:this.sessionId,pane:"input",type:"open-executions-log"}),this.ndvStore.activeNodeName=null,this.$router.push({name:F.EXECUTIONS})):t.dataset.key==="settings"&&this.uiStore.openModal(es))},onTestLinkCopied(){this.$telemetry.track("User copied webhook URL",{pane:"inputs",type:"test url"})},onNodeExecute(){this.$emit("execute")}}}),Pu="_container_2vg29_5",Ou="_header_2vg29_22",$u="_action_2vg29_29",Ru="_shake_2vg29_33",_u="_accordion_2vg29_54",Au={container:Pu,header:Ou,action:$u,shake:Ru,accordion:_u},Mu={key:"empty"},Wu={key:"listening"},Vu={key:0},Bu={key:1},Uu={key:0},Lu={key:"default"},xu={key:0,class:"mb-xl"},Hu=["textContent"],Fu=["innerHTML"];function zu(e,t,o,n,s,i){const a=S("NodeIcon"),r=S("n8n-pulse"),l=S("n8n-text"),d=S("CopyInput"),h=S("NodeExecuteButton"),p=S("n8n-button"),w=S("n8n-spinner"),f=S("n8n-heading"),N=S("n8n-link"),E=S("n8n-info-accordion");return c(),b("div",{class:D(e.$style.container)},[m(xi,{name:"fade",mode:"out-in"},{default:y(()=>[e.hasIssues||e.hideContent?(c(),b("div",Mu)):e.isListeningForEvents?(c(),b("div",Wu,[m(r,null,{default:y(()=>[m(a,{"node-type":e.nodeType,size:40},null,8,["node-type"])]),_:1}),e.isWebhookNode?(c(),b("div",Vu,[m(l,{tag:"div",size:"large",color:"text-dark",class:"mb-2xs",bold:""},{default:y(()=>[I(T(e.$locale.baseText("ndv.trigger.webhookNode.listening")),1)]),_:1}),g("div",{class:D([e.$style.shake,"mb-xs"])},[m(l,null,{default:y(()=>[I(T(e.$locale.baseText("ndv.trigger.webhookNode.requestHint",{interpolate:{type:e.webhookHttpMethod}})),1)]),_:1})],2),m(d,{value:e.webhookTestUrl,"toast-title":e.$locale.baseText("ndv.trigger.copiedTestUrl"),class:"mb-2xl",size:"medium",collapse:!0,"copy-button-text":e.$locale.baseText("generic.clickToCopy"),onCopy:e.onTestLinkCopied},null,8,["value","toast-title","copy-button-text","onCopy"]),m(h,{"data-test-id":"trigger-execute-button","node-name":e.nodeName,size:"medium","telemetry-source":"inputs",onExecute:e.onNodeExecute},null,8,["node-name","onExecute"])])):(c(),b("div",Bu,[m(l,{tag:"div",size:"large",color:"text-dark",class:"mb-2xs",bold:""},{default:y(()=>[I(T(e.listeningTitle),1)]),_:1}),g("div",{class:D([e.$style.shake,"mb-xs"])},[m(l,{tag:"div"},{default:y(()=>[I(T(e.listeningHint),1)]),_:1})],2),e.displayChatButton?(c(),b("div",Uu,[m(p,{onClick:t[0]||(t[0]=u=>e.openWebhookUrl()),class:"mb-xl"},{default:y(()=>[I(T(e.$locale.baseText("ndv.trigger.chatTrigger.openChat")),1)]),_:1})])):C("",!0),m(h,{"data-test-id":"trigger-execute-button","node-name":e.nodeName,size:"medium","telemetry-source":"inputs",onExecute:e.onNodeExecute},null,8,["node-name","onExecute"])]))])):(c(),b("div",Lu,[e.isActivelyPolling?(c(),b("div",xu,[m(w,{type:"ring"})])):C("",!0),g("div",{class:D(e.$style.action)},[g("div",{class:D(e.$style.header)},[e.header?(c(),P(f,{key:0,tag:"h1",bold:""},{default:y(()=>[I(T(e.header),1)]),_:1})):C("",!0),e.subheader?(c(),P(l,{key:1},{default:y(()=>[g("span",{textContent:T(e.subheader)},null,8,Hu)]),_:1})):C("",!0)],2),m(h,{"data-test-id":"trigger-execute-button","node-name":e.nodeName,size:"medium","telemetry-source":"inputs",onExecute:e.onNodeExecute},null,8,["node-name","onExecute"])],2),e.activationHint?(c(),P(l,{key:1,size:"small",onClick:e.onLinkClick},{default:y(()=>[g("span",{innerHTML:e.activationHint},null,8,Fu),I("  ")]),_:1},8,["onClick"])):C("",!0),e.activationHint&&e.executionsHelp?(c(),P(N,{key:2,size:"small",onClick:e.expandExecutionHelp},{default:y(()=>[I(T(e.$locale.baseText("ndv.trigger.moreInfo")),1)]),_:1},8,["onClick"])):C("",!0),e.executionsHelp?(c(),P(E,{key:3,ref:"help",class:D(e.$style.accordion),title:e.$locale.baseText("ndv.trigger.executionsHint.question"),description:e.executionsHelp,"event-bus":e.executionsHelpEventBus,"onClick:body":e.onLinkClick},null,8,["class","title","description","event-bus","onClick:body"])):C("",!0)]))]),_:1})],2)}const Yu={$style:Au},Ku=L(Iu,[["render",zu],["__cssModules",Yu],["__scopeId","data-v-5418710a"]]),ju=x({name:"NodeDetailsView",components:{NodeSettings:Xa,InputPanel:Cu,OutputPanel:au,NDVDraggablePanels:qr,TriggerPanel:Ku},mixins:[Oe,Ko],props:{readOnly:{type:Boolean},renaming:{type:Boolean},isProductionExecutionPreview:{type:Boolean,default:!1}},setup(e,t){var r,l;const o=q(),n=be(),s=xe(),{activeNode:i}=mt(o),a=Ne(i);return{externalHooks:n,nodeHelpers:s,pinnedData:a,...ke(),...Ft(),...(l=(r=Ko).setup)==null?void 0:l.call(r,e,t)}},data(){return{settingsEventBus:pn(),redrawRequired:!1,runInputIndex:-1,runOutputIndex:-1,isLinkingEnabled:!0,selectedInput:void 0,triggerWaitingWarningEnabled:!1,isDragging:!1,mainPanelPosition:0,pinDataDiscoveryTooltipVisible:!1,avgInputRowHeight:0,avgOutputRowHeight:0,isInputPaneActive:!1,isOutputPaneActive:!1,isPairedItemHoveringEnabled:!0}},mounted(){ye.on("data-pinning-discovery",this.setIsTooltipVisible)},beforeUnmount(){ye.off("data-pinning-discovery",this.setIsTooltipVisible)},computed:{...G(j,q,le,z,fn),sessionId(){return this.ndvStore.sessionId},workflowRunning(){return this.uiStore.isActionActive("workflowRunning")},showTriggerWaitingWarning(){return this.triggerWaitingWarningEnabled&&!!this.activeNodeType&&!this.activeNodeType.group.includes("trigger")&&this.workflowRunning&&this.workflowsStore.executionWaitingForWebhook},activeNode(){return this.ndvStore.activeNode},inputNodeName(){return this.selectedInput||this.parentNode},inputNode(){return this.inputNodeName?this.workflowsStore.getNodeByName(this.inputNodeName):null},activeNodeType(){return this.activeNode?this.nodeTypesStore.getNodeType(this.activeNode.type,this.activeNode.typeVersion):null},showTriggerPanel(){var n,s,i,a,r;const e=!!((n=this.activeNodeType)!=null&&n.triggerPanel);if(typeof((s=this.activeNodeType)==null?void 0:s.triggerPanel)=="boolean")return e;const t=!!((a=(i=this.activeNodeType)==null?void 0:i.webhooks)!=null&&a.length),o=(r=this.activeNodeType)==null?void 0:r.polling;return!this.readOnly&&this.isTriggerNode&&(t||o||e)},workflow(){return this.getCurrentWorkflow()},hasOutputConnection(){var t,o;if(!this.activeNode)return!1;const e=this.workflowsStore.outgoingConnectionsByNodeName(this.activeNode.name);return(((o=(t=Object.values(e))==null?void 0:t[0])==null?void 0:o[0])??[]).length>0},parentNodes(){return this.activeNode?this.workflow.getParentNodesByDepth(this.activeNode.name,1).map(({name:e})=>e)||[]:[]},parentNode(){var e;for(const t of this.parentNodes)if(this.workflowsStore.pinnedWorkflowData[t]||(e=this.workflowRunData)!=null&&e[t])return t;return this.parentNodes[0]},isExecutableTriggerNode(){return this.activeNodeType?ts.includes(this.activeNodeType.name):!1},isTriggerNode(){return!!this.activeNodeType&&(this.activeNodeType.group.includes("trigger")||this.activeNodeType.name===Wt)},isActiveStickyNode(){return!!this.ndvStore.activeNode&&this.ndvStore.activeNode.type===se},workflowExecution(){return this.workflowsStore.getWorkflowExecution},workflowRunData(){if(this.workflowExecution===null)return null;const e=this.workflowExecution.data;return e!=null&&e.resultData?e.resultData.runData:null},maxOutputRun(){if(this.activeNode===null)return 0;const e=this.workflowRunData;return e===null||!e.hasOwnProperty(this.activeNode.name)?0:e[this.activeNode.name].length?e[this.activeNode.name].length-1:0},outputRun(){return this.runOutputIndex===-1?this.maxOutputRun:Math.min(this.runOutputIndex,this.maxOutputRun)},maxInputRun(){if(this.inputNode===null||this.activeNode===null)return 0;const e=this.workflow.getNode(this.activeNode.name),t=ve(this.workflow,e,this.activeNodeType);let o=this.inputNode;const n=this.workflowRunData;return t.some(s=>s!==_.Main)&&(o=this.activeNode),!o||!n||!n.hasOwnProperty(o.name)?0:n[o.name].length?n[o.name].length-1:0},inputRun(){return this.isLinkingEnabled&&this.maxOutputRun===this.maxInputRun?this.outputRun:this.runInputIndex===-1?this.maxInputRun:Math.min(this.runInputIndex,this.maxInputRun)},canLinkRuns(){return this.maxOutputRun>0&&this.maxOutputRun===this.maxInputRun},linked(){return this.isLinkingEnabled&&this.canLinkRuns},inputPanelMargin(){return this.isTriggerNode?0:80},featureRequestUrl(){return this.activeNodeType?`${os}${this.activeNodeType.name}`:""},outputPanelEditMode(){return this.ndvStore.outputPanelEditMode},isWorkflowRunning(){return this.uiStore.isActionActive("workflowRunning")},isExecutionWaitingForWebhook(){return this.workflowsStore.executionWaitingForWebhook},blockUi(){return this.isWorkflowRunning||this.isExecutionWaitingForWebhook},foreignCredentials(){const e=(this.activeNode||{}).credentials,t=this.workflowsStore.usedCredentials,o=[];return e&&this.settingsStore.isEnterpriseFeatureEnabled(gn.Sharing)&&Object.values(e).forEach(n=>{n.id&&t[n.id]&&!t[n.id].currentUserHasAccess&&o.push(n.id)}),o},hasForeignCredential(){return this.foreignCredentials.length>0}},watch:{activeNode(e,t){e&&e.name!==(t==null?void 0:t.name)&&!this.isActiveStickyNode&&(this.runInputIndex=-1,this.runOutputIndex=-1,this.isLinkingEnabled=!0,this.selectedInput=void 0,this.triggerWaitingWarningEnabled=!1,this.avgOutputRowHeight=0,this.avgInputRowHeight=0,setTimeout(()=>this.ndvStore.setNDVSessionId(),0),this.externalHooks.run("dataDisplay.nodeTypeChanged",{nodeSubtitle:this.nodeHelpers.getNodeSubtitle(e,this.activeNodeType,this.getCurrentWorkflow())}),setTimeout(()=>{var o;if(this.activeNode){const n=this.workflowsStore.outgoingConnectionsByNodeName(this.activeNode.name);this.$telemetry.track("User opened node modal",{node_type:this.activeNodeType?this.activeNodeType.name:"",workflow_id:this.workflowsStore.workflowId,session_id:this.sessionId,is_editable:!this.hasForeignCredential,parameters_pane_position:this.mainPanelPosition,input_first_connector_runs:this.maxInputRun,output_first_connector_runs:this.maxOutputRun,selected_view_inputs:this.isTriggerNode?"trigger":this.ndvStore.inputPanelDisplayMode,selected_view_outputs:this.ndvStore.outputPanelDisplayMode,input_connectors:this.parentNodes.length,output_connectors:(o=n==null?void 0:n.main)==null?void 0:o.length,input_displayed_run_index:this.inputRun,output_displayed_run_index:this.outputRun,data_pinning_tooltip_presented:this.pinDataDiscoveryTooltipVisible,input_displayed_row_height_avg:this.avgInputRowHeight,output_displayed_row_height_avg:this.avgOutputRowHeight})}},2e3)),window.top&&!this.isActiveStickyNode&&window.top.postMessage(JSON.stringify({command:e?"openNDV":"closeNDV"}),"*")},maxOutputRun(){this.runOutputIndex=-1},maxInputRun(){this.runInputIndex=-1},inputNodeName(e){setTimeout(()=>{this.ndvStore.setInputNodeName(e)},0)},inputRun(){setTimeout(()=>{this.ndvStore.setInputRunIndex(this.inputRun)},0)}},methods:{setIsTooltipVisible({isTooltipVisible:e}){this.pinDataDiscoveryTooltipVisible=e},onKeyDown(e){if(e.key==="s"&&this.isCtrlKeyPressed(e)){if(e.stopPropagation(),e.preventDefault(),this.readOnly)return;this.$emit("saveKeyboardShortcut",e)}},onInputItemHover(e){if(e===null||!this.inputNodeName||!this.isPairedItemHoveringEnabled){this.ndvStore.setHoveringItem(null);return}const t={nodeName:this.inputNodeName,runIndex:this.inputRun,outputIndex:e.outputIndex,itemIndex:e.itemIndex};this.ndvStore.setHoveringItem(t)},onOutputItemHover(e){if(e===null||!this.activeNode||!this.isPairedItemHoveringEnabled){this.ndvStore.setHoveringItem(null);return}const t={nodeName:this.activeNode.name,runIndex:this.outputRun,outputIndex:e.outputIndex,itemIndex:e.itemIndex};this.ndvStore.setHoveringItem(t)},onInputTableMounted(e){this.avgInputRowHeight=e.avgRowHeight},onOutputTableMounted(e){this.avgOutputRowHeight=e.avgRowHeight},onWorkflowActivate(){this.ndvStore.activeNodeName=null,setTimeout(()=>{this.activateCurrentWorkflow("ndv")},1e3)},onFeatureRequestClick(){window.open(this.featureRequestUrl,"_blank"),this.activeNode&&this.$telemetry.track("User clicked ndv link",{node_type:this.activeNode.type,workflow_id:this.workflowsStore.workflowId,session_id:this.sessionId,pane:_.Main,type:"i-wish-this-node-would"})},onPanelsInit(e){this.mainPanelPosition=e.position},onDragStart(e){this.isDragging=!0,this.mainPanelPosition=e.position},onDragEnd(e){this.isDragging=!1,this.$telemetry.track("User moved parameters pane",{window_width:e.windowWidth,start_position:this.mainPanelPosition,end_position:e.position,node_type:this.activeNodeType?this.activeNodeType.name:"",session_id:this.sessionId,workflow_id:this.workflowsStore.workflowId}),this.mainPanelPosition=e.position},onLinkRunToInput(){this.runOutputIndex=this.runInputIndex,this.isLinkingEnabled=!0,this.trackLinking("input")},onLinkRunToOutput(){this.isLinkingEnabled=!0,this.trackLinking("output")},onUnlinkRun(e){this.runInputIndex=this.runOutputIndex,this.isLinkingEnabled=!1,this.trackLinking(e)},trackLinking(e){this.$telemetry.track("User changed ndv run linking",{node_type:this.activeNodeType?this.activeNodeType.name:"",session_id:this.sessionId,linked:this.linked,pane:e})},onNodeExecute(){setTimeout(()=>{!this.activeNode||!this.workflowRunning||(this.triggerWaitingWarningEnabled=!0)},1e3)},openSettings(){this.settingsEventBus.emit("openSettings")},valueChanged(e){this.$emit("valueChanged",e)},nodeTypeSelected(e){this.$emit("nodeTypeSelected",e)},async onSwitchSelectedNode(e){this.$emit("switchSelectedNode",e)},async close(){var e,t;if(!this.isDragging){if(this.activeNode&&(typeof((e=this.activeNodeType)==null?void 0:e.outputs)=="string"||typeof((t=this.activeNodeType)==null?void 0:t.inputs)=="string"||this.redrawRequired)){const o=this.activeNode.name;setTimeout(()=>{this.$emit("redrawNode",o)},1)}if(this.outputPanelEditMode.enabled&&this.activeNode){if(await this.confirm("",this.$locale.baseText("ndv.pinData.beforeClosing.title"),{confirmButtonText:this.$locale.baseText("ndv.pinData.beforeClosing.confirm"),cancelButtonText:this.$locale.baseText("ndv.pinData.beforeClosing.cancel")})===Ve){const{value:n}=this.outputPanelEditMode;try{this.pinnedData.setData(gt(n),"on-ndv-close-modal")}catch(s){console.error(s)}}this.ndvStore.setOutputPanelEditModeEnabled(!1)}await this.externalHooks.run("dataDisplay.nodeEditingFinished"),this.$telemetry.track("User closed node modal",{node_type:this.activeNodeType?this.activeNodeType.name:"",session_id:this.sessionId,workflow_id:this.workflowsStore.workflowId}),this.triggerWaitingWarningEnabled=!1,this.ndvStore.activeNodeName=null,this.ndvStore.resetNDVSessionId()}},onRunOutputIndexChange(e){this.runOutputIndex=e,this.trackRunChange(e,"output")},onRunInputIndexChange(e){this.runInputIndex=e,this.linked&&(this.runOutputIndex=e),this.trackRunChange(e,"input")},trackRunChange(e,t){this.$telemetry.track("User changed ndv run dropdown",{session_id:this.sessionId,run_index:e,node_type:this.activeNodeType?this.activeNodeType.name:"",pane:t})},onInputNodeChange(e,t){this.runInputIndex=-1,this.isLinkingEnabled=!0,this.selectedInput=e,this.$telemetry.track("User changed ndv input dropdown",{node_type:this.activeNode?this.activeNode.type:"",session_id:this.sessionId,workflow_id:this.workflowsStore.workflowId,selection_value:t,input_node_type:this.inputNode?this.inputNode.type:""})},onStopExecution(){this.$emit("stopExecution")},activateInputPane(){this.isInputPaneActive=!0,this.isOutputPaneActive=!1},activateOutputPane(){this.isInputPaneActive=!1,this.isOutputPaneActive=!0},onSearch(e){this.isPairedItemHoveringEnabled=!e}}}),qu="_modalBackground_17uio_5",Gu="_triggerWarning_17uio_10",Ju="_backToCanvas_17uio_14",Xu="_featureRequest_17uio_35",Qu={modalBackground:qu,triggerWarning:Gu,backToCanvas:Ju,featureRequest:Xu};function Zu(e,t,o,n,s,i){const a=S("n8n-icon"),r=S("n8n-text"),l=S("n8n-tooltip"),d=S("TriggerPanel"),h=S("InputPanel"),p=S("OutputPanel"),w=S("NodeSettings"),f=S("font-awesome-icon"),N=S("NDVDraggablePanels"),E=S("el-dialog");return c(),P(E,{"model-value":(!!e.activeNode||e.renaming)&&!e.isActiveStickyNode,"before-close":e.close,"show-close":!1,class:"data-display-wrapper ndv-wrapper","overlay-class":"data-display-overlay",width:"auto","append-to-body":"","data-test-id":"ndv","data-has-output-connection":e.hasOutputConnection},{default:y(()=>{var u;return[m(l,{placement:"bottom-start",visible:e.showTriggerWaitingWarning,disabled:!e.showTriggerWaitingWarning},{content:y(()=>[g("div",{class:D(e.$style.triggerWarning)},T(e.$locale.baseText("ndv.backToCanvas.waitingForTriggerWarning")),3)]),default:y(()=>[g("div",{class:D(e.$style.backToCanvas),"data-test-id":"back-to-canvas",onClick:t[0]||(t[0]=(...k)=>e.close&&e.close(...k))},[m(a,{icon:"arrow-left",color:"text-xlight",size:"medium"}),m(r,{color:"text-xlight",size:"medium",bold:!0},{default:y(()=>[I(T(e.$locale.baseText("ndv.backToCanvas")),1)]),_:1})],2)]),_:1},8,["visible","disabled"]),e.activeNode?(c(),b("div",{key:0,ref:"container",class:"data-display",tabindex:"0",onKeydownCapture:t[6]||(t[6]=(...k)=>e.onKeyDown&&e.onKeyDown(...k))},[g("div",{class:D(e.$style.modalBackground),onClick:t[1]||(t[1]=(...k)=>e.close&&e.close(...k))},null,2),(c(),P(N,{key:e.activeNode.name,"is-trigger-node":e.isTriggerNode,"hide-input-and-output":e.activeNodeType===null,position:e.isTriggerNode&&!e.showTriggerPanel?0:void 0,"is-draggable":!e.isTriggerNode,"has-double-width":((u=e.activeNodeType)==null?void 0:u.parameterPane)==="wide","node-type":e.activeNodeType,onSwitchSelectedNode:e.onSwitchSelectedNode,onClose:e.close,onInit:e.onPanelsInit,onDragstart:e.onDragStart,onDragend:e.onDragEnd},Yt({output:y(()=>[m(p,{"data-test-id":"output-panel","can-link-runs":e.canLinkRuns,"run-index":e.outputRun,"linked-runs":e.linked,"session-id":e.sessionId,"is-read-only":e.readOnly||e.hasForeignCredential,"block-u-i":e.blockUi&&e.isTriggerNode&&!e.isExecutableTriggerNode,"is-production-execution-preview":e.isProductionExecutionPreview,"is-pane-active":e.isOutputPaneActive,onActivatePane:e.activateOutputPane,onLinkRun:e.onLinkRunToOutput,onUnlinkRun:t[3]||(t[3]=()=>e.onUnlinkRun("output")),onRunChange:e.onRunOutputIndexChange,onOpenSettings:e.openSettings,onTableMounted:e.onOutputTableMounted,onItemHover:e.onOutputItemHover,onSearch:e.onSearch},null,8,["can-link-runs","run-index","linked-runs","session-id","is-read-only","block-u-i","is-production-execution-preview","is-pane-active","onActivatePane","onLinkRun","onRunChange","onOpenSettings","onTableMounted","onItemHover","onSearch"])]),main:y(()=>[m(w,{"event-bus":e.settingsEventBus,dragging:e.isDragging,"session-id":e.sessionId,"node-type":e.activeNodeType,"foreign-credentials":e.foreignCredentials,"read-only":e.readOnly,"block-u-i":e.blockUi&&e.showTriggerPanel,executable:!e.readOnly,onValueChanged:e.valueChanged,onExecute:e.onNodeExecute,onStopExecution:e.onStopExecution,onRedrawRequired:t[4]||(t[4]=k=>e.redrawRequired=!0),onActivate:e.onWorkflowActivate},null,8,["event-bus","dragging","session-id","node-type","foreign-credentials","read-only","block-u-i","executable","onValueChanged","onExecute","onStopExecution","onActivate"]),e.featureRequestUrl?(c(),b("a",{key:0,class:D(e.$style.featureRequest),target:"_blank",onClick:t[5]||(t[5]=(...k)=>e.onFeatureRequestClick&&e.onFeatureRequestClick(...k))},[m(f,{icon:"lightbulb"}),I(" "+T(e.$locale.baseText("ndv.featureRequest")),1)],2)):C("",!0)]),_:2},[e.showTriggerPanel||!e.isTriggerNode?{name:"input",fn:y(()=>[e.showTriggerPanel?(c(),P(d,{key:0,"node-name":e.activeNode.name,"session-id":e.sessionId,onExecute:e.onNodeExecute,onActivate:e.onWorkflowActivate},null,8,["node-name","session-id","onExecute","onActivate"])):e.isTriggerNode?C("",!0):(c(),P(h,{key:1,workflow:e.workflow,"can-link-runs":e.canLinkRuns,"run-index":e.inputRun,"linked-runs":e.linked,"current-node-name":e.inputNodeName,"session-id":e.sessionId,"read-only":e.readOnly||e.hasForeignCredential,"is-production-execution-preview":e.isProductionExecutionPreview,"is-pane-active":e.isInputPaneActive,onActivatePane:e.activateInputPane,onLinkRun:e.onLinkRunToInput,onUnlinkRun:t[2]||(t[2]=()=>e.onUnlinkRun("input")),onRunChange:e.onRunInputIndexChange,onOpenSettings:e.openSettings,onChangeInputNode:e.onInputNodeChange,onExecute:e.onNodeExecute,onTableMounted:e.onInputTableMounted,onItemHover:e.onInputItemHover,onSearch:e.onSearch},null,8,["workflow","can-link-runs","run-index","linked-runs","current-node-name","session-id","read-only","is-production-execution-preview","is-pane-active","onActivatePane","onLinkRun","onRunChange","onOpenSettings","onChangeInputNode","onExecute","onTableMounted","onItemHover","onSearch"]))]),key:"0"}:void 0]),1032,["is-trigger-node","hide-input-and-output","position","is-draggable","has-double-width","node-type","onSwitchSelectedNode","onClose","onInit","onDragstart","onDragend"]))],544)):C("",!0)]}),_:1},8,["model-value","before-close","data-has-output-connection"])}const ec={$style:Qu},tc=L(ju,[["render",Zu],["__cssModules",ec]]),oc=x({__name:"ContextMenu",emits:["action"],setup(e,{emit:t}){const o=Qe(),{position:n,isOpen:s,actions:i,target:a}=o,r=H();kn(s,()=>{var h,p;s?(h=r.value)==null||h.open():(p=r.value)==null||p.close()},{flush:"post"});function l(h){const p=h;o._dispatchAction(p),t("action",p,o.targetNodes.value)}function d(h){h||o.close()}return(h,p)=>B(s)?(c(),P(Dn,{key:0,to:"body"},[g("div",{class:D(h.$style.contextMenu),style:oe({left:`${B(n)[0]}px`,top:`${B(n)[1]}px`})},[m(B(ns),{ref_key:"dropdown",ref:r,items:B(i),placement:"bottom-start","data-test-id":"context-menu","hide-arrow":B(a).source!=="node-button",onSelect:l,onVisibleChange:d},{activator:y(()=>[g("div",{class:D(h.$style.activator)},null,2)]),_:1},8,["items","hide-arrow"])],6)])):C("",!0)}}),nc="_contextMenu_2nizv_5",sc="_activator_2nizv_9",ic={contextMenu:nc,activator:sc},ac={$style:ic},rc=L(oc,[["__cssModules",ac]]),lc=(e,t)=>{const o=rs.includes(e);return{type:"N8nAddInput",options:{width:24,height:72,color:t,multiple:o}}},dc=()=>({type:"Rectangle",options:{height:10,width:10,cssClass:"diamond-output-endpoint"}}),Rn=x({data(){return{inputs:[],outputs:[]}},mounted(){if(this.data!==null)try{this.__addNode(this.data)}catch{}},computed:{...G(j,le,xt,z,zt),data(){return this.workflowsStore.getNodeByName(this.name)},nodeId(){var e;return((e=this.data)==null?void 0:e.id)||""}},props:{name:{type:String,required:!0},instance:{type:Object},isReadOnly:{type:Boolean},isActive:{type:Boolean},hideActions:{type:Boolean},disableSelecting:{type:Boolean},showCustomTooltip:{type:Boolean},workflow:{type:Object,required:!0}},methods:{__addEndpointTestingData(e,t,o){if(window!=null&&window.Cypress&&"canvas"in e.endpoint){const n=e.endpoint.canvas;this.instance.setAttribute(n,"data-endpoint-name",this.data.name),this.instance.setAttribute(n,"data-input-index",o.toString()),this.instance.setAttribute(n,"data-endpoint-type",t)}},__addInputEndpoints(e,t){const o={},n={},s=pe(this.workflow,this.data,t)||[];this.inputs=s;const i=[...s];i.sort((a,r)=>typeof a=="string"?1:typeof r=="string"||a.required&&!r.required?-1:!a.required&&r.required?1:0),i.forEach((a,r)=>{var A,O;let l;typeof a=="string"?l={type:a}:l=a;const d=l.type,h=d===_.Main?_.Main:"other";o.hasOwnProperty(h)?o[h]++:o[h]=0,n.hasOwnProperty(d)?n[d]++:n[d]=0;const p=o[h],w=n[d],f=s.filter(W=>{const V=typeof W=="string"?W:W.type;return d===_.Main?V===_.Main:V!==_.Main}),N=f.filter(W=>W!==_.Main),E=N.filter(W=>typeof W!="string"&&W.required),u=N.filter(W=>typeof W!="string"&&!W.required),k=this.getSpacerIndexes(E.length,u.length),v=_o(d,"input",f.length,k)[p],$=Rt(d),M={uuid:Nn(this.nodeId,d,w),anchor:v,maxConnections:l.maxConnections??-1,endpoint:"Rectangle",paintStyle:bt(t,"--color-foreground-xdark",d),hoverPaintStyle:bt(t,"--color-primary",d),scope:ti($),source:d!==_.Main,target:!this.isReadOnly&&s.length>1,parameters:{connection:"target",nodeId:this.nodeId,type:d,index:w},enabled:!this.isReadOnly,cssClass:"rect-input-endpoint",dragAllowedWhenFull:!0,hoverClass:"rect-input-endpoint-hover",...this.__getInputConnectionStyle(d,t)},R=(A=this.instance)==null?void 0:A.addEndpoint(this.$refs[this.data.name],M);this.__addEndpointTestingData(R,"input",w),(l.displayName||(O=t.inputNames)!=null&&O[r])&&R.addOverlay(oi(l.displayName||t.inputNames[r],d,l.required)),Array.isArray(R)||(R.__meta={nodeName:e.name,nodeId:this.nodeId,index:w,totalEndpoints:f.length,nodeType:e.type})}),i.length===0&&this.instance.manage(this.$refs[this.data.name])},getSpacerIndexes(e,t,o=ss,n=is){const s=[];if(e>0&&t>0){if(o)s.push(e);else if(e+t<n)for(let i=e;i<n-t;i++)s.push(i)}else if(e>0&&e<n&&t===0)for(let i=0;i<n-e;i++)s.push(i+e);else if(e===0&&t>0&&t<n)for(let i=0;i<n-t;i++)s.push(i);return s},__addOutputEndpoints(e,t){const o={},n={};this.outputs=ve(this.workflow,this.data,t)||[];let s=0;const i=[];this.outputs.forEach((r,l)=>{var h;let d;typeof r=="string"?d={type:r}:d=r,(h=t.outputNames)!=null&&h[l]&&(d.displayName=t.outputNames[l]),d.displayName&&(s=d.displayName.length>s?d.displayName.length:s),i.push(d)});const a=s<4?"short":"medium";this.outputs.forEach((r,l)=>{const d=i[l],h=d.type,p=h===_.Main?_.Main:"other";o.hasOwnProperty(p)?o[p]++:o[p]=0,n.hasOwnProperty(h)?n[h]++:n[h]=0;const w=o[p],f=n[h],N=this.outputs.filter($=>{const M=typeof $=="string"?$:$.type;return h===_.Main?M===_.Main:M!==_.Main}),E=_o(h,"output",N.length)[w],u=Rt(h),k={uuid:_t(this.nodeId,h,f),anchor:E,maxConnections:-1,endpoint:{type:"Dot",options:{radius:t&&N.length>2?7:9}},hoverPaintStyle:ze(t,"--color-primary"),scope:u,source:!0,target:h!==_.Main,enabled:!this.isReadOnly,parameters:{connection:"source",nodeId:this.nodeId,type:h,index:f},hoverClass:"dot-output-endpoint-hover",connectionsDirected:!0,dragAllowedWhenFull:!1,...this.__getOutputConnectionStyle(h,d,t)},v=this.instance.addEndpoint(this.$refs[this.data.name],k);if(this.__addEndpointTestingData(v,"output",f),d.displayName){const $=ni(d.displayName,h,d==null?void 0:d.category);v.addOverlay($)}if(Array.isArray(v)||(v.__meta={nodeName:e.name,nodeId:this.nodeId,index:f,totalEndpoints:N.length,endpointLabelLength:a}),!this.isReadOnly&&h===_.Main){const $={uuid:_t(this.nodeId,h,f),anchor:E,maxConnections:-1,endpoint:{type:"N8nPlus",options:{dimensions:24,connectedEndpoint:v,showOutputLabel:this.outputs.length===1,size:this.outputs.length>=3?"small":"medium",endpointLabelLength:a,hoverMessage:this.$locale.baseText("nodeBase.clickToAddNodeOrDragToConnect")}},source:!0,target:!1,enabled:!this.isReadOnly,paintStyle:{outlineStroke:"none"},hoverPaintStyle:{outlineStroke:"none"},parameters:{connection:"source",nodeId:this.nodeId,type:h,index:f,category:d==null?void 0:d.category},cssClass:"plus-draggable-endpoint",dragAllowedWhenFull:!1};d!=null&&d.category&&($.cssClass=`${$.cssClass} ${d==null?void 0:d.category}`);const M=this.instance.addEndpoint(this.$refs[this.data.name],$);this.__addEndpointTestingData(M,"plus",f),Array.isArray(M)||(M.__meta={nodeName:e.name,nodeId:this.nodeId,index:f,nodeType:e.type,totalEndpoints:N.length})}})},__addNode(e){const t=this.nodeTypesStore.getNodeType(e.type,e.typeVersion)??this.nodeTypesStore.getNodeType(as);this.__addInputEndpoints(e,t),this.__addOutputEndpoints(e,t)},__getEndpointColor(e){return`--node-type-${e}-color`},__getInputConnectionStyle(e,t){return e===_.Main?{paintStyle:bt(t,this.__getEndpointColor(_.Main),e)}:Object.values(_).includes(e)?(n=>({endpoint:lc(n,this.__getEndpointColor(n))}))(e):{}},__getOutputConnectionStyle(e,t,o){const n="output",s=i=>({endpoint:dc(),paintStyle:ze(o,this.__getEndpointColor(i)),hoverPaintStyle:ze(o,this.__getEndpointColor(i))});return e===_.Main?t.category==="error"?{paintStyle:{...ze(o,this.__getEndpointColor(_.Main)),fill:"var(--node-error-output-color)"},cssClass:`dot-${n}-endpoint`}:{paintStyle:ze(o,this.__getEndpointColor(_.Main)),cssClass:`dot-${n}-endpoint`}:Object.values(_).includes(e)?s(e):{}},touchEnd(e){ke().isTouchDevice&&this.uiStore.isActionActive("dragActive")&&this.uiStore.removeActiveAction("dragActive")},mouseLeftClick(e){const t=ke(),o=e.path||e.composedPath&&e.composedPath();for(let n=0;n<o.length;n++)if(o[n].className&&typeof o[n].className=="string"&&o[n].className.includes("no-select-on-click"))return;t.isTouchDevice||(this.uiStore.isActionActive("dragActive")?this.uiStore.removeActiveAction("dragActive"):(t.isCtrlKeyPressed(e)||this.$emit("deselectAllNodes"),this.uiStore.isNodeSelected(this.data.name)?this.$emit("deselectNode",this.name):this.$emit("nodeSelected",this.name)))}}}),uc=x({name:"Node",components:{TitledList:si,FontAwesomeIcon:ls,NodeIcon:yt},mixins:[Rn,Oe],props:{isProductionExecutionPreview:{type:Boolean,default:!1},disablePointerEvents:{type:Boolean,default:!1},hideNodeIssues:{type:Boolean,default:!1}},setup(e){const t=z(),o=Qe(),n=be(),s=xe(),i=t.getNodeByName(e.name),a=Ne(i),r=ke(),{callDebounced:l}=Mt();return{contextMenu:o,externalHooks:n,nodeHelpers:s,pinnedData:a,deviceSupport:r,callDebounced:l}},computed:{...G(j,q,le,z),showPinnedDataInfo(){return this.pinnedData.hasData.value&&!this.isProductionExecutionPreview},isDuplicatable(){return this.nodeType?an.includes(this.nodeType.name)?!1:this.nodeType.maxNodes===void 0||this.sameTypeNodes.length<this.nodeType.maxNodes:!0},isScheduledGroup(){var e;return((e=this.nodeType)==null?void 0:e.group.includes("schedule"))===!0},iconColorDefault(){if(this.isConfigNode)return"var(--color-text-base)"},nodeRunData(){var e;return this.workflowsStore.getWorkflowResultDataByNodeName(((e=this.data)==null?void 0:e.name)||"")||[]},hasIssues(){var e;return this.nodeExecutionStatus&&["crashed","error","failed"].includes(this.nodeExecutionStatus)?!0:this.pinnedData.hasData.value?!1:!!(((e=this.data)==null?void 0:e.issues)!==void 0&&Object.keys(this.data.issues).length)},workflowDataItems(){const e=this.nodeRunData;return e===null?0:e.length},canvasOffsetPosition(){return this.uiStore.nodeViewOffsetPosition},getTriggerNodeTooltip(){if(this.nodeType!==null&&this.nodeType.hasOwnProperty("eventTriggerDescription")){const e=this.$locale.shortNodeType(this.nodeType.name),{eventTriggerDescription:t}=this.nodeType;return this.$locale.nodeText().eventTriggerDescription(e,t||"")}else return this.$locale.baseText("node.waitingForYouToCreateAnEventIn",{interpolate:{nodeType:this.nodeType?dt(this.nodeType):""}})},isPollingTypeNode(){var e;return!!((e=this.nodeType)!=null&&e.polling)},isExecuting(){return this.workflowsStore.isNodeExecuting(this.data.name)},isSingleActiveTriggerNode(){return this.workflowsStore.workflowTriggerNodes.filter(t=>{const o=this.nodeTypesStore.getNodeType(t.type,t.typeVersion);return o&&o.eventTriggerDescription!==""&&!t.disabled}).length===1},isManualTypeNode(){return this.data.type===Je},isConfigNode(){var e;return this.nodeTypesStore.isConfigNode(this.workflow,this.data,((e=this.data)==null?void 0:e.type)??"")},isConfigurableNode(){var e;return this.nodeTypesStore.isConfigurableNode(this.workflow,this.data,((e=this.data)==null?void 0:e.type)??"")},isTriggerNode(){var e;return this.nodeTypesStore.isTriggerNode(((e=this.data)==null?void 0:e.type)||"")},isTriggerNodeTooltipEmpty(){return this.nodeType!==null?this.nodeType.eventTriggerDescription==="":!1},isNodeDisabled(){return this.node&&this.node.disabled},nodeType(){return this.data&&this.nodeTypesStore.getNodeType(this.data.type,this.data.typeVersion)},node(){return this.workflowsStore.nodesByName[this.name]},sameTypeNodes(){return this.workflowsStore.allNodes.filter(e=>e.type===this.data.type)},nodeWrapperClass(){const e={"node-wrapper":!0,"node-wrapper--trigger":this.isTriggerNode,"node-wrapper--configurable":this.isConfigurableNode,"node-wrapper--config":this.isConfigNode};if(this.outputs.length){const o=re(this.outputs).filter(n=>n!==_.Main);o.length&&o.forEach(n=>{e[`node-wrapper--connection-type-${n}`]=!0})}return e},nodeWrapperStyles(){const e={left:this.position[0]+"px",top:this.position[1]+"px"};if(this.node&&this.nodeType){const t=pe(this.workflow,this.node,this.nodeType)||[],n=re(t).filter(r=>r!==_.Main);if(n.length){t.filter(l=>typeof l!="string"&&l.required);let r=0;e["--configurable-node-input-count"]=n.length+r}let s=[];this.workflow.nodes[this.node.name]&&(s=ve(this.workflow,this.node,this.nodeType));const a=re(s).filter(r=>r===_.Main);e["--node-main-output-count"]=a.length}return e},nodeClass(){return{"node-box":!0,disabled:this.data.disabled,executing:this.isExecuting}},nodeExecutionStatus(){var t;const e=(t=this.workflowsStore.getWorkflowRunData)==null?void 0:t[this.name];return e?e.filter(Boolean)[0].executionStatus??"":""},nodeIssues(){var o,n;const e=[],t=(o=this.workflowsStore.getWorkflowRunData)==null?void 0:o[this.name];return t&&t.forEach(s=>{s!=null&&s.error&&e.push(`${s.error.message}${s.error.description?` (${s.error.description})`:""}`)}),((n=this.data)==null?void 0:n.issues)!==void 0&&e.push(...ds(this.data.issues,this.data)),e},nodeDisabledIcon(){return this.data.disabled===!1?"pause":"play"},position(){return this.node?this.node.position:[0,0]},showDisabledLinethrough(){return!this.isConfigurableNode&&!!(this.data.disabled&&this.inputs.length===1&&this.outputs.length===1)},shortNodeType(){return this.$locale.shortNodeType(this.data.type)},nodeTitle(){return this.data.name==="Start"?this.$locale.headerText({key:"headers.start.displayName",fallback:"Start"}):this.data.name},waiting(){const e=this.workflowsStore.getWorkflowExecution;if(e!=null&&e.waitTill){const t=ce(e,"data.resultData.lastNodeExecuted");if(this.name===t){const o=new Date(e.waitTill);return o.toISOString()===us?this.$locale.baseText("node.theNodeIsWaitingIndefinitelyForAnIncomingWebhookCall"):this.$locale.baseText("node.nodeIsWaitingTill",{interpolate:{date:o.toLocaleDateString(),time:o.toLocaleTimeString()}})}}},workflowRunning(){return this.uiStore.isActionActive("workflowRunning")},nodeStyle(){var o,n,s;const e={};let t="--color-foreground-xdark";return(this.isConfigurableNode||this.isConfigNode)&&(t="--color-foreground-dark"),this.data.disabled?t="--color-foreground-base":this.isExecuting||(this.hasIssues&&!this.hideNodeIssues?((s=(n=(o=this.nodeRunData)==null?void 0:o[0])==null?void 0:n.error)==null?void 0:s.functionality)!=="configuration-node"&&(t="--color-danger",e["border-width"]="2px",e["border-style"]="solid"):this.waiting||this.showPinnedDataInfo?t="--color-canvas-node-pinned-border":this.nodeExecutionStatus==="unknown"?t="--color-foreground-xdark":this.workflowDataItems&&(e["border-width"]="2px",e["border-style"]="solid",t="--color-success")),e["border-color"]=`var(${t})`,e},isSelected(){return this.uiStore.getSelectedNodes.find(e=>e.name===this.data.name)!==void 0},shiftOutputCount(){return!!(this.nodeType&&this.outputs.length>2)},shouldShowTriggerTooltip(){return!!this.node&&this.isTriggerNode&&!this.isPollingTypeNode&&!this.pinnedData.hasData.value&&!this.isNodeDisabled&&this.workflowRunning&&this.workflowDataItems===0&&this.isSingleActiveTriggerNode&&!this.isTriggerNodeTooltipEmpty&&!this.hasIssues&&!this.dragging},isContextMenuOpen(){var e;return this.contextMenu.isOpen.value&&this.contextMenu.target.value.source==="node-button"&&this.contextMenu.target.value.node.name===((e=this.data)==null?void 0:e.name)}},watch:{isActive(e,t){!e&&t&&this.setSubtitle()},canvasOffsetPosition(){this.showTriggerNodeTooltip&&(this.showTriggerNodeTooltip=!1,setTimeout(()=>{this.showTriggerNodeTooltip=this.shouldShowTriggerTooltip},200)),this.pinDataDiscoveryTooltipVisible&&(this.pinDataDiscoveryTooltipVisible=!1,setTimeout(()=>{this.pinDataDiscoveryTooltipVisible=!0},200))},shouldShowTriggerTooltip(e){e?setTimeout(()=>{this.showTriggerNodeTooltip=this.shouldShowTriggerTooltip},2500):this.showTriggerNodeTooltip=!1},nodeRunData(e){this.data&&this.$emit("run",{name:this.data.name,data:e,waiting:!!this.waiting})}},created(){Ie(Ot).value||(this.unwatchWorkflowDataItems=this.$watch("workflowDataItems",t=>{this.showPinDataDiscoveryTooltip(t)}))},mounted(){setTimeout(()=>{this.setSubtitle()},0),this.nodeRunData&&setTimeout(()=>{this.$emit("run",{name:this.data&&this.data.name,data:this.nodeRunData,waiting:!!this.waiting})},0)},data(){return{isTouchActive:!1,nodeSubtitle:"",showTriggerNodeTooltip:!1,pinDataDiscoveryTooltipVisible:!1,dragging:!1,unwatchWorkflowDataItems:()=>{}}},methods:{showPinDataDiscoveryTooltip(e){!this.isTriggerNode||this.isManualTypeNode||this.isScheduledGroup||this.uiStore.isModalActive||e===0||(Ie(Ot).value="true",this.pinDataDiscoveryTooltipVisible=!0,this.unwatchWorkflowDataItems())},setSubtitle(){try{const e=this.nodeHelpers.getNodeSubtitle(this.data,this.nodeType,this.workflow)||"";this.nodeSubtitle=e.includes(cs)?"":e}catch{}},disableNode(){this.data!==null&&(this.nodeHelpers.disableNodes([this.data]),this.historyStore.pushCommandToUndo(new ii(this.data.name,!this.data.disabled,this.data.disabled===!0)),this.$telemetry.track("User clicked node hover button",{node_type:this.data.type,button_name:"disable",workflow_id:this.workflowsStore.workflowId}))},executeNode(){this.$emit("runWorkflow",this.data.name,"Node.executeNode"),this.$telemetry.track("User clicked node hover button",{node_type:this.data.type,button_name:"execute",workflow_id:this.workflowsStore.workflowId})},onClick(e){this.callDebounced(this.onClickDebounced,{debounceTime:50,trailing:!0},e)},onClickDebounced(e){e.detail>=2?this.setNodeActive():this.mouseLeftClick(e)},setNodeActive(){this.ndvStore.activeNodeName=this.data?this.data.name:"",this.pinDataDiscoveryTooltipVisible=!1},touchStart(){this.deviceSupport.isTouchDevice&&!this.deviceSupport.isMacOs&&!this.isTouchActive&&(this.isTouchActive=!0,setTimeout(()=>{this.isTouchActive=!1},2e3))},openContextMenu(e,t){this.data&&this.contextMenu.open(e,{source:t,node:this.data})}}}),_n=e=>(Tn("data-v-99846adb"),e=e(),Sn(),e),cc=["id","data-name","data-node-type"],hc={class:"select-background"},pc={key:0,class:"trigger-icon"},fc=["innerHTML"],gc={key:0,class:"node-issues","data-test-id":"node-issues"},mc={key:1,class:"waiting"},yc=["textContent"],wc={key:2,class:"node-pin-data-icon"},vc={key:0,class:"items-count"},Nc={key:3},kc={key:4,class:"data-count"},bc={key:0,class:"items-count"},Tc=["title"],Sc={class:"node-trigger-tooltip__wrapper"},Dc=["textContent"],Ec=_n(()=>g("span",null,null,-1)),Cc=_n(()=>g("span",null,null,-1)),Ic={key:0,class:"node-options no-select-on-click"},Pc={class:"node-description"},Oc=["title"],$c={"data-test-id":"canvas-node-box-title"},Rc={key:0},_c=["title"];function Ac(e,t,o,n,s,i){var w;const a=S("FontAwesomeIcon"),r=S("n8n-tooltip"),l=S("TitledList"),d=S("NodeIcon"),h=S("n8n-icon-button"),p=Kt("touch");return c(),b("div",{id:e.nodeId,ref:e.data.name,class:D(e.nodeWrapperClass),style:oe(e.nodeWrapperStyles),"data-test-id":"canvas-node","data-name":e.data.name,"data-node-type":(w=e.nodeType)==null?void 0:w.name,onContextmenu:t[2]||(t[2]=f=>e.openContextMenu(f,"node-right-click"))},[Y(g("div",hc,null,512),[[J,e.isSelected]]),g("div",{class:D({"node-default":!0,"touch-active":e.isTouchActive,"is-touch-device":e.deviceSupport.isTouchDevice,"menu-open":e.isContextMenuOpen,"disable-pointer-events":e.disablePointerEvents})},[Y((c(),b("div",{class:D(e.nodeClass),style:oe(e.nodeStyle),onClick:t[0]||(t[0]=te((...f)=>e.onClick&&e.onClick(...f),["left"]))},[e.isTriggerNode?(c(),b("i",pc,[m(r,{placement:"bottom"},{content:y(()=>[g("span",{innerHTML:e.$locale.baseText("node.thisIsATriggerNode")},null,8,fc)]),default:y(()=>[m(a,{icon:"bolt",size:"lg"})]),_:1})])):C("",!0),e.data.disabled?C("",!0):(c(),b("div",{key:1,class:D({"node-info-icon":!0,"shift-icon":e.shiftOutputCount})},[e.hasIssues&&!e.hideNodeIssues?(c(),b("div",gc,[m(r,{"show-after":500,placement:"bottom"},{content:y(()=>[m(l,{title:`${e.$locale.baseText("node.issues")}:`,items:e.nodeIssues},null,8,["title","items"])]),default:y(()=>[m(a,{icon:"exclamation-triangle"})]),_:1})])):e.waiting||e.nodeExecutionStatus==="waiting"?(c(),b("div",mc,[m(r,{placement:"bottom"},{content:y(()=>[g("div",{textContent:T(e.waiting)},null,8,yc)]),default:y(()=>[m(a,{icon:"clock"})]),_:1})])):e.showPinnedDataInfo?(c(),b("span",wc,[m(a,{icon:"thumbtack"}),e.workflowDataItems>1?(c(),b("span",vc,T(e.workflowDataItems),1)):C("",!0)])):e.nodeExecutionStatus==="unknown"?(c(),b("span",Nc)):e.workflowDataItems?(c(),b("span",kc,[m(a,{icon:"check"}),e.workflowDataItems>1?(c(),b("span",bc,T(e.workflowDataItems),1)):C("",!0)])):C("",!0)],2)),g("div",{class:"node-executing-info",title:e.$locale.baseText("node.nodeIsExecuting")},[m(a,{icon:"sync-alt",spin:""})],8,Tc),g("div",Sc,[m(r,{placement:"top","show-after":500,visible:e.showTriggerNodeTooltip,"popper-class":"node-trigger-tooltip__wrapper--item"},{content:y(()=>[g("div",{textContent:T(e.getTriggerNodeTooltip)},null,8,Dc)]),default:y(()=>[Ec]),_:1},8,["visible"]),e.isTriggerNode?(c(),P(r,{key:0,placement:"top",visible:e.pinDataDiscoveryTooltipVisible,"popper-class":"node-trigger-tooltip__wrapper--item"},{content:y(()=>[I(T(e.$locale.baseText("node.discovery.pinData.canvas")),1)]),default:y(()=>[Cc]),_:1},8,["visible"])):C("",!0)]),m(d,{class:"node-icon","node-type":e.nodeType,size:40,shrink:!1,"color-default":e.iconColorDefault,disabled:e.data.disabled},null,8,["node-type","color-default","disabled"])],6)),[[p,e.touchStart,"start"],[p,e.touchEnd,"end"]]),e.isReadOnly?C("",!0):Y((c(),b("div",Ic,[m(h,{"data-test-id":"execute-node-button",type:"tertiary",text:"",icon:"play",disabled:e.workflowRunning||e.isConfigNode,title:e.$locale.baseText("node.testStep"),onClick:e.executeNode},null,8,["disabled","title","onClick"]),m(h,{"data-test-id":"overflow-node-button",type:"tertiary",text:"",icon:"ellipsis-h",onClick:t[1]||(t[1]=f=>e.openContextMenu(f,"node-button"))})],512)),[[J,!e.hideActions]]),e.showDisabledLinethrough?(c(),b("div",{key:1,class:D({"disabled-linethrough":!0,success:!["unknown"].includes(e.nodeExecutionStatus)&&e.workflowDataItems>0})},null,2)):C("",!0)],2),g("div",Pc,[g("div",{class:"node-name",title:e.nodeTitle},[g("p",$c,T(e.nodeTitle),1),e.data.disabled?(c(),b("p",Rc,"("+T(e.$locale.baseText("node.disabled"))+")",1)):C("",!0)],8,Oc),e.nodeSubtitle!==void 0?(c(),b("div",{key:0,class:"node-subtitle",title:e.nodeSubtitle},T(e.nodeSubtitle),9,_c)):C("",!0)])],46,cc)}const Mc=L(uc,[["render",Ac],["__scopeId","data-v-99846adb"]]),Wc=x({name:"Sticky",mixins:[Rn,Oe],props:{nodeViewScale:{type:Number},gridSize:{type:Number}},setup(){const e=ke(),t=H(),o=H(!1),n=i=>{o.value=i},s=Qe(i=>{var a;i==="change_color"&&(n(!0),(a=t.value)==null||a.click())});return{deviceSupport:e,colorPopoverTrigger:t,contextMenu:s,forceActions:o,setForceActions:n}},computed:{...G(j,q,le,z),defaultText(){if(!this.nodeType)return"";const t=this.nodeType.properties.find(o=>o.name==="content");return t&&Nt(t.default)?t.default:""},isSelected(){return this.uiStore.getSelectedNodes.find(e=>e.name===this.data.name)!==void 0},nodeType(){return this.data&&this.nodeTypesStore.getNodeType(this.data.type,this.data.typeVersion)},node(){return this.workflowsStore.getNodeByName(this.name)},position(){return this.node?this.node.position:[0,0]},height(){return this.node&&et(this.node.parameters.height)?this.node.parameters.height:0},width(){return this.node&&et(this.node.parameters.width)?this.node.parameters.width:0},stickySize(){return{height:this.height+"px",width:this.width+"px"}},stickyPosition(){return{left:this.position[0]+"px",top:this.position[1]+"px",zIndex:this.isActive?9999999:-1*Math.floor(this.height*this.width/1e3)}},showActions(){return!(this.hideActions||this.isReadOnly||this.workflowRunning||this.isResizing)||this.forceActions},workflowRunning(){return this.uiStore.isActionActive("workflowRunning")}},data(){return{isResizing:!1,isTouchActive:!1}},methods:{onShowPopover(){this.setForceActions(!0)},onHidePopover(){this.setForceActions(!1)},async deleteNode(){await this.$nextTick(),this.$emit("removeNode",this.data.name)},changeColor(e){this.workflowsStore.updateNodeProperties({name:this.name,properties:{parameters:{...this.node.parameters,color:e}}})},onEdit(e){e&&!this.isActive&&this.node?this.ndvStore.activeNodeName=this.node.name:this.isActive&&!e&&(this.ndvStore.activeNodeName=null)},onMarkdownClick(e,t){if(e){const o=this.name===mn,n=e.querySelector('img[alt="n8n quickstart video"'),s=o&&n?"welcome_video":o&&e.getAttribute("href")==="/templates"?"templates":"other";this.$telemetry.track("User clicked note link",{type:s})}},onInputChange(e){this.node.parameters.content=e,this.setParameters({content:e})},onResizeStart(){this.isResizing=!0,!this.isSelected&&this.node&&this.$emit("nodeSelected",this.node.name,!1,!0)},onResize({height:e,width:t,dX:o,dY:n}){this.node&&((o!==0||n!==0)&&this.setPosition([this.node.position[0]+(o||0),this.node.position[1]+(n||0)]),this.setParameters({height:e,width:t}))},onResizeEnd(){this.isResizing=!1},setParameters(e){if(this.node){const t={content:Nt(e.content)?e.content:this.node.parameters.content,height:et(e.height)?e.height:this.node.parameters.height,width:et(e.width)?e.width:this.node.parameters.width,color:Nt(e.color)?e.color:this.node.parameters.color},o={key:this.node.id,name:this.node.name,value:t};this.workflowsStore.setNodeParameters(o)}},setPosition(e){if(!this.node)return;const t={name:this.node.name,properties:{position:e}};this.workflowsStore.updateNodeProperties(t)},touchStart(){this.deviceSupport.isTouchDevice===!0&&!this.isMacOs&&!this.isTouchActive&&(this.isTouchActive=!0,setTimeout(()=>{this.isTouchActive=!1},2e3))},onContextMenu(e){this.node&&!this.isActive?this.contextMenu.open(e,{source:"node-right-click",node:this.node}):e.stopPropagation()}}}),Vc=["id","data-name"],Bc={class:"select-sticky-background"},Uc=["title"],Lc=["title"],xc={class:"content"},Hc=["onClick"];function Fc(e,t,o,n,s,i){const a=S("n8n-sticky"),r=S("font-awesome-icon"),l=S("n8n-popover"),d=Kt("touch");return c(),b("div",{id:e.nodeId,ref:e.data.name,class:"sticky-wrapper",style:oe(e.stickyPosition),"data-name":e.data.name,"data-test-id":"sticky"},[g("div",{class:D({"sticky-default":!0,"touch-active":e.isTouchActive,"is-touch-device":e.deviceSupport.isTouchDevice,"is-read-only":e.isReadOnly}),style:oe(e.stickySize)},[Y(g("div",Bc,null,512),[[J,e.isSelected]]),Y((c(),b("div",{class:"sticky-box",onClick:t[0]||(t[0]=te((...h)=>e.mouseLeftClick&&e.mouseLeftClick(...h),["left"])),onContextmenu:t[1]||(t[1]=(...h)=>e.onContextMenu&&e.onContextMenu(...h))},[m(a,{id:e.node.id,"model-value":e.node.parameters.content,height:e.node.parameters.height,width:e.node.parameters.width,scale:e.nodeViewScale,"background-color":e.node.parameters.color,"read-only":e.isReadOnly,"default-text":e.defaultText,"edit-mode":e.isActive&&!e.isReadOnly,"grid-size":e.gridSize,onEdit:e.onEdit,onResizestart:e.onResizeStart,onResize:e.onResize,onResizeend:e.onResizeEnd,onMarkdownClick:e.onMarkdownClick,"onUpdate:modelValue":e.onInputChange},null,8,["id","model-value","height","width","scale","background-color","read-only","default-text","edit-mode","grid-size","onEdit","onResizestart","onResize","onResizeend","onMarkdownClick","onUpdate:modelValue"])],32)),[[d,e.touchStart,"start"],[d,e.touchEnd,"end"]]),Y(g("div",{class:D({"sticky-options":!0,"no-select-on-click":!0,"force-show":e.forceActions})},[Y((c(),b("div",{class:"option","data-test-id":"delete-sticky",title:e.$locale.baseText("node.deleteNode")},[m(r,{icon:"trash"})],8,Uc)),[[d,e.deleteNode,"tap"]]),m(l,{effect:"dark","popper-style":{width:"208px"},trigger:"click",placement:"top",onShow:e.onShowPopover,onHide:e.onHidePopover},{reference:y(()=>[g("div",{ref:"colorPopoverTrigger",class:"option","data-test-id":"change-sticky-color",title:e.$locale.baseText("node.changeColor")},[m(r,{icon:"palette"})],8,Lc)]),default:y(()=>[g("div",xc,[(c(!0),b(Q,null,ae(Array.from({length:7}),(h,p)=>{var w,f;return c(),b("div",{key:p,class:D(["color",`sticky-color-${p+1}`]),"data-test-id":"color",style:oe({"border-width":"1px","border-style":"solid","border-color":"var(--color-foreground-xdark)","background-color":`var(--color-sticky-background-${p+1})`,"box-shadow":p===0&&((w=e.node)==null?void 0:w.parameters.color)===""||p+1===((f=e.node)==null?void 0:f.parameters.color)?`0 0 0 1px var(--color-sticky-background-${p+1})`:"none"}),onClick:N=>e.changeColor(p+1)},null,14,Hc)}),128))])]),_:1},8,["onShow","onHide"])],2),[[J,e.showActions]])],6)],12,Vc)}const zc=L(Wc,[["render",Fc],["__scopeId","data-v-4b9533da"]]),Yc=60,Kc=30,jc=30,qc=15,Gc=-20,en=-200,Jc=-5;function Xc(e,t){let o=0,n=0;for(;o<e.length&&n<t.length;){const s=e.charAt(o).toLowerCase(),i=t.charAt(n).toLowerCase();s===i&&o++,++n}return e.length!==0&&t.length!==0&&o===e.length}function Qc(e,t){return An(e,t,0,0,null,[],256,0,0,5)}function An(e,t,o,n,s,i,a,r,l,d){let h=0;if(++l>=d)return{matched:!1,outScore:h};if(o===e.length||n===t.length)return{matched:!1,outScore:h};let p=!1,w=[],f=0,N=!0;for(;o<e.length&&n<t.length;){if(e[o].toLowerCase()===t[n].toLowerCase()){if(r>=a)return{matched:!1,outScore:h};N&&s&&(i=[...s],N=!1);const u=[],k=An(e,t,o,n+1,i,u,a,r,l,d),v=k.outScore;k.matched&&((!p||v>f)&&(w=[...u],f=v),p=!0),i[r++]=n,++o}++n}const E=o===e.length;if(E){h=100;let u=Gc*i[0];u=u<en?en:u,h+=u;const k=t.length-r;h+=Jc*k;for(let v=0;v<r;v++){const $=i[v];if(v>0){const M=i[v-1];$===M+1&&(h+=Yc)}if($>0){const M=t[$-1],R=t[$];M!==M.toUpperCase()&&R!==R.toLowerCase()&&(h+=jc),(M==="_"||M===" ")&&(h+=Kc)}else h+=qc}return p&&(!E||f>h)?(i=[...w],h=f,{matched:!0,outScore:h}):E?{matched:!0,outScore:h}:{matched:!1,outScore:h}}return{matched:!1,outScore:h}}function Zc(e,t){if(e.hasOwnProperty(t))return e[t];const o=t.split(".");let n=e,s=0;for(;n&&s<o.length;){const i=o[s];n=n[i],s++}return n}function eh(e,t,o){const n=t.reduce((s,i)=>{let a=[];o.forEach(({key:l,weight:d})=>{const h=Zc(i,l);Array.isArray(h)?a=a.concat(h.map(p=>({value:p,weight:d}))):typeof h=="string"&&a.push({value:h,weight:d})});const r=a.reduce((l,{value:d,weight:h})=>{if(!Xc(e,d))return l;const p=Qc(e,d);p.outScore*=h;const{matched:w,outScore:f}=p;return!l&&w||w&&l&&f>l.outScore?p:l},null);return r&&s.push({score:r.outScore,item:i}),s},[]);return n.sort((s,i)=>i.score-s.score),n}function qe(e,t,o="node"){var s,i,a;const n={uuid:he(),key:e.name,subcategory:t??((a=(i=(s=e.codex)==null?void 0:s.subcategories)==null?void 0:i[ie])==null?void 0:a[0])??Xe,properties:{...e},type:o};return n}function th(e){const t=[ie,Vt];return e.reduce((o,n)=>{let s=[Xe];return t.forEach(i=>{var a,r,l,d;(r=(a=n.codex)==null?void 0:a.categories)!=null&&r.includes(i)&&(s=((d=(l=n.codex)==null?void 0:l.subcategories)==null?void 0:d[i])??[])}),s.forEach(i=>{o[i]||(o[i]=[]),o[i].push(qe(n,i))}),o},{})}function At(e){return e.sort((t,o)=>{var i,a,r,l;if(t.type!=="node"||o.type!=="node")return 0;const n=((a=(i=t.properties)==null?void 0:i.displayName)==null?void 0:a.toLowerCase())||t.key,s=((l=(r=o.properties)==null?void 0:r.displayName)==null?void 0:l.toLowerCase())||o.key;return n.localeCompare(s,void 0,{sensitivity:"base"})})}function tn(e,t){const o=e.toLowerCase().replace("trigger","").trimEnd();return(eh(o,t,[{key:"properties.displayName",weight:1.3},{key:"properties.codex.alias",weight:1}])||[]).map(({item:s})=>s)}function on(e){return e.map(t=>t.type==="section"?t.children:t).flat()}function oh(e,t){const o=e.reduce((s,i)=>{const a=t.find(l=>l.items.includes(i.key)),r=(a==null?void 0:a.key)??"other";return s[r]=[...s[r]??[],i],s},{}),n=t.map(s=>({type:"section",key:s.key,title:s.title,children:At(o[s.key]??[])})).concat({type:"section",key:"other",title:hs.baseText("nodeCreator.sectionNames.other"),children:At(o.other??[])}).filter(s=>s.children.length>0);return n.length<=1?e:n}const ft=Ut(ps.NODE_CREATOR,()=>{const e=H(Ue),t=H([]),o=H({}),n=H(!1),s=H(""),i=K(()=>Object.values(t.value).map(p=>qe(p)));function a(p){t.value=p}function r(p){o.value=p}function l(p){n.value=p}function d(p){e.value=p}function h(p){s.value=p}return{openSource:s,selectedView:e,showScrim:n,mergedNodes:t,actions:o,setShowScrim:l,setSelectedView:d,setOpenSource:h,setActions:r,setMergeNodes:a,allNodeCreatorNodes:i}}),nh=["textContent"],sh=x({__name:"CanvasAddButton",props:{showTooltip:{type:Boolean},position:{}},setup(e){const t=e,o=ft(),n=K(()=>({"--trigger-placeholder-left-position":`${t.position[0]}px`,"--trigger-placeholder-top-position":`${t.position[1]}px`}));return(s,i)=>{const a=S("font-awesome-icon"),r=S("n8n-tooltip");return c(),b("div",{ref:"container",class:D(s.$style.canvasAddButton),style:oe(n.value),"data-test-id":"canvas-add-button"},[m(r,{placement:"top",visible:s.showTooltip,disabled:B(o).showScrim,"popper-class":s.$style.tooltip,"show-after":700},{content:y(()=>[I(T(s.$locale.baseText("nodeView.canvasAddButton.addATriggerNodeBeforeExecuting")),1)]),default:y(()=>[g("button",{class:D(s.$style.button),"data-test-id":"canvas-plus-button",onClick:i[0]||(i[0]=l=>s.$emit("click"))},[m(a,{icon:"plus",size:"lg"})],2)]),_:1},8,["visible","disabled","popper-class"]),g("p",{class:D(s.$style.label),textContent:T(s.$locale.baseText("nodeView.canvasAddButton.addFirstStep"))},null,10,nh)],6)}}}),ih="_canvasAddButton_mfxxv_5",ah="_button_mfxxv_17",rh="_label_mfxxv_38",lh={canvasAddButton:ih,button:ah,label:rh},dh={$style:lh},uh=L(sh,[["__cssModules",dh]]);function nn(e,t){return e.filter(o=>{var n,s,i;return(i=(s=(n=o.codex)==null?void 0:n.subcategories)==null?void 0:s[Vt])==null?void 0:i.includes(t)}).map(o=>({key:o.name,type:"node",properties:{group:[],name:o.name,displayName:o.displayName,title:o.displayName,description:o.description,icon:o.icon}})).sort((o,n)=>o.properties.displayName.localeCompare(n.properties.displayName))}function zh(e){const t=ge(),o=j(),n=nn(o.allLatestNodeTypes,Rs),s=nn(o.allLatestNodeTypes,_s);return{value:ct,title:t.baseText("nodeCreator.aiPanel.aiNodes"),subtitle:t.baseText("nodeCreator.aiPanel.selectAiNode"),info:t.baseText("nodeCreator.aiPanel.infoBox"),items:[...n,...s,{key:Bt,type:"view",properties:{title:t.baseText("nodeCreator.aiPanel.aiOtherNodes"),icon:"robot",description:t.baseText("nodeCreator.aiPanel.aiOtherNodesDescription")}}]}}function ch(e){const t=ge();function o(n){return{connectionType:n,iconProps:{color:`var(--node-type-${n}-color)`},panelClass:`nodes-list-panel-${n}`}}return{value:Bt,title:t.baseText("nodeCreator.aiPanel.aiOtherNodes"),subtitle:t.baseText("nodeCreator.aiPanel.selectAiNode"),items:[{key:ao,type:"subcategory",properties:{title:ao,icon:"file-import",...o(_.AiDocument)}},{key:ro,type:"subcategory",properties:{title:ro,icon:"language",...o(_.AiLanguageModel)}},{key:lo,type:"subcategory",properties:{title:lo,icon:"brain",...o(_.AiMemory)}},{key:uo,type:"subcategory",properties:{title:uo,icon:"list",...o(_.AiOutputParser)}},{key:co,type:"subcategory",properties:{title:co,icon:"search",...o(_.AiRetriever)}},{key:ho,type:"subcategory",properties:{title:ho,icon:"grip-lines-vertical",...o(_.AiTextSplitter)}},{key:po,type:"subcategory",properties:{title:po,icon:"tools",...o(_.AiTool)}},{key:fo,type:"subcategory",properties:{title:fo,icon:"vector-square",...o(_.AiEmbedding)}},{key:go,type:"subcategory",properties:{title:go,icon:"project-diagram",...o(_.AiVectorStore)}},{key:mo,type:"subcategory",properties:{title:mo,icon:"code"}}]}}function Yh(e){const t=ge();return{value:Ue,title:t.baseText("nodeCreator.triggerHelperPanel.selectATrigger"),subtitle:t.baseText("nodeCreator.triggerHelperPanel.selectATriggerDescription"),items:[{key:Xe,type:"subcategory",properties:{forceIncludeNodes:[Ce,fs],title:"App Trigger Nodes",icon:"satellite-dish"}},{key:yo,type:"node",category:[ie],properties:{group:[],name:yo,displayName:t.baseText("nodeCreator.triggerHelperPanel.scheduleTriggerDisplayName"),description:t.baseText("nodeCreator.triggerHelperPanel.scheduleTriggerDescription"),icon:"fa:clock"}},{key:Ce,type:"node",category:[ie],properties:{group:[],name:Ce,displayName:t.baseText("nodeCreator.triggerHelperPanel.webhookTriggerDisplayName"),description:t.baseText("nodeCreator.triggerHelperPanel.webhookTriggerDescription"),iconData:{type:"file",icon:"webhook",fileBuffer:"/static/webhook-icon.svg"}}},{key:Pe,type:"node",category:[ie],properties:{group:[],name:Pe,displayName:t.baseText("nodeCreator.triggerHelperPanel.formTriggerDisplayName"),description:t.baseText("nodeCreator.triggerHelperPanel.formTriggerDescription"),iconData:{type:"file",icon:"form",fileBuffer:"/static/form-grey.svg"}}},{key:Je,type:"node",category:[ie],properties:{group:[],name:Je,displayName:t.baseText("nodeCreator.triggerHelperPanel.manualTriggerDisplayName"),description:t.baseText("nodeCreator.triggerHelperPanel.manualTriggerDescription"),icon:"fa:mouse-pointer"}},{key:wo,type:"node",category:[ie],properties:{group:[],name:wo,displayName:t.baseText("nodeCreator.triggerHelperPanel.workflowTriggerDisplayName"),description:t.baseText("nodeCreator.triggerHelperPanel.workflowTriggerDescription"),icon:"fa:sign-out-alt"}},{type:"subcategory",key:vo,category:ie,properties:{title:vo,icon:"folder-open"}}]}}function Kh(e){const t=ge(),o={value:$t,title:t.baseText("nodeCreator.triggerHelperPanel.whatHappensNext"),items:[{key:Xe,type:"subcategory",properties:{title:"App Regular Nodes",icon:"globe",forceIncludeNodes:[gs,ms]}},{type:"subcategory",key:No,category:ie,properties:{title:No,icon:"pen",sections:[{key:"popular",title:t.baseText("nodeCreator.sectionNames.popular"),items:[ys,ko,ws]},{key:"addOrRemove",title:t.baseText("nodeCreator.sectionNames.transform.addOrRemove"),items:[bo,vs,Ns,ks]},{key:"combine",title:t.baseText("nodeCreator.sectionNames.transform.combine"),items:[bs,Ts,To]},{key:"convert",title:t.baseText("nodeCreator.sectionNames.transform.convert"),items:[Pt,Ss,Ds,Es,So,Do,Cs,Is]}]}},{type:"subcategory",key:Eo,category:ie,properties:{title:Eo,icon:"code-branch",sections:[{key:"popular",title:t.baseText("nodeCreator.sectionNames.popular"),items:[bo,Ps,Os,To]}]}},{type:"subcategory",key:Co,category:ie,properties:{title:Co,icon:"file-alt",sections:[{key:"popular",title:t.baseText("nodeCreator.sectionNames.popular"),items:[Do,So]}]}},{type:"subcategory",key:Io,category:ie,properties:{title:Io,icon:"toolbox",sections:[{key:"popular",title:t.baseText("nodeCreator.sectionNames.popular"),items:[$s,Ce,ko]}]}}]};return(e??[]).some(s=>{var i,a;return(a=(i=s.codex)==null?void 0:i.categories)==null?void 0:a.includes(Vt)})&&o.items.push({key:ct,type:"view",properties:{title:t.baseText("nodeCreator.aiPanel.langchainAiNodes"),icon:"robot",description:t.baseText("nodeCreator.aiPanel.nodesForAi"),tag:t.baseText("nodeCreator.aiPanel.newTag")}}),o.items.push({key:Ue,type:"view",properties:{title:t.baseText("nodeCreator.triggerHelperPanel.addAnotherTrigger"),icon:"bolt",description:t.baseText("nodeCreator.triggerHelperPanel.addAnotherTriggerDescription")}}),o}const hh="data-keyboard-nav-id",sn=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Enter","Escape","Tab"],ph=Ut("nodeCreatorKeyboardNavigation",()=>{const e=H([]),t=H(null),o=H({});function n(u){return u==null?void 0:u.getAttribute("data-keyboard-nav-type")}function s(u){return(u==null?void 0:u.getAttribute(hh))||void 0}async function i(){return await new Promise(u=>{N(),setTimeout(()=>{e.value=Array.from(document.querySelectorAll("[data-keyboard-nav-type]")).map(k=>new WeakRef(k)),u()},0)})}function a(u,k){Object.values(o.value).filter(M=>M.keyboardKeys.includes(u)).forEach(M=>{if(!t.value)return;(M.condition===void 0||M.condition(n(k)||"",t.value))&&t.value&&M.handler(t.value,u)})}async function r(u){var A,O,W;const k=u.key;if(!sn.includes(k))return;u.preventDefault(),u.stopPropagation(),await i();const v=e.value.findIndex(V=>s(V==null?void 0:V.deref())===t.value),$=(A=e.value[v])==null?void 0:A.deref(),M=k==="ArrowDown",R=k==="ArrowUp";if($){if(M){const V=v<e.value.length-1?v+1:0;d((O=e.value[V])==null?void 0:O.deref())}if(R){const V=v>0?v-1:e.value.length-1;d((W=e.value[V])==null?void 0:W.deref())}a(k,$)}}function l(u){t.value=u}function d(u){const k=s(u);k&&(l(k),u!=null&&u.scrollIntoView&&(u==null||u.scrollIntoView({block:"center"})))}async function h(u){var k;await i(),d((k=e.value[u])==null?void 0:k.deref())}function p(){document.addEventListener("keydown",r,{capture:!0})}function w(){N(),document.removeEventListener("keydown",r,{capture:!0})}function f(u,k){k.keyboardKeys.forEach(v=>{if(sn.includes(v))o.value={...o.value,[u]:k};else throw new Error(`Key ${v} is not supported`)})}function N(){e.value=[]}function E(){return e.value.findIndex(u=>s(u==null?void 0:u.deref())===t.value)}return{activeItemId:t,attachKeydownEvent:p,refreshSelectableItems:i,detachKeydownEvent:w,registerKeyHook:f,getActiveItemIndex:E,setActiveItemId:l,setActiveItemIndex:h}}),fh=Ut("nodeCreatorViewStacks",()=>{const e=ft(),{getActiveItemIndex:t}=ph(),o=H([]),n=K(()=>{const u=o.value[o.value.length-1];if(!(u!=null&&u.baselineItems))return u.items?p(u.items):[];if(u.search&&a.value){const k=a.value.length>0?a.value:on(u.baselineItems??[]);return p(tn(u.search||"",k))}return p(u.baselineItems)}),s=K(()=>{const u=o.value[o.value.length-1];if(!u)return{};const k=on(u.baselineItems??[]);return{...u,items:n.value,hasSearch:k.length>8||(u==null?void 0:u.hasSearch)}}),i=K(()=>s.value.mode||Ue),a=K(()=>{const u=o.value[o.value.length-1];return u!=null&&u.searchItems?u.searchItems.map(k=>qe(k,u.subcategory)):[]}),r=K(()=>{const u=o.value[o.value.length-1];if(!(u!=null&&u.search))return[];const k=e.mergedNodes.map($=>qe($));return p(tn(u.search||"",k)).filter($=>!n.value.find(M=>M.key===$.key))}),l=K(()=>th(e.mergedNodes));async function d(u,k,v){var A;const $=ge();let M,R;k===!0?(M=j().visibleNodeTypesByInputConnectionTypeNames,R={properties:{title:$.baseText("nodeCreator.aiPanel.aiNodes"),icon:"robot"}}):(M=j().visibleNodeTypesByOutputConnectionTypeNames,R=ch().items.find(O=>O.properties.connectionType===u)),await Cn(),w({title:R==null?void 0:R.properties.title,rootView:Bt,mode:"nodes",items:e.allNodeCreatorNodes,nodeIcon:{iconType:"icon",icon:R==null?void 0:R.properties.icon,color:(A=R==null?void 0:R.properties.iconProps)==null?void 0:A.color},panelClass:R==null?void 0:R.properties.panelClass,baseFilter:O=>{var V;if(O.key===As)return!1;const W=M[u].includes(O.key);return W&&((V=v==null?void 0:v.nodes)!=null&&V.length)?v.nodes.includes(O.key):W},itemsMapper(O){return{...O,subcategory:u}},preventBack:!0})}function h(){const u=o.value[o.value.length-1];if(!u||!s.value.uuid)return;let k=(u==null?void 0:u.items)??[];if(!(u!=null&&u.items)){const v=(u==null?void 0:u.subcategory)??Xe,$=l.value[v],M=u.sections;M?k=oh($,M):k=$}if((u.forceIncludeNodes??[]).length>0){const v=e.mergedNodes.filter($=>{var M;return(M=u.forceIncludeNodes)==null?void 0:M.includes($.name)}).map($=>qe($,u.subcategory));k.push(...v)}u.baseFilter&&(k=k.filter(u.baseFilter)),u.itemsMapper&&(k=k.map(u.itemsMapper)),u.items||(k=At(k)),N({baselineItems:k})}function p(u){return u.map(k=>({...k,uuid:`${k.key}-${he()}`}))}function w(u){s.value.uuid&&N({activeIndex:t()});const k=he();o.value.push({...u,uuid:k,transitionDirection:"in",activeIndex:0}),h()}function f(){s.value.uuid&&(o.value.pop(),N({transitionDirection:"out"}))}function N(u){const k=o.value[o.value.length-1],v=o.value.findIndex($=>$.uuid===k.uuid);k&&Object.keys(u).forEach($=>{const M=$;o.value[v]={...o.value[v],[$]:u[M]}})}function E(){o.value=[]}return{viewStacks:o,activeViewStack:s,activeViewStackMode:i,globalSearchItemsDiff:r,gotoCompatibleConnectionView:d,resetViewStacks:E,updateCurrentViewStack:N,pushViewStack:w,popViewStack:f}});function gh(e,t={}){const o=le(),n=H([0,0]),s=ke();function i(d){const h=o.nodeViewOffsetPosition,[p,w]=ht(d),f=h[0]+(p-n.value[0]),N=h[1]+(w-n.value[1]);return o.nodeViewOffsetPosition=[f,N],n.value=[p,w],[f,N]}function a(d,h){if(!(s.isCtrlKeyPressed(d)||h)||o.isActionActive("dragActive"))return;d.button!==Ms.MIDDLE&&(o.nodeViewMoveInProgress=!0);const[p,w]=ht(d);n.value=[p,w];const f=B(e);f==null||f.addEventListener("mousemove",l)}function r(d){if(!o.nodeViewMoveInProgress)return;const h=B(e);h==null||h.removeEventListener("mousemove",l),o.nodeViewMoveInProgress=!1}function l(d){const h=B(e);if(!(d.target&&!(h===d.target||h!=null&&h.contains(d.target)))&&!o.isActionActive("dragActive")){if(d.buttons===Po.MIDDLE&&(o.nodeViewMoveInProgress=!0),d.buttons===Po.NONE){const p=B(t.onMouseMoveEnd);p==null||p(d);return}i(d)}}return{moveLastPosition:n,onMouseDown:a,onMouseUp:r,onMouseMove:l,panCanvas:i}}const mh=Se(async()=>await Te(()=>import("./NodeCreation-q-9Zw2Lt.js").then(e=>e.N),__vite__mapDeps([48,2,3,4,5,6,7,8,1,9,10,11,12,13,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,49]))),yh=Se(async()=>await Te(()=>import("./CanvasControls-uNKmu1Mm.js"),__vite__mapDeps([50,1,2,3,4,5,6,7,8,9,10,11,12,13,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,51]))),wh=Se(async()=>await Te(()=>import("./SetupWorkflowCredentialsButton-YRXUCIqW.js"),__vite__mapDeps([52,2,3,4,5,6,7,8,1,9,10,11,12,13,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]))),vh=x({name:"NodeView",components:{NodeDetailsView:tc,Node:Mc,Sticky:zc,CanvasAddButton:uh,KeyboardShortcutTooltip:ai,NodeCreation:mh,CanvasControls:yh,ContextMenu:rc,SetupWorkflowCredentialsButton:wh},mixins:[Oe,pt],async beforeRouteLeave(e,t,o){if(ot(e)===He.EXECUTIONS||t.name===F.TEMPLATE_IMPORT||ot(e)===He.WORKFLOW&&t.name===F.EXECUTION_DEBUG){o();return}if(this.uiStore.stateIsDirty&&!this.readOnlyEnv){const n=await this.confirm(this.$locale.baseText("generic.unsavedWork.confirmMessage.message"),{title:this.$locale.baseText("generic.unsavedWork.confirmMessage.headline"),type:"warning",confirmButtonText:this.$locale.baseText("generic.unsavedWork.confirmMessage.confirmButtonText"),cancelButtonText:this.$locale.baseText("generic.unsavedWork.confirmMessage.cancelButtonText"),showClose:!0});n===Ve?(this.workflowsStore.setWorkflowId(Fe),await this.saveCurrentWorkflow({},!1)&&await this.settingsStore.fetchPromptsData(),this.uiStore.stateIsDirty=!1,t.name===F.NEW_WORKFLOW?await this.$router.replace({name:F.WORKFLOW,params:{name:this.currentWorkflow}},()=>{this.$router.push(e)}):(this.collaborationStore.notifyWorkflowClosed(this.currentWorkflow),o())):n===Ws&&(this.collaborationStore.notifyWorkflowClosed(this.currentWorkflow),this.workflowsStore.setWorkflowId(Fe),this.resetWorkspace(),this.uiStore.stateIsDirty=!1,o())}else this.collaborationStore.notifyWorkflowClosed(this.currentWorkflow),o()},setup(e,t){var k,v;const o=H(null),n=H(null),s=H(null),i=q(),a=be(),r=ge(),l=Qe(),d=yn(),h=xe(),p=Ht(),{activeNode:w}=mt(i),f=Ne(w),N=ke(),{callDebounced:E}=Mt(),u=gh(o,{onMouseMoveEnd:s});return{locale:r,contextMenu:l,dataSchema:d,nodeHelpers:h,externalHooks:a,clipboard:p,pinnedData:f,deviceSupport:N,canvasPanning:u,nodeViewRootRef:o,nodeViewRef:n,onMouseMoveEnd:s,callDebounced:E,...Gi(),...ri(),...Vs(),...Le(),...Ft(),...Ji(),...Hi(),...(v=(k=pt).setup)==null?void 0:v.call(k,e,t)}},watch:{async $route(e,t){this.readOnlyEnvRouteCheck();const o=ot(e),n=!this.uiStore.nodeViewInitialized;let s=t.params.name!==e.params.name&&!(t.params.name==="new"&&this.currentWorkflow===Fe)&&t.name!==F.NEW_WORKFLOW&&e.params.action!=="workflowSave";const i=e.name===F.TEMPLATE_IMPORT;if(o===He.WORKFLOW||i){if(s||n||i){if(this.canvasStore.startLoading(),n){const a=this.uiStore.stateIsDirty;this.resetWorkspace(),this.uiStore.stateIsDirty=a}await Promise.all([this.loadCredentials(),this.initView()]),this.canvasStore.stopLoading(),this.blankRedirect&&(this.blankRedirect=!1)}await this.checkAndInitDebugMode()}o===He.EXECUTIONS&&(s=t.params.name!==e.params.name&&!(e.params.name==="new"&&t.params.name===void 0),s&&(this.uiStore.nodeViewInitialized=!1))},activeNode(){this.createNodeActive=!1},containsTrigger(e){e===!1&&this.canvasStore.setRecenteredCanvasAddButtonPosition(this.getNodeViewOffsetPosition)},nodeViewScale(e){const t=this.nodeViewRef;t&&(t.style.transform=`scale(${e})`)}},errorCaptured:(e,t,o)=>{console.error("errorCaptured"),console.error(e)},computed:{...G(xt,ci,cn,ft,j,q,un,fn,ui,le,z,Bs,ft,di,wn,zt,li,ji,Ki,Lt),nativelyNumberSuffixedDefaults(){return this.nodeTypesStore.nativelyNumberSuffixedDefaults},currentUser(){return this.usersStore.currentUser},activeNode(){return this.ndvStore.activeNode},executionWaitingForWebhook(){return this.workflowsStore.executionWaitingForWebhook},isDemo(){return this.$route.name===F.DEMO},showCanvasAddButton(){return!this.isLoading&&!this.containsTrigger&&!this.isDemo&&!this.readOnlyEnv},lastSelectedNode(){return this.uiStore.getLastSelectedNode},nodes(){return this.workflowsStore.allNodes},nodesToRender(){return this.workflowsStore.allNodes.filter(e=>e.type!==se)},stickiesToRender(){return this.workflowsStore.allNodes.filter(e=>e.type===se)},runButtonText(){return this.workflowRunning?this.executionWaitingForWebhook?this.$locale.baseText("nodeView.runButtonText.waitingForTriggerEvent"):this.$locale.baseText("nodeView.runButtonText.executingWorkflow"):this.$locale.baseText("nodeView.runButtonText.executeWorkflow")},workflowStyle(){const e=this.uiStore.nodeViewOffsetPosition;return{left:e[0]+"px",top:e[1]+"px"}},canvasAddButtonStyle(){return{"pointer-events":this.createNodeActive?"none":"all"}},backgroundStyle(){return hi(this.nodeViewScale,this.uiStore.nodeViewOffsetPosition,this.isExecutionPreview)},workflowClasses(){const e=[];return(this.ctrlKeyPressed||this.moveCanvasKeyPressed)&&(this.uiStore.nodeViewMoveInProgress?e.push("move-in-process"):e.push("move-active")),(this.selectActive||this.ctrlKeyPressed||this.moveCanvasKeyPressed)&&e.push("do-not-select"),this.connectionDragScope.type&&(e.push("connection-drag-scope-active"),e.push(`connection-drag-scope-active-type-${this.connectionDragScope.type}`),e.push(`connection-drag-scope-active-connection-${this.connectionDragScope.connection}`)),e},workflowExecution(){return this.workflowsStore.getWorkflowExecution},workflowRunning(){return this.uiStore.isActionActive("workflowRunning")},currentWorkflow(){return this.$route.params.name||this.workflowsStore.workflowId},workflowName(){return this.workflowsStore.workflowName},allTriggersDisabled(){return this.triggerNodes.filter(t=>t.disabled).length===this.triggerNodes.length},triggerNodes(){return this.nodes.filter(e=>e.type===Wt||this.nodeTypesStore.isTriggerNode(e.type))},containsTrigger(){return this.triggerNodes.length>0},containsChatNodes(){return!this.executionWaitingForWebhook&&!!this.nodes.find(e=>[Us,Ge].includes(e.type)&&e.disabled!==!0)},isManualChatOnly(){return this.containsChatNodes&&this.triggerNodes.length===1},isExecutionDisabled(){return!this.containsTrigger||this.allTriggersDisabled},getNodeViewOffsetPosition(){return this.uiStore.nodeViewOffsetPosition},nodeViewScale(){return this.canvasStore.nodeViewScale},instance(){return this.canvasStore.jsPlumbInstance},isLoading(){return this.canvasStore.isLoading},currentWorkflowObject(){return this.workflowsStore.getCurrentWorkflow()},readOnlyEnv(){return this.sourceControlStore.preferences.branchReadOnly},isReadOnlyRoute(){var e,t;return((t=(e=this.$route)==null?void 0:e.meta)==null?void 0:t.readOnlyCanvas)===!0}},data(){return{GRID_SIZE:nt,STICKY_NODE_TYPE:se,createNodeActive:!1,lastClickPosition:[450,450],ctrlKeyPressed:!1,moveCanvasKeyPressed:!1,stopExecutionInProgress:!1,blankRedirect:!1,credentialsUpdated:!1,pullConnActiveNodeName:null,pullConnActive:!1,dropPrevented:!1,connectionDragScope:{type:null,connection:null},renamingActive:!1,showStickyButton:!1,isExecutionPreview:!1,showTriggerMissingTooltip:!1,workflowData:null,activeConnection:null,isInsertingNodes:!1,isProductionExecutionPreview:!1,enterTimer:void 0,exitTimer:void 0,readOnlyNotification:null,suspendRecordingDetachedConnections:!1,NODE_CREATOR_OPEN_SOURCES:ue,eventsAttached:!1,unloadTimeout:void 0,canOpenNDV:!0,hideNodeIssues:!1}},async mounted(){var t;this.onMouseMoveEnd=this.mouseUp,this.resetWorkspace(),this.canvasStore.initInstance(this.nodeViewRef),this.titleReset(),window.addEventListener("message",this.onPostMessageReceived),this.clipboard.onPaste.value=this.onClipboardPasteEvent,this.canvasStore.startLoading();const e=[this.loadActiveWorkflows(),this.loadCredentials(),this.loadCredentialTypes(),this.loadVariables(),this.loadSecrets()];this.nodeTypesStore.allNodeTypes.length===0&&e.push(this.loadNodeTypes());try{await Promise.all(e)}catch(o){this.showError(o,this.$locale.baseText("nodeView.showError.mounted1.title"),this.$locale.baseText("nodeView.showError.mounted1.message")+":");return}if(qi(async()=>{try{try{this.bindCanvasEvents()}catch{}await this.initView(),window.parent&&window.parent.postMessage(JSON.stringify({command:"n8nReady",version:this.rootStore.versionCli}),"*")}catch(o){this.showError(o,this.$locale.baseText("nodeView.showError.mounted2.title"),this.$locale.baseText("nodeView.showError.mounted2.message")+":")}this.canvasStore.stopLoading(),setTimeout(()=>{this.usersStore.showPersonalizationSurvey(),this.addPinDataConnections(this.workflowsStore.pinnedWorkflowData||{})},0)}),this.externalHooks.run("nodeView.mount").catch(o=>{}),((t=this.currentUser)==null?void 0:t.personalizationAnswers)!==null&&this.settingsStore.onboardingCallPromptEnabled&&this.currentUser&&Ls(this.currentUser)<=xs){const o=await this.uiStore.getNextOnboardingPrompt(),n=o.toast_sequence_number===1?Hs:1e3;o.title&&o.description&&setTimeout(async()=>{this.showToast({type:"info",title:o.title,message:o.description,duration:0,customClass:"clickable",closeOnClick:!0,onClick:()=>{this.$telemetry.track("user clicked onboarding toast",{seq_num:o.toast_sequence_number,title:o.title,description:o.description}),this.uiStore.openModal(Fs)}})},n)}Ao.on("pull",this.onSourceControlPull),this.registerCustomAction({key:"openNodeDetail",action:({node:o})=>{this.nodeSelectedByName(o,!0)}}),this.registerCustomAction({key:"openSelectiveNodeCreator",action:async({connectiontype:o,node:n,creatorview:s})=>{const i=n??this.ndvStore.activeNodeName,a=i?this.workflowsStore.getNodeByName(i):null;this.ndvStore.activeNodeName=null,await this.redrawNode(n),setTimeout(()=>{s?this.onToggleNodeCreator({createNodeActive:!0,nodeCreatorView:s}):o&&a&&this.insertNodeAfterSelected({index:0,endpointUuid:`${a.id}-input${o}0`,eventSource:ue.NOTICE_ERROR_MESSAGE,outputType:o,sourceId:a.id})},0)}}),this.readOnlyEnvRouteCheck(),this.canvasStore.isDemo=this.isDemo},activated(){this.uiStore.addFirstStepOnLoad&&this.showTriggerCreator(ue.TRIGGER_PLACEHOLDER_BUTTON),this.uiStore.addFirstStepOnLoad=!1,this.bindCanvasEvents(),document.addEventListener("keydown",this.keyDown),document.addEventListener("keyup",this.keyUp),window.addEventListener("message",this.onPostMessageReceived),window.addEventListener("pageshow",this.onPageShow),X.on("newWorkflow",this.newWorkflow),X.on("importWorkflowData",this.onImportWorkflowDataEvent),X.on("importWorkflowUrl",this.onImportWorkflowUrlEvent),X.on("openChat",this.onOpenChat),ee.on("nodeMove",this.onMoveNode),ee.on("revertAddNode",this.onRevertAddNode),ee.on("revertRemoveNode",this.onRevertRemoveNode),ee.on("revertAddConnection",this.onRevertAddConnection),ee.on("revertRemoveConnection",this.onRevertRemoveConnection),ee.on("revertRenameNode",this.onRevertNameChange),ee.on("enableNodeToggle",this.onRevertEnableToggle),ye.on("pin-data",this.addPinDataConnections),ye.on("unpin-data",this.removePinDataConnections),X.on("saveWorkflow",this.saveCurrentWorkflowExternal),this.canvasStore.isDemo=this.isDemo},deactivated(){this.unbindCanvasEvents(),document.removeEventListener("keydown",this.keyDown),document.removeEventListener("keyup",this.keyUp),window.removeEventListener("message",this.onPostMessageReceived),window.removeEventListener("beforeunload",this.onBeforeUnload),window.removeEventListener("pageshow",this.onPageShow),X.off("newWorkflow",this.newWorkflow),X.off("importWorkflowData",this.onImportWorkflowDataEvent),X.off("importWorkflowUrl",this.onImportWorkflowUrlEvent),X.off("openChat",this.onOpenChat),ee.off("nodeMove",this.onMoveNode),ee.off("revertAddNode",this.onRevertAddNode),ee.off("revertRemoveNode",this.onRevertRemoveNode),ee.off("revertAddConnection",this.onRevertAddConnection),ee.off("revertRemoveConnection",this.onRevertRemoveConnection),ee.off("revertRenameNode",this.onRevertNameChange),ee.off("enableNodeToggle",this.onRevertEnableToggle),ye.off("pin-data",this.addPinDataConnections),ye.off("unpin-data",this.removePinDataConnections),X.off("saveWorkflow",this.saveCurrentWorkflowExternal)},beforeMount(){this.isDemo||this.pushStore.pushConnect()},beforeUnmount(){document.removeEventListener("keydown",this.keyDown),document.removeEventListener("keyup",this.keyUp),this.unregisterCustomAction("showNodeCreator"),this.unregisterCustomAction("openNodeDetail"),this.unregisterCustomAction("openSelectiveNodeCreator"),this.isDemo||this.pushStore.pushDisconnect(),this.resetWorkspace(),this.instance.unbind(),this.instance.destroy(),this.uiStore.stateIsDirty=!1,window.removeEventListener("message",this.onPostMessageReceived),X.off("newWorkflow",this.newWorkflow),X.off("importWorkflowData",this.onImportWorkflowDataEvent),X.off("importWorkflowUrl",this.onImportWorkflowUrlEvent),this.workflowsStore.setWorkflowId(Fe),Ao.off("pull",this.onSourceControlPull)},methods:{editAllowedCheck(){var e;if(!((e=this.readOnlyNotification)!=null&&e.visible))return this.isReadOnlyRoute||this.readOnlyEnv?(this.readOnlyNotification=this.showMessage({title:this.$locale.baseText(this.readOnlyEnv?`readOnlyEnv.showMessage.${this.isReadOnlyRoute?"executions":"workflows"}.title`:"readOnly.showMessage.executions.title"),message:this.$locale.baseText(this.readOnlyEnv?`readOnlyEnv.showMessage.${this.isReadOnlyRoute?"executions":"workflows"}.message`:"readOnly.showMessage.executions.message"),type:"info",dangerouslyUseHTMLString:!0}),!1):!0},showTriggerMissingToltip(e){this.showTriggerMissingTooltip=e},onRunNode(e,t){const o=this.workflowsStore.getNodeByName(e),n={node_type:o?o.type:null,workflow_id:this.workflowsStore.workflowId,source:"canvas",session_id:this.ndvStore.sessionId};this.$telemetry.track("User clicked execute node button",n),this.externalHooks.run("nodeView.onRunNode",n),this.runWorkflow({destinationNode:e,source:t})},async onOpenChat(){const e={workflow_id:this.workflowsStore.workflowId};this.$telemetry.track("User clicked chat open button",e),this.externalHooks.run("nodeView.onOpenChat",e),this.uiStore.openModal(zs)},async onRunWorkflow(){this.getWorkflowDataToSave().then(e=>{const t={workflow_id:this.workflowsStore.workflowId,node_graph_string:JSON.stringify(kt(e,this.getNodeTypes()).nodeGraph)};this.$telemetry.track("User clicked execute workflow button",t),this.externalHooks.run("nodeView.onRunWorkflow",t)}),await this.runWorkflow({}),this.refreshEndpointsErrorsState()},resetEndpointsErrors(){Object.values(this.instance.getManagedElements()).flatMap(t=>t.endpoints).filter(t=>(t==null?void 0:t.endpoint.type)===pi).forEach(t=>{const o=t==null?void 0:t.endpoint;o&&((t==null?void 0:t.connections)??[]).length>0&&o.resetError()})},refreshEndpointsErrorsState(){const e=this.workflowsStore.allNodes.filter(t=>t.issues);this.resetEndpointsErrors(),e.forEach(t=>{var s;const o=this.instance.getManagedElement(t.id),n=this.instance.getEndpoints(o);Object.keys(((s=t==null?void 0:t.issues)==null?void 0:s.input)??{}).forEach(i=>{n.filter(r=>r._defaultType.scope===i).forEach(r=>{const l=r==null?void 0:r.endpoint;l&&l.setError()})})})},onRunContainerClick(){if(this.containsTrigger&&!this.allTriggersDisabled)return;const e=this.containsTrigger&&this.allTriggersDisabled?this.$locale.baseText("nodeView.addOrEnableTriggerNode"):this.$locale.baseText("nodeView.addATriggerNodeFirst");this.registerCustomAction({key:"showNodeCreator",action:()=>this.showTriggerCreator(ue.NO_TRIGGER_EXECUTION_TOOLTIP)});const t=this.showMessage({type:"info",title:this.$locale.baseText("nodeView.cantExecuteNoTrigger"),message:e,duration:3e3,onClick:()=>setTimeout(()=>{this.createNodeActive&&t.close()},0),dangerouslyUseHTMLString:!0})},clearExecutionData(){this.workflowsStore.workflowExecutionData=null,this.nodeHelpers.updateNodesExecutionIssues()},async onSaveKeyboardShortcut(e){let t=await this.saveCurrentWorkflow();t&&(await this.settingsStore.fetchPromptsData(),this.$route.name===F.EXECUTION_DEBUG&&await this.$router.replace({name:F.WORKFLOW,params:{name:this.currentWorkflow}})),this.activeNode&&(e.target instanceof HTMLInputElement?t=e.target.readOnly:t=!0,t&&this.showMessage({title:this.$locale.baseText("generic.workflowSaved"),type:"success"}))},showTriggerCreator(e){this.createNodeActive||(this.nodeCreatorStore.setSelectedView(Ue),this.nodeCreatorStore.setShowScrim(!0),this.onToggleNodeCreator({source:e,createNodeActive:!0}))},async openExecution(e){var o,n;this.canvasStore.startLoading(),this.resetWorkspace();let t;try{t=await this.workflowsStore.getExecution(e)}catch(s){this.showError(s,this.$locale.baseText("nodeView.showError.openExecution.title"));return}if(t===void 0)throw new Error(`Execution with id "${e}" could not be found!`);if(this.workflowsStore.setWorkflowName({newName:t.workflowData.name,setStateDirty:!1}),this.workflowsStore.setWorkflowId(Fe),this.workflowsStore.setWorkflowExecutionData(t),t.workflowData.pinData&&this.workflowsStore.setWorkflowPinData(t.workflowData.pinData),t.workflowData.ownedBy&&this.workflowsEEStore.setWorkflowOwnedBy({workflowId:t.workflowData.id,ownedBy:t.workflowData.ownedBy}),t.workflowData.sharedWith&&this.workflowsEEStore.setWorkflowSharedWith({workflowId:t.workflowData.id,sharedWith:t.workflowData.sharedWith}),t.workflowData.usedCredentials&&this.workflowsStore.setUsedCredentials(t.workflowData.usedCredentials),await this.addNodes(Ee(t.workflowData.nodes),Ee(t.workflowData.connections)),await this.$nextTick(),this.canvasStore.zoomToFit(),this.uiStore.stateIsDirty=!1,this.externalHooks.run("execution.open",{workflowId:t.workflowData.id,workflowName:t.workflowData.name,executionId:e}),this.$telemetry.track("User opened read-only execution",{workflow_id:t.workflowData.id,execution_mode:t.mode,execution_finished:t.finished}),!t.finished&&((n=(o=t.data)==null?void 0:o.resultData)!=null&&n.error)){let s=!1;if(t.data.resultData.runData){const i=t.data.resultData.runData;e:for(const a of Object.keys(i))for(const r of i[a])if(r.error){s=!0;break e}}!s&&t.data.resultData.error.stack&&(console.error(`Execution ${e} error:`),console.error(t.data.resultData.error.stack),this.showMessage({title:this.$locale.baseText("nodeView.showError.workflowError"),message:t.data.resultData.error.message,type:"error",duration:0}))}t.waitTill&&this.showMessage({title:this.$locale.baseText("nodeView.thisExecutionHasntFinishedYet"),message:`<a data-action="reload">${this.$locale.baseText("nodeView.refresh")}</a> ${this.$locale.baseText("nodeView.toSeeTheLatestStatus")}.<br/> <a href="https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.wait/" target="_blank">${this.$locale.baseText("nodeView.moreInfo")}</a>`,type:"warning",duration:0}),this.canvasStore.stopLoading()},async importWorkflowExact(e){if(!e.workflow.nodes||!e.workflow.connections)throw new Error("Invalid workflow object");this.resetWorkspace(),e.workflow.nodes=fi(e.workflow.nodes),await this.addNodes(e.workflow.nodes,e.workflow.connections),e.workflow.pinData&&this.workflowsStore.setWorkflowPinData(e.workflow.pinData),await this.$nextTick(),this.canvasStore.zoomToFit()},async openWorkflowTemplate(e){this.canvasStore.startLoading(),this.canvasStore.setLoadingText(this.$locale.baseText("nodeView.loadingTemplate")),this.resetWorkspace(),this.workflowsStore.currentWorkflowExecutions=[],this.workflowsStore.activeWorkflowExecution=null;let t;try{if(this.externalHooks.run("template.requested",{templateId:e}),t=await this.templatesStore.getFixedWorkflowTemplate(e),!t)throw new Error(this.$locale.baseText("nodeView.workflowTemplateWithIdCouldNotBeFound",{interpolate:{templateId:e}}))}catch(o){this.showError(o,this.$locale.baseText("nodeView.couldntImportWorkflow")),await this.$router.replace({name:F.NEW_WORKFLOW});return}this.$telemetry.track("User inserted workflow template",{source:"workflow",template_id:Ys(e),wf_template_repo_session_id:this.templatesStore.previousSessionId},{withPostHog:!0}),this.blankRedirect=!0,await this.$router.replace({name:F.NEW_WORKFLOW,query:{templateId:e}}),await this.addNodes(t.workflow.nodes,t.workflow.connections),this.workflowData=await this.workflowsStore.getNewWorkflowData(t.name)||{},this.workflowsStore.addToWorkflowMetadata({templateId:e}),await this.$nextTick(),this.canvasStore.zoomToFit(),this.uiStore.stateIsDirty=!0,this.externalHooks.run("template.open",{templateId:e,templateName:t.name,workflow:t.workflow}),this.canvasStore.stopLoading()},async openWorkflow(e){this.canvasStore.startLoading();const t=this.workflowsStore.activeWorkflowExecution;this.resetWorkspace(),this.workflowsStore.addWorkflow(e),this.workflowsStore.setActive(e.active||!1),this.workflowsStore.setWorkflowId(e.id),this.workflowsStore.setWorkflowName({newName:e.name,setStateDirty:!1}),this.workflowsStore.setWorkflowSettings(e.settings||{}),this.workflowsStore.setWorkflowPinData(e.pinData||{}),this.workflowsStore.setWorkflowVersionId(e.versionId),this.workflowsStore.setWorkflowMetadata(e.meta),e.ownedBy&&this.workflowsEEStore.setWorkflowOwnedBy({workflowId:e.id,ownedBy:e.ownedBy}),e.sharedWith&&this.workflowsEEStore.setWorkflowSharedWith({workflowId:e.id,sharedWith:e.sharedWith}),e.usedCredentials&&this.workflowsStore.setUsedCredentials(e.usedCredentials);const o=e.tags||[],n=o.map(s=>s.id);this.workflowsStore.setWorkflowTagIds(n||[]),this.tagsStore.upsertTags(o),await this.addNodes(e.nodes,e.connections),this.credentialsUpdated||(this.uiStore.stateIsDirty=!1),this.canvasStore.zoomToFit(),this.externalHooks.run("workflow.open",{workflowId:e.id,workflowName:e.name}),(t==null?void 0:t.workflowId)!==e.id?(this.workflowsStore.activeWorkflowExecution=null,this.workflowsStore.currentWorkflowExecutions=[]):this.workflowsStore.activeWorkflowExecution=t,this.canvasStore.stopLoading(),this.collaborationStore.notifyWorkflowOpened(e.id)},touchTap(e){this.deviceSupport.isTouchDevice&&this.mouseDown(e)},mouseDown(e){this.lastClickPosition=this.getMousePositionWithinNodeView(e),e instanceof MouseEvent&&e.button===1&&(this.moveCanvasKeyPressed=!0),this.mouseDownMouseSelect(e,this.moveCanvasKeyPressed),this.canvasPanning.onMouseDown(e,this.moveCanvasKeyPressed),this.createNodeActive=!1},mouseUp(e){e.button===1&&(this.moveCanvasKeyPressed=!1),this.mouseUpMouseSelect(e),this.canvasPanning.onMouseUp(e)},keyUp(e){e.key===this.deviceSupport.controlKeyCode&&(this.ctrlKeyPressed=!1),e.key===" "&&(this.moveCanvasKeyPressed=!1)},async keyDown(e){this.contextMenu.close();const t=this.deviceSupport.isCtrlKeyPressed(e)&&!e.shiftKey&&!e.altKey,o=e.shiftKey&&!e.altKey&&!this.deviceSupport.isCtrlKeyPressed(e),n=this.deviceSupport.isCtrlKeyPressed(e)&&e.altKey&&!e.shiftKey,s=!this.deviceSupport.isCtrlKeyPressed(e)&&!e.shiftKey&&!e.altKey,i=this.isReadOnlyRoute||this.readOnlyEnv;if(e.key==="s"&&t&&!i){if(e.stopPropagation(),e.preventDefault(),this.isReadOnlyRoute||this.readOnlyEnv)return;this.callDebounced(this.onSaveKeyboardShortcut,{debounceTime:1e3},e);return}const a=e.path||e.composedPath&&e.composedPath();for(const l of a)if(l.className&&typeof l.className=="string"&&l.className.includes("ignore-key-press"))return;if(window.document.body.classList.contains("el-popup-parent--hidden"))return;if(e.key==="Escape"&&s){this.createNodeActive=!1,this.activeNode&&(this.externalHooks.run("dataDisplay.nodeEditingFinished"),this.ndvStore.activeNodeName=null);return}if(this.activeNode)return;const r=this.uiStore.getSelectedNodes.map(l=>l&&this.workflowsStore.getNodeByName(l.name)).filter(l=>!!l);if(e.key==="d"&&s&&!i)this.callDebounced(this.toggleActivationNodes,{debounceTime:350},r);else if(e.key==="d"&&t&&!i)r.length>0&&(e.preventDefault(),this.duplicateNodes(r));else if(e.key==="p"&&s&&!i)r.length>0&&(e.preventDefault(),this.togglePinNodes(r,"keyboard-shortcut"));else if((e.key==="Delete"||e.key==="Backspace")&&s&&!i)e.stopPropagation(),e.preventDefault(),this.callDebounced(this.deleteNodes,{debounceTime:500},r);else if(e.key==="Tab"&&s&&!i)this.onToggleNodeCreator({source:ue.TAB,createNodeActive:!this.createNodeActive&&!this.isReadOnlyRoute&&!this.readOnlyEnv});else if(e.key==="Enter"&&t&&!i)this.onRunWorkflow();else if(e.key==="S"&&o&&!i)this.onAddNodes({nodes:[{type:se}],connections:[]});else if(e.key===this.deviceSupport.controlKeyCode)this.ctrlKeyPressed=!0;else if(e.key===" ")this.moveCanvasKeyPressed=!0;else if(e.key==="F2"&&s&&!i){const l=this.lastSelectedNode;l!==null&&l.type!==se&&this.callDebounced(this.renameNodePrompt,{debounceTime:1500},l.name)}else if(e.key==="a"&&t)e.stopPropagation(),e.preventDefault(),this.callDebounced(this.selectAllNodes,{debounceTime:1e3});else if(e.key==="c"&&t)this.callDebounced(this.copyNodes,{debounceTime:1e3},r);else if(e.key==="x"&&t&&!i)e.stopPropagation(),e.preventDefault(),this.callDebounced(this.cutNodes,{debounceTime:1e3},r);else if(e.key==="n"&&n){if(e.stopPropagation(),e.preventDefault(),this.isDemo)return;this.$router.currentRoute.name===F.NEW_WORKFLOW?X.emit("newWorkflow"):this.$router.push({name:F.NEW_WORKFLOW}),this.showMessage({title:this.$locale.baseText("nodeView.showMessage.keyDown.title"),type:"success"})}else if(e.key==="Enter"&&s){const l=this.lastSelectedNode;if(l!==null){if(l.type===se&&(this.isReadOnlyRoute||this.readOnlyEnv))return;this.ndvStore.activeNodeName=l.name}}else if(e.key==="ArrowRight"&&o)e.stopPropagation(),e.preventDefault(),this.callDebounced(this.selectDownstreamNodes,{debounceTime:1e3});else if(e.key==="ArrowRight"&&s){const l=this.lastSelectedNode;if(l===null)return;const d=this.workflowsStore.outgoingConnectionsByNodeName(l.name);if(d.main===void 0||d.main.length===0)return;this.callDebounced(this.nodeSelectedByName,{debounceTime:100},d.main[0][0].node,!1,!0)}else if(e.key==="ArrowLeft"&&o)e.stopPropagation(),e.preventDefault(),this.callDebounced(this.selectUpstreamNodes,{debounceTime:1e3});else if(e.key==="ArrowLeft"&&s){const l=this.lastSelectedNode;if(l===null)return;const d=this.getCurrentWorkflow();if(!d.connectionsByDestinationNode.hasOwnProperty(l.name))return;const h=d.connectionsByDestinationNode[l.name];if(h.main===void 0||h.main.length===0)return;this.callDebounced(this.nodeSelectedByName,{debounceTime:100},h.main[0][0].node,!1,!0)}else if(["ArrowUp","ArrowDown"].includes(e.key)&&s){const l=this.lastSelectedNode;if(l===null)return;const d=this.getCurrentWorkflow();if(!d.connectionsByDestinationNode.hasOwnProperty(l.name))return;const h=d.connectionsByDestinationNode[l.name];if(!Array.isArray(h.main)||!h.main.length)return;const p=h.main[0][0].node,w=this.workflowsStore.outgoingConnectionsByNodeName(p);if(!Array.isArray(w.main)||!w.main.length)return;let f,N=e.key==="ArrowUp"?-99999999:99999999,E=null;for(const u of w.main)for(const k of u)k.node!==l.name&&(f=this.workflowsStore.getNodeByName(k.node),f&&(e.key==="ArrowUp"?f.position[1]<=l.position[1]&&f.position[1]>N&&(E=f.name,N=f.position[1]):f.position[1]>=l.position[1]&&f.position[1]<N&&(E=f.name,N=f.position[1])));E!==null&&this.callDebounced(this.nodeSelectedByName,{debounceTime:100},E,!1,!0)}},toggleActivationNodes(e){this.editAllowedCheck()&&this.nodeHelpers.disableNodes(e,!0)},togglePinNodes(e,t){if(!this.editAllowedCheck())return;this.historyStore.startRecordingUndo();const o=e.some(n=>!this.workflowsStore.pinDataByNodeName(n.name));for(const n of e){const s=Ne(n);if(o){const i=this.dataSchema.getInputDataWithPinned(n);i.length!==0&&s.setData(i,t)}else s.unsetData(t)}this.historyStore.stopRecordingUndo()},deleteNodes(e){this.historyStore.startRecordingUndo(),e.forEach(t=>{this.removeNode(t.name,!0,!1)}),setTimeout(()=>{this.historyStore.stopRecordingUndo()},200)},selectAllNodes(){this.nodes.forEach(e=>{this.nodeSelectedByName(e.name)})},selectUpstreamNodes(){const e=this.lastSelectedNode;if(e===null)return;this.deselectAllNodes();const t=this.getCurrentWorkflow(),o=this.getConnectedNodes("upstream",t,e.name);for(const n of o)this.nodeSelectedByName(n);this.nodeSelectedByName(e.name)},selectDownstreamNodes(){const e=this.lastSelectedNode;if(e===null)return;this.deselectAllNodes();const t=this.getCurrentWorkflow(),o=this.getConnectedNodes("downstream",t,e.name);for(const n of o)this.nodeSelectedByName(n);this.nodeSelectedByName(e.name)},pushDownstreamNodes(e,t,o=!1){const n=this.workflowsStore.nodesByName[e],s=this.getCurrentWorkflow(),i=this.getConnectedNodes("downstream",s,e);for(const a of i){const r=this.workflowsStore.nodesByName[a],l=r.position;if(r.position[0]<n.position[0])continue;const d={name:a,properties:{position:[r.position[0]+t,r.position[1]]}};this.workflowsStore.updateNodeProperties(d),this.onNodeMoved(r),(o&&l[0]!==d.properties.position[0]||l[1]!==d.properties.position[1])&&this.historyStore.pushCommandToUndo(new gi(a,l,d.properties.position),o)}},cutNodes(e){const t=!this.isReadOnlyRoute&&!this.readOnlyEnv;this.copyNodes(e,t),t&&this.deleteNodes(e)},copyNodes(e,t=!1){this.getNodesToSave(e).then(o=>{const n={meta:{...this.workflowsStore.workflow.meta??{},instanceId:this.rootStore.instanceId},...o};this.removeForeignCredentialsFromWorkflow(n,this.credentialsStore.allCredentials);const s=JSON.stringify(n,null,2);this.clipboard.copy(s),o.nodes.length>0&&(t||this.showMessage({title:"Copied!",message:"",type:"success"}),this.$telemetry.track("User copied nodes",{node_types:o.nodes.map(i=>i.type),workflow_id:this.workflowsStore.workflowId}))})},async stopExecution(){const e=this.workflowsStore.activeExecutionId;if(e!==null){try{this.stopExecutionInProgress=!0,await this.workflowsStore.stopCurrentExecution(e)}catch(t){const o=await this.workflowsStore.getExecution(e);if(o===void 0)this.workflowsStore.finishActiveExecution({executionId:e,data:{finished:!0,stoppedAt:new Date}}),this.workflowsStore.executingNode.length=0,this.uiStore.removeActiveAction("workflowRunning"),this.titleSet(this.workflowsStore.workflowName,"IDLE"),this.showMessage({title:this.$locale.baseText("nodeView.showMessage.stopExecutionCatch.unsaved.title"),message:this.$locale.baseText("nodeView.showMessage.stopExecutionCatch.unsaved.message"),type:"success"});else if(o!=null&&o.finished){const n={data:o.data,finished:o.finished,mode:o.mode,startedAt:o.startedAt,stoppedAt:o.stoppedAt},s={data:n,executionId:e,retryOf:o.retryOf};this.workflowsStore.finishActiveExecution(s),this.titleSet(o.workflowData.name,"IDLE"),this.workflowsStore.executingNode.length=0,this.workflowsStore.setWorkflowExecutionData(n),this.uiStore.removeActiveAction("workflowRunning"),this.showMessage({title:this.$locale.baseText("nodeView.showMessage.stopExecutionCatch.title"),message:this.$locale.baseText("nodeView.showMessage.stopExecutionCatch.message"),type:"success"})}else this.showError(t,this.$locale.baseText("nodeView.showError.stopExecution.title"))}this.stopExecutionInProgress=!1,this.getWorkflowDataToSave().then(t=>{const o={workflow_id:this.workflowsStore.workflowId,node_graph_string:JSON.stringify(kt(t,this.getNodeTypes()).nodeGraph)};this.$telemetry.track("User clicked stop workflow execution",o)})}},async stopWaitingForWebhook(){try{await this.workflowsStore.removeTestWebhook(this.workflowsStore.workflowId)}catch(e){this.showError(e,this.$locale.baseText("nodeView.showError.stopWaitingForWebhook.title"));return}},async onClipboardPasteEvent(e){if(this.readOnlyEnv)return;if(ot(this.$route)===He.WORKFLOW){let o;if(!this.editAllowedCheck())return;if(e.match(/^http[s]?:\/\/.*\.json$/i)){if(!this.editAllowedCheck()||await this.confirm(this.$locale.baseText("nodeView.confirmMessage.onClipboardPasteEvent.message",{interpolate:{plainTextData:e}}),this.$locale.baseText("nodeView.confirmMessage.onClipboardPasteEvent.headline"),{type:"warning",confirmButtonText:this.$locale.baseText("nodeView.confirmMessage.onClipboardPasteEvent.confirmButtonText"),cancelButtonText:this.$locale.baseText("nodeView.confirmMessage.onClipboardPasteEvent.cancelButtonText"),dangerouslyUseHTMLString:!0})!==Ve||(o=await this.getWorkflowDataFromUrl(e),o===void 0))return}else try{if(o=JSON.parse(e),!this.editAllowedCheck())return}catch{return}return await this.importWorkflowData(o,"paste",!1)}},async getWorkflowDataFromUrl(e){let t;this.canvasStore.startLoading();try{t=await this.workflowsStore.getWorkflowFromUrl(e)}catch(o){this.canvasStore.stopLoading(),this.showError(o,this.$locale.baseText("nodeView.showError.getWorkflowDataFromUrl.title"));return}return this.canvasStore.stopLoading(),t},async importWorkflowData(e,t,o=!0){if(!(!e.hasOwnProperty("nodes")||!e.hasOwnProperty("connections")))try{const n={};e.nodes&&e.nodes.forEach(l=>{if(l.webhookId&&Ks.includes(l.type)&&Object.values(this.getCurrentWorkflow().nodes).some(h=>h.webhookId===l.webhookId)&&(l.webhookId=he()),l.id){const d=he();n[d]=l.id,l.id=d}else l.id=he()}),this.removeUnknownCredentials(e);const s=this.rootStore.instanceId,i=JSON.stringify(kt(e,this.getNodeTypes(),{nodeIdMap:n,sourceInstanceId:e.meta&&e.meta.instanceId!==s?e.meta.instanceId:""}).nodeGraph);t==="paste"?this.$telemetry.track("User pasted nodes",{workflow_id:this.workflowsStore.workflowId,node_graph_string:i}):t==="duplicate"?this.$telemetry.track("User duplicated nodes",{workflow_id:this.workflowsStore.workflowId,node_graph_string:i}):this.$telemetry.track("User imported workflow",{source:t,workflow_id:this.workflowsStore.workflowId,node_graph_string:i}),this.deselectAllNodes(),this.updateNodePositions(e,_e(this.nodes,this.lastClickPosition));const a=await this.addNodesToWorkflow(e);setTimeout(()=>{a.nodes.forEach(l=>{this.nodeSelectedByName(l.name)})});const r=this.settingsStore.areTagsEnabled;if(o&&r&&Array.isArray(e.tags)){const l=await this.tagsStore.fetchAll(),d=new Set(l.map(N=>N.name)),h=e.tags,p=h.filter(N=>!d.has(N.name)),w=[];for(const N of p){const E=this.tagsStore.create(N.name).then(u=>(l.push(u),u));w.push(E)}await Promise.all(w);const f=h.reduce((N,E)=>{const u=l.find(k=>k.name===E.name);return u&&N.push(u.id),N},[]);this.workflowsStore.addWorkflowTagIds(f),setTimeout(()=>{this.addPinDataConnections(this.workflowsStore.pinnedWorkflowData||{})})}}catch(n){this.showError(n,this.$locale.baseText("nodeView.showError.importWorkflowData.title"))}},removeUnknownCredentials(e){if(e!=null&&e.nodes){for(const t of e.nodes)if(t.credentials)for(const[o,n]of Object.entries(t.credentials))n.id!==null&&(this.credentialsStore.getCredentialById(n.id)||delete t.credentials[o])}},onDragOver(e){e.preventDefault()},async onDrop(e){if(!e.dataTransfer)return;const t=gt(e.dataTransfer.getData(js));if(t){const o=this.getMousePositionWithinNodeView(e),n=[o[0]-Ye/2+nt,o[1]-Ye/2];await this.onAddNodes(t,!0,n),this.createNodeActive=!1}},nodeDeselectedByName(e){const t=this.workflowsStore.getNodeByName(e);t&&this.nodeDeselected(t)},nodeSelectedByName(e,t=!1,o){o===!0&&this.deselectAllNodes();const n=this.workflowsStore.getNodeByName(e);n&&(this.nodeSelected(n),this.uiStore.lastSelectedNode=n.name,this.uiStore.lastSelectedNodeOutputIndex=null,this.uiStore.lastSelectedNodeEndpointUuid=null,this.canvasStore.lastSelectedConnection=null,this.canvasStore.newNodeInsertPosition=null,t&&(this.ndvStore.activeNodeName=n.name))},showMaxNodeTypeError(e){const t=e.maxNodes;this.showMessage({title:this.$locale.baseText("nodeView.showMessage.showMaxNodeTypeError.title"),message:this.$locale.baseText("nodeView.showMessage.showMaxNodeTypeError.message",{adjustToNumber:t,interpolate:{nodeTypeDataDisplayName:e.displayName}}),type:"error",duration:0})},async getNewNodeWithDefaultCredential(e,t){var i,a,r,l;let o=e.defaultVersion;o===void 0&&(o=Array.isArray(e.version)?e.version.slice(-1)[0]:e.version);const n={id:he(),name:t.name??e.defaults.name,type:e.name,typeVersion:o,position:[0,0],parameters:{}},s=(i=e.credentials)==null?void 0:i.map(d=>this.credentialsStore.getUsableCredentialByType(d.name)).flat();if(s&&s.length===1){const d=s[0],h=this.credentialsStore.getCredentialById(d.id),p={id:h.id,name:h.name},w={[d.type]:p};await this.loadNodesProperties([n].map(E=>({name:E.type,version:E.typeVersion})));const f=this.nodeTypesStore.getNodeType(n.type,n.typeVersion),N=Be((f==null?void 0:f.properties)||[],{},!0,!1,n);if(e.credentials){const E=e.credentials.find(k=>k.name===d.type);if((a=E==null?void 0:E.displayOptions)!=null&&a.hide)return n;const u=(r=E==null?void 0:E.displayOptions)==null?void 0:r.show;if(!u)return n.credentials=w,n;if(Object.keys(u).length===1&&u.authentication){n.credentials=w;let k={};for(const v of Object.keys(u)){if(N&&!N[v]){k={},n.credentials=void 0;break}const $=(l=u[v])==null?void 0:l[0];$&&typeof $=="string"&&(k[v]=$),n.parameters={...n.parameters,...k}}}}}return n},async injectNode(e,t={},o=!0,n=!1,s=!1){var d,h;const i=this.nodeTypesStore.getNodeType(e);if(i===null){this.showMessage({title:this.$locale.baseText("nodeView.showMessage.addNodeButton.title"),message:this.$locale.baseText("nodeView.showMessage.addNodeButton.message",{interpolate:{nodeTypeName:e}}),type:"error"});return}if(i.maxNodes!==void 0&&this.getNodeTypeCount(e)>=i.maxNodes){this.showMaxNodeTypeError(i);return}const a=await this.getNewNodeWithDefaultCredential(i,{name:t.name}),r=this.lastSelectedNode;if(t.position)a.position=_e(this.canvasStore.getNodesWithPlaceholderNode(),t.position);else if(r){const p=this.canvasStore.lastSelectedConnection;if(p){const[w]=mi(p);w<=yi&&this.pushDownstreamNodes(r.name,Tt,n)}if(this.canvasStore.newNodeInsertPosition)a.position=_e(this.nodes,[this.canvasStore.newNodeInsertPosition[0]+nt,this.canvasStore.newNodeInsertPosition[1]-Ye/2]),this.canvasStore.newNodeInsertPosition=null;else{let w=0;const f=this.getCurrentWorkflow();if(p){const k=this.nodeTypesStore.getNodeType(r.type,r.typeVersion);if(k){const v=[[-100,100],[-140,0,140],[-240,-100,100,240]],$=ve(f,r,k),R=re($).filter(A=>A===_.Main);if(R.length>1){const A=v[R.length-2],O=p.__meta?p.__meta.sourceOutputIndex:0;w=A[O]}}}let N=[];try{N=ve(f,a,i)}catch{}const E=re(N),u=this.nodeTypesStore.getNodeType(r.type,r.typeVersion);if(E.length>0&&E.every(k=>k!==_.Main)){const k=f.getNode(r.name),v=pe(f,k,u),M=(re(v)||[]).filter(R=>R!==_.Main).findIndex(R=>N[0]===R);a.position=_e(this.nodes,[r.position[0]+Ye/(Math.max(((d=u==null?void 0:u.inputs)==null?void 0:d.length)??1),1)*M,r.position[1]+Tt],[100,0])}else{const k=pe(f,r,u),v=re(k);let $=Tt;v.find(M=>M!==_.Main)&&($+=150),a.position=_e(this.nodes,[r.position[0]+$,r.position[1]+w],[100,0])}}}else{const p=this.nodeTypesStore.isTriggerNode(e)&&!this.containsTrigger?this.canvasStore.canvasAddButtonPosition:this.lastClickPosition;a.position=_e(this.nodes,p)}const l=this.locale.localizeNodeName(a.name,a.type);if(a.name=this.uniqueNodeName(l),(h=i.webhooks)!=null&&h.length&&(a.webhookId=he()),await this.addNodes([a],void 0,n),this.workflowsStore.setNodePristine(a.name,!0),this.uiStore.stateIsDirty=!0,e===se)this.$telemetry.trackNodesPanel("nodeView.addSticky",{workflow_id:this.workflowsStore.workflowId});else{this.externalHooks.run("nodeView.addNodeButton",{nodeTypeName:e}),wi().trackAddedTrigger(e);const p={node_type:e,node_version:a.typeVersion,is_auto_add:s,workflow_id:this.workflowsStore.workflowId,drag_and_drop:t.dragAndDrop};r&&(p.input_node_type=r.type),this.$telemetry.trackNodesPanel("nodeView.addNodeButton",p)}return n&&(this.deselectAllNodes(),setTimeout(()=>{this.nodeSelectedByName(a.name,o&&e!==se)})),a},getConnection(e,t,o,n,s){const i=this.workflowsStore.outgoingConnectionsByNodeName(e)[s];if(i){const a=i[t];if(a)return a.find(r=>r.node===o&&r.index===n)}},connectTwoNodes(e,t,o,n,s){this.uiStore.stateIsDirty=!0;const i=this.workflowsStore.getNodeByName(e),a=this.workflowsStore.getNodeByName(o);if(i&&a&&!this.checkNodeConnectionAllowed(i,a,s)||this.getConnection(e,t,o,n,s))return;const r=[{node:e,type:s,index:t},{node:o,type:s,index:n}];this.__addConnection(r)},async addNode(e,t={},o=!0,n=!1,s=!1){var w;if(!this.editAllowedCheck())return;const i=this.lastSelectedNode,a=this.uiStore.lastSelectedNodeOutputIndex,r=this.uiStore.lastSelectedNodeEndpointUuid,l=this.canvasStore.lastSelectedConnection;this.historyStore.startRecordingUndo();const d=await this.injectNode(e,t,o,n,s);if(!d)return;const h=a||0,p=r||"";if(r&&!s){const f=this.instance.getEndpoint(r);if(f&&this.checkNodeConnectionAllowed(i,d,f.scope)){const N=f.scope,E=this.instance.getManagedElement(d.id),k=this.instance.getEndpoints(E).find(v=>v.scope===N&&f.parameters.connection!==v.parameters.connection);(w=this.instance)==null||w.connect({uuids:[p,(k==null?void 0:k.uuid)||""],detachable:!this.isReadOnlyRoute&&!this.readOnlyEnv}),this.historyStore.stopRecordingUndo();return}}if(i&&!s){if(await this.$nextTick(),l!=null&&l.__meta){this.__deleteJSPlumbConnection(l,n);const f=l.__meta.targetNodeName,N=l.__meta.targetOutputIndex;this.connectTwoNodes(d.name,0,f,N,_.Main)}this.connectTwoNodes(i.name,h,d.name,0,_.Main)}this.historyStore.stopRecordingUndo()},getNodeCreatorFilter(e,t){let o;const n=this.getCurrentWorkflow(),s=n.getNode(e);if(!s)return{nodes:[]};const i=this.nodeTypesStore.getNodeType(s==null?void 0:s.type,s.typeVersion);if(i){const r=pe(n,s,i).filter(l=>!(typeof l=="string"||l.type!==t||!l.filter));r.length&&(o=r[0].filter)}return o},insertNodeAfterSelected(e){var i,a,r;const t=e.outputType??_.Main,o=this.workflowsStore.getNodeById(e.sourceId);if(!o)return;this.uiStore.lastSelectedNode=o.name,this.uiStore.lastSelectedNodeEndpointUuid=e.endpointUuid??((a=(i=e.connection)==null?void 0:i.target.jtk)==null?void 0:a.endpoint.uuid),this.uiStore.lastSelectedNodeOutputIndex=e.index,this.canvasStore.newNodeInsertPosition=null,e.connection&&(this.canvasStore.lastSelectedConnection=e.connection),this.onToggleNodeCreator({source:e.eventSource,createNodeActive:!0,nodeCreatorView:e.nodeCreatorView});const n=((r=e.connection)==null?void 0:r.endpoints[0].parameters.connection)==="source";t!==_.Main&&Object.values(_).includes(t)&&fh().gotoCompatibleConnectionView(t,n,this.getNodeCreatorFilter(o.name,t)).catch(l=>{})},async onEventConnectionAbort(e){var t,o;try{if(this.dropPrevented){this.dropPrevented=!1;return}if(this.pullConnActiveNodeName){const n=this.workflowsStore.getNodeById(e.parameters.nodeId),s=e.parameters.type??_.Main,i=(t=e==null?void 0:e.connector)==null?void 0:t.overrideTargetEndpoint;if(n){const a=e.parameters.connection==="target",r=a?this.pullConnActiveNodeName:n.name,l=a?n.name:this.pullConnActiveNodeName,d=e.parameters.index;Mo(e),await this.$nextTick(),this.connectTwoNodes(r,d,l,((o=i==null?void 0:i.parameters)==null?void 0:o.index)??0,s),this.pullConnActiveNodeName=null,this.dropPrevented=!1}return}this.insertNodeAfterSelected({sourceId:e.parameters.nodeId,index:e.parameters.index,eventSource:ue.NODE_CONNECTION_DROP,connection:e,outputType:e.parameters.type})}catch(n){console.error(n)}},checkNodeConnectionAllowed(e,t,o){var s;const n=this.nodeTypesStore.getNodeType(t.type,t.typeVersion);if((s=n==null?void 0:n.inputs)!=null&&s.length){const i=this.getCurrentWorkflow(),a=i.getNode(t.name);let r=[];n&&(r=pe(i,a,n));for(const l of r||[])if(!(typeof l=="string"||l.type!==o||!l.filter)&&l.filter.nodes.length&&!l.filter.nodes.includes(e.type))return this.dropPrevented=!0,this.showToast({title:this.$locale.baseText("nodeView.showError.nodeNodeCompatible.title"),message:this.$locale.baseText("nodeView.showError.nodeNodeCompatible.message",{interpolate:{sourceNodeName:e.name,targetNodeName:t.name}}),type:"error",duration:5e3}),!1}return!0},onInterceptBeforeDrop(e){try{let t,o;if(e.connection.endpoints[0].parameters.connection==="target"?(t=e.dropEndpoint.parameters,o=e.connection.endpoints[0].parameters):(t=e.connection.endpoints[0].parameters,o=e.dropEndpoint.parameters),t.type!==o.type||t.connection===o.connection)return this.dropPrevented=!0,!1;const n=this.workflowsStore.getNodeById(t.nodeId),s=this.workflowsStore.getNodeById(o.nodeId),i=(n==null?void 0:n.name)||"",a=(s==null?void 0:s.name)||"";return n&&s&&!this.checkNodeConnectionAllowed(n,s,o.type)?!1:this.getConnection(i,t.index,a,o.index,t.type)?(this.dropPrevented=!0,this.pullConnActiveNodeName=null,!1):!0}catch(t){return console.error(t),!0}},onEventConnection(e){var t,o;try{if(e.sourceEndpoint.parameters.connection==="target"){const l=e.sourceEndpoint;e.sourceEndpoint=e.targetEndpoint,e.targetEndpoint=l}const n=e.sourceEndpoint.parameters,s=e.targetEndpoint.parameters,i=(t=this.workflowsStore.getNodeById(n.nodeId))==null?void 0:t.name,a=(o=this.workflowsStore.getNodeById(s.nodeId))==null?void 0:o.name;i&&a&&(e.connection.__meta={sourceNodeName:i,sourceOutputIndex:n.index,targetNodeName:a,targetOutputIndex:s.index}),st(e.connection),vi(e.targetEndpoint);const r=[{node:i,type:n.type,index:n.index},{node:a,type:s.type,index:s.index}];if(this.dropPrevented=!0,this.workflowsStore.addConnection({connection:r}),!this.isReadOnlyRoute&&!this.readOnlyEnv){Ni(e.sourceEndpoint),ki(e.connection,()=>{this.activeConnection=null,this.__deleteJSPlumbConnection(e.connection)},()=>{this.insertNodeAfterSelected({sourceId:e.sourceEndpoint.parameters.nodeId,index:n.index,connection:e.connection,eventSource:ue.NODE_CONNECTION_ACTION})});const l=Ti(e.connection,bi);n.type!==_.Main&&(e.connection.setPaintStyle(Si(e.connection,e.sourceEndpoint.parameters.category)),l==null||l.setVisible(!1))}this.dropPrevented=!1,this.isLoading||(this.uiStore.stateIsDirty=!0,this.suspendRecordingDetachedConnections||this.historyStore.pushCommandToUndo(new Di(r)),this.isInsertingNodes||(this.nodeHelpers.updateNodesInputIssues(),this.resetEndpointsErrors(),setTimeout(()=>{var l,d;Wo(e.source,e.target,(d=(l=e.connection)==null?void 0:l.connector)!=null&&d.hasOwnProperty("canvas")?e.connection.connector.canvas:void 0)},0)))}catch(n){console.error(n)}},addConectionsTestData(){this.instance.connections.forEach(e=>{var t;Wo(e.source,e.target,(t=e==null?void 0:e.connector)!=null&&t.hasOwnProperty("canvas")?e==null?void 0:e.connector.canvas:void 0)})},onDragMove(){const e=this.nodes.length;this.callDebounced(this.updateConnectionsOverlays,{debounceTime:e>20?200:0})},updateConnectionsOverlays(){var e;(e=this.instance)==null||e.connections.forEach(t=>{Vo(t),Bo(t),Object.values(t.overlays).forEach(o=>{var n;o.canvas&&((n=this.instance)==null||n.repaint(o.canvas))})})},isConnectionActive(e){var t,o;return!(e!=null&&e.id)||!((t=this.activeConnection)!=null&&t.id)?!1:((o=this.activeConnection)==null?void 0:o.id)===e.id},onConnectionMouseOver(e){try{if(this.exitTimer!==void 0&&(clearTimeout(this.exitTimer),this.exitTimer=void 0),this.isReadOnlyRoute??this.readOnlyEnv??this.enterTimer??!e??this.isConnectionActive(e))return;this.enterTimer=setTimeout(()=>{this.activeConnection&&!this.isConnectionActive(e)&&St(this.activeConnection),this.enterTimer=void 0,e&&(Ei(e),this.activeConnection=e)},150)}catch(t){console.error(t)}},onConnectionMouseOut(e){try{if(this.exitTimer||(this.enterTimer&&(clearTimeout(this.enterTimer),this.enterTimer=void 0),this.isReadOnlyRoute??this.readOnlyEnv??!e??!this.isConnectionActive(e)))return;this.exitTimer=setTimeout(()=>{this.exitTimer=void 0,e&&this.isConnectionActive(e)&&(St(this.activeConnection),this.activeConnection=null)},500)}catch(t){console.error(t)}},onConnectionMoved(e){var t,o;try{Uo(e.connection);const n=e.connection.parameters,s=e.originalEndpoint.parameters,i=[{node:((t=this.workflowsStore.getNodeById(n.nodeId))==null?void 0:t.name)||"",type:n.type,index:n.index},{node:((o=this.workflowsStore.getNodeById(s.nodeId))==null?void 0:o.name)||"",type:s.type,index:s.index}];this.__removeConnection(i,!1)}catch(n){console.error(n)}},onEndpointMouseOver(e,t){!e.isTarget||t.target!==e.endpoint.canvas||this.instance.setHover(e,!0)},onEndpointMouseOut(e){e.isTarget&&this.instance.setHover(e,!1)},async onConnectionDetached(e){var t;try{if(e.sourceEndpoint.parameters.connection==="target"){const n=e.sourceEndpoint;e.sourceEndpoint=e.targetEndpoint,e.targetEndpoint=n}const o=Lo(e);if(Uo(e.targetEndpoint),Ci(e.sourceEndpoint,e.connection),e.connection.removeOverlays(),this.__removeConnectionByConnectionInfo(e,!1,!1),this.pullConnActiveNodeName){this.historyStore.startRecordingUndo();const s=this.workflowsStore.getNodeById(e.connection.parameters.nodeId).name,i=e.connection.parameters.index,a=e.connection.connector.overrideTargetEndpoint;o&&this.historyStore.pushCommandToUndo(new it(o)),this.connectTwoNodes(s,i,this.pullConnActiveNodeName,((t=a==null?void 0:a.parameters)==null?void 0:t.index)??0,_.Main),this.pullConnActiveNodeName=null,await this.$nextTick(),this.historyStore.stopRecordingUndo()}else if(!this.historyStore.bulkInProgress&&!this.suspendRecordingDetachedConnections&&o){const n=new it(o,this);this.historyStore.pushCommandToUndo(n)}this.nodeHelpers.updateNodesInputIssues()}catch(o){console.error(o)}},onConnectionDrag(e){var t;(t=e.overlays["midpoint-arrow"])==null||t.setVisible(!1);try{this.pullConnActiveNodeName=null,this.pullConnActive=!0,this.canvasStore.newNodeInsertPosition=null,St(e),st(e);const o=e.scope,n=Array.from(document.querySelectorAll(`[data-jtk-scope-${o}=true]`)),i=e.parameters.connection==="source"?"target":"source",a=n.filter(d=>{const h=d.jtk.endpoint;if(!h)return!1;const p=h.parameters.nodeId===e.parameters.nodeId,w=h.parameters.connection;return!p&&w===i}),r=d=>{if(!e)return;const h=a.filter(p=>{const w=p.jtk.endpoint;if(p.classList.contains("jtk-floating-endpoint"))return!1;const f=Ho(p,d,50),N=Ho(w.element,d,30);if(f||N){const E=this.workflowsStore.getNodeById(w.parameters.nodeId);if(E)return!!this.nodeTypesStore.getNodeType(E.type,E.typeVersion)}return!1}).sort((p,w)=>{const f=xo(p,d,50),N=xo(w,d,50);return!(f!=null&&f.y)&&!(N!=null&&N.y)?0:f!=null&&f.y?N!=null&&N.y?N.y-f.y:-1:1});if(h.length>0){const w=h[0].jtk.endpoint,f=this.workflowsStore.getNodeById(w.parameters.nodeId);this.pullConnActiveNodeName=(f==null?void 0:f.name)??null,Ii(e,w)}else Pi(e),this.pullConnActiveNodeName=null},l=d=>{this.pullConnActive=!1,this.canvasStore.newNodeInsertPosition=this.getMousePositionWithinNodeView(d),Mo(e),window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",l),this.connectionDragScope={type:null,connection:null}};window.addEventListener("mousemove",r),window.addEventListener("touchmove",r),window.addEventListener("mouseup",l),window.addEventListener("touchend",r),this.connectionDragScope={type:e.parameters.type,connection:e.parameters.connection}}catch(o){console.error(o)}},onConnectionDragAbortDetached(e){var t;Object.values((t=this.instance)==null?void 0:t.endpointsByElement).flatMap(o=>Object.values(o)).filter(o=>o.endpoint.type==="N8nPlus").forEach(o=>setTimeout(()=>o.instance.revalidate(o.element),0))},onPlusEndpointClick(e){e!=null&&e.__meta&&this.insertNodeAfterSelected({sourceId:e.__meta.nodeId,index:e.__meta.index,eventSource:ue.PLUS_ENDPOINT,outputType:e.scope,endpointUuid:e.uuid})},onAddInputEndpointClick(e){e!=null&&e.__meta&&this.insertNodeAfterSelected({sourceId:e.__meta.nodeId,index:e.__meta.index,eventSource:ue.ADD_INPUT_ENDPOINT,nodeCreatorView:ct,outputType:e.scope,endpointUuid:e.uuid})},bindCanvasEvents(){this.eventsAttached||(this.instance.bind(at,this.onEventConnectionAbort),this.instance.bind(Oo,this.onInterceptBeforeDrop),this.instance.bind($o,this.onEventConnection),this.instance.bind(jo,this.onDragMove),this.instance.bind(qo,this.onConnectionMouseOver),this.instance.bind(Go,this.onConnectionMouseOut),this.instance.bind(Ro,this.onConnectionMoved),this.instance.bind(Jo,this.onEndpointMouseOver),this.instance.bind(Xo,this.onEndpointMouseOut),this.instance.bind(tt,this.onConnectionDetached),this.instance.bind(rt,this.onConnectionDrag),this.instance.bind([rt,at,tt],this.onConnectionDragAbortDetached),this.instance.bind(Fo,this.onPlusEndpointClick),this.instance.bind(zo,this.onAddInputEndpointClick),this.eventsAttached=!0)},unbindCanvasEvents(){this.instance.unbind(at,this.onEventConnectionAbort),this.instance.unbind(Oo,this.onInterceptBeforeDrop),this.instance.unbind($o,this.onEventConnection),this.instance.unbind(jo,this.onDragMove),this.instance.unbind(qo,this.onConnectionMouseOver),this.instance.unbind(Go,this.onConnectionMouseOut),this.instance.unbind(Ro,this.onConnectionMoved),this.instance.unbind(Jo,this.onEndpointMouseOver),this.instance.unbind(Xo,this.onEndpointMouseOut),this.instance.unbind(tt,this.onConnectionDetached),this.instance.unbind(rt,this.onConnectionDrag),this.instance.unbind(rt,this.onConnectionDragAbortDetached),this.instance.unbind(at,this.onConnectionDragAbortDetached),this.instance.unbind(tt,this.onConnectionDragAbortDetached),this.instance.unbind(Fo,this.onPlusEndpointClick),this.instance.unbind(zo,this.onAddInputEndpointClick),this.eventsAttached=!1},unbindEndpointEventListeners(e=!0){if(this.instance){const t=this.instance.getManagedElements();for(const o of Object.values(t)){const n=o.endpoints;for(const s of n||[]){const i=s==null?void 0:s.endpoint;i&&i.type===Oi&&i.unbindEvents()}}}this.eventsAttached=!1},onBeforeUnload(e){if(!(this.isDemo||window.preventNodeViewBeforeUnload)){if(this.uiStore.stateIsDirty)return this.collaborationStore.notifyWorkflowClosed(this.workflowsStore.workflowId),this.unloadTimeout=setTimeout(()=>{this.collaborationStore.notifyWorkflowOpened(this.workflowsStore.workflowId)},5*qs.SECOND),e.returnValue=!0,!0;this.canvasStore.startLoading(this.$locale.baseText("nodeView.redirecting")),this.collaborationStore.notifyWorkflowClosed(this.workflowsStore.workflowId);return}},onUnload(){clearTimeout(this.unloadTimeout)},async newWorkflow(){this.canvasStore.startLoading(),this.resetWorkspace(),this.workflowData=await this.workflowsStore.getNewWorkflowData(),this.workflowsStore.currentWorkflowExecutions=[],this.workflowsStore.activeWorkflowExecution=null,this.uiStore.stateIsDirty=!1,this.canvasStore.setZoomLevel(1,[0,0]),await this.tryToAddWelcomeSticky(),this.uiStore.nodeViewInitialized=!0,this.historyStore.reset(),this.workflowsStore.activeWorkflowExecution=null,this.canvasStore.stopLoading()},async tryToAddWelcomeSticky(){this.canvasStore.zoomToFit()},async initView(){var e,t;if(this.$route.params.action==="workflowSave"){this.uiStore.stateIsDirty=!1;return}if(this.blankRedirect)this.blankRedirect=!1;else if(this.$route.name===F.TEMPLATE_IMPORT){const o=this.$route.params.id;await this.openWorkflowTemplate(o)}else{if(this.uiStore.stateIsDirty&&!this.readOnlyEnv){const n=await this.confirm(this.$locale.baseText("generic.unsavedWork.confirmMessage.message"),{title:this.$locale.baseText("generic.unsavedWork.confirmMessage.headline"),type:"warning",confirmButtonText:this.$locale.baseText("generic.unsavedWork.confirmMessage.confirmButtonText"),cancelButtonText:this.$locale.baseText("generic.unsavedWork.confirmMessage.cancelButtonText"),showClose:!0});if(n===Ve)await this.saveCurrentWorkflow()&&await this.settingsStore.fetchPromptsData();else if(n===Gs)return}let o=null;if(this.$route.params.name&&(o=this.$route.params.name),o!==null){let n;try{n=await this.workflowsStore.fetchWorkflow(o)}catch(s){this.showError(s,this.$locale.baseText("openWorkflow.workflowNotFoundError")),this.$router.push({name:F.NEW_WORKFLOW})}n&&(this.titleSet(n.name,"IDLE"),await this.openWorkflow(n),await this.checkAndInitDebugMode(),(e=n.meta)!=null&&e.onboardingId&&this.$telemetry.track(`User opened workflow from onboarding template with ID ${n.meta.onboardingId}`,{workflow_id:n.id},{withPostHog:!0,withAppCues:!0}))}else((t=this.$route.meta)==null?void 0:t.nodeView)===!0&&await this.newWorkflow()}this.historyStore.reset(),this.uiStore.nodeViewInitialized=!0,document.addEventListener("keydown",this.keyDown),document.addEventListener("keyup",this.keyUp),window.addEventListener("beforeunload",this.onBeforeUnload),window.addEventListener("unload",this.onUnload),this.showNotificationForViews([F.WORKFLOW,F.NEW_WORKFLOW])},getOutputEndpointUUID(e,t,o){const n=this.workflowsStore.getNodeByName(e);return n?_t(n.id,t,o):null},getInputEndpointUUID(e,t,o){const n=this.workflowsStore.getNodeByName(e);return n?Nn(n.id,t,o):null},__addConnection(e){var s;const t=this.getOutputEndpointUUID(e[0].node,e[0].type,e[0].index),o=this.getInputEndpointUUID(e[1].node,e[1].type,e[1].index);if(!t||!o)return;const n=[t,o];(s=this.instance)==null||s.connect({uuids:n,detachable:!this.isReadOnlyRoute&&!this.readOnlyEnv}),setTimeout(()=>{this.addPinDataConnections(this.workflowsStore.pinnedWorkflowData||{})})},__removeConnection(e,t=!1){var o,n;if(t){const s=this.workflowsStore.getNodeByName(e[0].node),i=this.workflowsStore.getNodeByName(e[1].node);if(!s||!i)return;const a=this.nodeTypesStore.getNodeType(s.type,s.typeVersion),r=((o=a==null?void 0:a.outputs)==null?void 0:o[e[0].index])||_.Main,l=typeof r=="string"?r:r.name,d=Rt(l);((n=this.instance)==null?void 0:n.getConnections({scope:d,source:s.id,target:i.id})).forEach(p=>{p.__meta?p.__meta.sourceOutputIndex===e[0].index&&p.__meta.targetOutputIndex===e[1].index&&this.__deleteJSPlumbConnection(p):this.__deleteJSPlumbConnection(p)})}this.workflowsStore.removeConnection({connection:e})},__deleteJSPlumbConnection(e,t=!1){var o,n,s;if(e.removeOverlays(),this.pullConnActiveNodeName=null,(o=this.instance)==null||o.deleteConnection(e),t&&e.__meta){const i=[{index:(n=e.__meta)==null?void 0:n.sourceOutputIndex,node:e.__meta.sourceNodeName,type:_.Main},{index:(s=e.__meta)==null?void 0:s.targetOutputIndex,node:e.__meta.targetNodeName,type:_.Main}],a=new it(i,this);this.historyStore.pushCommandToUndo(a)}},__removeConnectionByConnectionInfo(e,t=!1,o=!1){const n=Lo(e);n&&(t?this.__deleteJSPlumbConnection(e.connection,o):o&&this.historyStore.pushCommandToUndo(new it(n)),this.workflowsStore.removeConnection({connection:n}))},async duplicateNodes(e){if(!this.editAllowedCheck())return;const t=Ee(await this.getNodesToSave(e));await this.importWorkflowData(t,"duplicate",!1)},getIncomingOutgoingConnections(e){var o,n;const t=this.workflowsStore.getNodeByName(e);if(t){const s=(o=this.instance)==null?void 0:o.getConnections({source:t.id});return{incoming:(n=this.instance)==null?void 0:n.getConnections({target:t.id}),outgoing:s}}return{incoming:[],outgoing:[]}},onNodeMoved(e){const{incoming:t,outgoing:o}=this.getIncomingOutgoingConnections(e.name);[...t,...o].forEach(n=>{Bo(n),Vo(n)})},onNodeRun({name:e,data:t,waiting:o}){var r;const n=this.workflowsStore.pinnedWorkflowData;if(n!=null&&n[e]){const{outgoing:l}=this.getIncomingOutgoingConnections(e);l.forEach(d=>{var h;if(((h=d.__meta)==null?void 0:h.sourceNodeName)===e){const p=this.workflowsStore.getWorkflowResultDataByNodeName(e)!==null;$i({connection:d,overlayIds:[Mi],classNames:p?["has-run"]:[],includeConnector:!0})}});return}const s=e,i=this.workflowsStore.getNodeByName(s),a=i!==null?i.id:"";if(t===null||t.length===0||o){((r=this.instance)==null?void 0:r.getConnections({source:a})).forEach(h=>{st(h)}),Ri(i,this.instance).forEach(h=>{h.endpoint.type==="N8nPlus"&&h.endpoint.clearSuccessOutput()});return}this.nodeHelpers.setSuccessOutput(t,i)},removeNode(e,t=!1,o=!0){if(!this.editAllowedCheck())return;const n=this.workflowsStore.getNodeByName(e);if(!n)return;t&&o&&this.historyStore.startRecordingUndo();const s=[];if(s.includes(n.type)){let p=!1;for(const w of this.nodes)if(w.name!==n.name&&s.includes(w.type)){p=!0;break}if(!p)return}n.type===se?this.$telemetry.track("User deleted workflow note",{workflow_id:this.workflowsStore.workflowId,is_welcome_note:n.name===mn}):(this.externalHooks.run("node.deleteNode",{node:n}),this.$telemetry.track("User deleted node",{node_type:n.type,workflow_id:this.workflowsStore.workflowId}));let i=!1;const a=this.nodeTypesStore.getNodeType(n.type,n.typeVersion),r=this.getCurrentWorkflow(),l=r.getNode(n.name);let d=[],h=[];if(a&&(d=pe(r,l,a),h=ve(r,l,a)),h.length===1&&d.length===1){const{incoming:p,outgoing:w}=this.getIncomingOutgoingConnections(n.name);if(p.length===1&&w.length===1){const f=p[0],N=w[0];if(f.__meta&&N.__meta){i=!0;const E=f.__meta.sourceNodeName,u=f.__meta.sourceOutputIndex,k=N.__meta.targetNodeName,v=N.__meta.targetOutputIndex;setTimeout(()=>{var $;this.connectTwoNodes(E,u,k,v,_.Main),i&&(($=this.instance)==null||$.setSuspendDrawing(!1,!0),i=!1)},100)}}}Cn(()=>{var p,w,f;(p=this.instance)==null||p.setSuspendDrawing(!0),(((w=this.instance)==null?void 0:w.endpointsByElement[n.id])||[]).flat().forEach(N=>{var E;return(E=this.instance)==null?void 0:E.deleteEndpoint(N)}),this.workflowsStore.removeAllNodeConnection(n),this.workflowsStore.removeNode(n),this.workflowsStore.clearNodeExecutionData(n.name),i||(f=this.instance)==null||f.setSuspendDrawing(!1,!0),this.uiStore.removeNodeFromSelection(n),t&&this.historyStore.pushCommandToUndo(new Wi(n))}),t&&o&&setTimeout(()=>{this.historyStore.stopRecordingUndo()},i?100:0)},async onSwitchSelectedNode(e){this.nodeSelectedByName(e,!0,!0)},async redrawNode(e){const t="x____XXXX____x";await this.renameNode(e,t),await this.renameNode(t,e)},valueChanged(e){e.name==="name"&&e.oldValue&&this.renameNode(e.oldValue,e.value)},async renameNodePrompt(e){try{const t=this.prompt(this.$locale.baseText("nodeView.prompt.newName")+":",this.$locale.baseText("nodeView.prompt.renameNode")+`: ${e}`,{customClass:"rename-prompt",confirmButtonText:this.$locale.baseText("nodeView.prompt.rename"),cancelButtonText:this.$locale.baseText("nodeView.prompt.cancel"),inputErrorMessage:this.$locale.baseText("nodeView.prompt.invalidName"),inputValue:e});await this.$nextTick();const o=document.querySelector(".rename-prompt .el-input__inner");o&&(o.focus(),o.select());const n=await t;if((n==null?void 0:n.action)!==Ve)return;await this.renameNode(e,n.value,!0)}catch{}},async renameNode(e,t,o=!1){if(e===t)return;this.suspendRecordingDetachedConnections=!0,o&&this.historyStore.startRecordingUndo();const s=(this.activeNode&&this.activeNode.name)===e;s&&(this.renamingActive=!0),t=this.uniqueNodeName(t);const i=this.getCurrentWorkflow(!0);i.renameNode(e,t),o&&this.historyStore.pushCommandToUndo(new vn(e,t)),this.workflowsStore.renameNodeSelectedAndExecution({old:e,new:t}),this.deleteEveryEndpoint(),this.workflowsStore.removeAllConnections({setStateDirty:!1}),this.workflowsStore.removeAllNodes({removePinData:!1,setStateDirty:!0}),await this.$nextTick(),await this.addNodes(Object.values(i.nodes),i.connectionsBySourceNode,!1),this.deselectAllNodes(),this.nodeSelectedByName(t),s&&(this.ndvStore.activeNodeName=t,this.renamingActive=!1),o&&this.historyStore.stopRecordingUndo(),this.suspendRecordingDetachedConnections=!1},deleteEveryEndpoint(){var e,t;this.instance&&((e=this.instance)==null||e.reset(),Object.values((t=this.instance)==null?void 0:t.endpointsByElement).flatMap(o=>o).forEach(o=>o.destroy()),this.instance.deleteEveryConnection({fireEvent:!0}))},matchCredentials(e){e.credentials&&Object.entries(e.credentials).forEach(([t,o])=>{const n=this.credentialsStore.getCredentialsByType(t);if(typeof o=="string"&&(o={id:null,name:o},this.credentialsUpdated=!0),o.id){const i=o.id.toString(),a=n.find(r=>r.id===i);if(a){(a.name!==o.name||typeof o.id=="number")&&(e.credentials[t]={id:a.id,name:a.name},this.credentialsUpdated=!0);return}}e.credentials[t]=o;const s=n.filter(i=>i.name===o.name);s.length===1&&(e.credentials[t].id=s[0].id,this.credentialsUpdated=!0)})},async addNodes(e,t,o=!1){var s,i;if(!(e!=null&&e.length))return;this.isInsertingNodes=!0,await this.loadNodesProperties(e.map(a=>({name:a.type,version:a.typeVersion})));let n;e.forEach(a=>{if(a.id||(a.id=he()),n=this.nodeTypesStore.getNodeType(a.type,a.typeVersion),a.hasOwnProperty("disabled")||(a.disabled=!1),a.hasOwnProperty("parameters")||(a.parameters={}),n!==null){let r=null;try{r=Be(n.properties,a.parameters,!0,!1,a)}catch(l){console.error(this.$locale.baseText("nodeView.thereWasAProblemLoadingTheNodeParametersOfNode")+`: "${a.name}"`),console.error(l)}a.parameters=r!==null?r:{},[Ce,Pe].includes(a.type)&&a.parameters.path===""&&(a.parameters.path=a.webhookId)}this.matchCredentials(a),this.workflowsStore.addNode(a),o&&this.historyStore.pushCommandToUndo(new _i(a))}),await this.$nextTick(),(s=this.instance)==null||s.setSuspendDrawing(!0),t&&await this.addConnections(t),this.nodeHelpers.refreshNodeIssues(),this.nodeHelpers.updateNodesInputIssues(),this.resetEndpointsErrors(),this.isInsertingNodes=!1,(i=this.instance)==null||i.setSuspendDrawing(!1,!0)},async addConnections(e){const t=[];for(const o in e)for(const n in e[o])e[o][n].forEach((s,i)=>{s&&s.forEach(a=>{t.push([{node:o,type:n,index:i},{node:a.node,type:a.type,index:a.index}])})});await this.processConnectionBatch(t),setTimeout(this.addConectionsTestData,0)},async processConnectionBatch(e){for(let o=0;o<e.length;o+=100)e.slice(o,o+100).forEach(s=>{this.__addConnection(s)})},async addNodesToWorkflow(e){const t={},o=[];if(!e.nodes)throw new Error(this.$locale.baseText("nodeView.noNodesGivenToAdd"));const n=this.getNodeTypesMaxCount();let s,i;const a=[];await this.loadNodesProperties(e.nodes.map(u=>({name:u.type,version:u.typeVersion}))),e.nodes.forEach(u=>{if(n[u.type]!==void 0)if(n[u.type].exist>=n[u.type].max){t[u.name]=n[u.type].nodeNames[0];return}else n[u.type].exist+=1;s=u.name;const k=this.locale.localizeNodeName(u.name,u.type);i=this.uniqueNodeName(k,o),o.push(i),t[s]=i,a.push(u)});const r={},l=e.connections,d=a.map(u=>u.name);let h,p,w,f,N;for(h of Object.keys(l)){if(!d.includes(h))continue;const u={};for(p of Object.keys(l[h]))for(u[p]=[],w=0;w<l[h][p].length;w++){const k=[];if(l[h][p][w])for(f=0;f<l[h][p][w].length;f++)N=l[h][p][w][f],d.includes(N.node)&&k.push(N);u[p].push(k)}r[h]=u}const E=this.getWorkflow(a,r);for(s in t)s!==t[s]&&E.renameNode(s,t[s]);if(e.pinData){let u=!0;for(const k of Object.keys(e.pinData)){if(!u){this.showError(new Error(this.$locale.baseText("ndv.pinData.error.tooLarge.description")),this.$locale.baseText("ndv.pinData.error.tooLarge.title"));continue}const v=E.nodes[t[k]];try{Ne(v).setData(e.pinData[k],"add-nodes"),u=!0}catch($){u=!1,console.error($)}}}return this.historyStore.startRecordingUndo(),await this.addNodes(Object.values(E.nodes),E.connectionsBySourceNode,!0),this.historyStore.stopRecordingUndo(),this.uiStore.stateIsDirty=!0,{nodes:Object.values(E.nodes),connections:E.connectionsBySourceNode}},async getNodesToSave(e){const t={nodes:[],connections:{},pinData:{}};let o;const n=[];for(const p of e){o=this.getNodeDataToSave(p),n.push(p.name),t.nodes.push(o);const w=this.workflowsStore.pinDataByNodeName(p.name);if(w&&(t.pinData[p.name]=w),o.credentials&&this.settingsStore.isEnterpriseFeatureEnabled(gn.Sharing)){const f=this.workflowsStore.usedCredentials;o.credentials=Object.fromEntries(Object.entries(o.credentials).filter(([N,E])=>{var u;return E.id&&(!f[E.id]||((u=f[E.id])==null?void 0:u.currentUserHasAccess))}))}}let s,i,a,r,l,d,h;return t.nodes.forEach(p=>{if(i=this.workflowsStore.outgoingConnectionsByNodeName(p.name),Object.keys(i).length!==0){h={};for(a of Object.keys(i))for(l=0;l<i[a].length;l++){for(s=[],r=0;r<i[a][l].length;r++)d=i[a][l][r],n.indexOf(d.node)!==-1&&s.push(d);s.length&&(h.hasOwnProperty(a)||(h[a]=[]),h[a][l]=s)}Object.keys(h).length&&(t.connections[p.name]=h)}}),t},resetWorkspace(){if(this.workflowsStore.resetWorkflow(),this.onToggleNodeCreator({createNodeActive:!1}),this.nodeCreatorStore.setShowScrim(!1),this.canvasStore.resetZoom(),this.unbindEndpointEventListeners(),this.deleteEveryEndpoint(),this.executionWaitingForWebhook)try{this.workflowsStore.removeTestWebhook(this.workflowsStore.workflowId)}catch{}this.workflowsStore.resetState(),this.uiStore.removeActiveAction("workflowRunning"),this.uiStore.resetSelectedNodes(),this.uiStore.nodeViewOffsetPosition=[0,0],this.credentialsUpdated=!1},async loadActiveWorkflows(){await this.workflowsStore.fetchActiveWorkflows()},async loadNodeTypes(){await this.nodeTypesStore.getNodeTypes()},async loadCredentialTypes(){await this.credentialsStore.fetchCredentialTypes(!0)},async loadCredentials(){await this.credentialsStore.fetchAllCredentials()},async loadVariables(){await this.environmentsStore.fetchAllVariables()},async loadSecrets(){await this.externalSecretsStore.fetchAllSecrets()},async loadNodesProperties(e){const t=this.nodeTypesStore.allNodeTypes,o=[];t.forEach(n=>{const s=Array.isArray(n.version)?n.version:[n.version];e.find(i=>i.name===n.name&&s.includes(i.version))&&!n.hasOwnProperty("properties")&&o.push({name:n.name,version:Array.isArray(n.version)?n.version.slice(-1)[0]:n.version})}),o.length>0&&(this.canvasStore.startLoading(),await this.nodeTypesStore.getNodesInformation(o),this.canvasStore.stopLoading())},async onPostMessageReceived(e){var t,o;if(!(!e||typeof e.data!="string"||!((o=(t=e.data)==null?void 0:t.includes)!=null&&o.call(t,'"command"'))))try{const n=JSON.parse(e.data);if(n&&n.command==="openWorkflow")try{await this.importWorkflowExact(n),this.canOpenNDV=n.canOpenNDV??!0,this.hideNodeIssues=n.hideNodeIssues??!1,this.isExecutionPreview=!1}catch(s){window.top&&window.top.postMessage(JSON.stringify({command:"error",message:this.$locale.baseText("openWorkflow.workflowImportError")}),"*"),this.showMessage({title:this.$locale.baseText("openWorkflow.workflowImportError"),message:s.message,type:"error"})}else if(n&&n.command==="openExecution")try{this.isProductionExecutionPreview=n.executionMode!=="manual",await this.openExecution(n.executionId),this.canOpenNDV=n.canOpenNDV??!0,this.hideNodeIssues=n.hideNodeIssues??!1,this.isExecutionPreview=!0}catch(s){window.top&&window.top.postMessage(JSON.stringify({command:"error",message:this.$locale.baseText("nodeView.showError.openExecution.title")}),"*"),this.showMessage({title:this.$locale.baseText("nodeView.showError.openExecution.title"),message:s.message,type:"error"})}else(n==null?void 0:n.command)==="setActiveExecution"&&(this.workflowsStore.activeWorkflowExecution=n.execution)}catch{}},async onImportWorkflowDataEvent(e){await this.importWorkflowData(e.data,"file")},async onImportWorkflowUrlEvent(e){const t=await this.getWorkflowDataFromUrl(e.url);t!==void 0&&await this.importWorkflowData(t,"url")},addPinDataConnections(e){Object.keys(e).forEach(t=>{var a;const o=this.workflowsStore.getNodeByName(t);if(!o)return;const n=this.workflowsStore.getWorkflowResultDataByNodeName(t)!==null,s=["pinned"];n&&s.push("has-run"),((a=this.instance)==null?void 0:a.getConnections({source:o.id})).forEach(r=>{Ai(r,{total:e[t].length,iterations:0,classNames:s})})})},removePinDataConnections(e){Object.keys(e).forEach(t=>{var s;const o=this.workflowsStore.getNodeByName(t);if(!o)return;const n=(s=this.instance)==null?void 0:s.getConnections({source:o.id});this.instance.setSuspendDrawing(!0),n.forEach(st),this.instance.setSuspendDrawing(!1,!0)})},onToggleNodeCreator({source:e,createNodeActive:t,nodeCreatorView:o}){if(t===this.createNodeActive)return;o||(o=this.containsTrigger?$t:Ue),this.nodeCreatorStore.setSelectedView(o),this.createNodeActive=t;let n;switch(this.nodeCreatorStore.selectedView){case ct:n="ai";break;case $t:n="regular";break;default:n="regular"}t&&this.nodeCreatorStore.setOpenSource(e),this.externalHooks.run("nodeView.createNodeActiveChanged",{source:e,mode:n,createNodeActive:t}),this.$telemetry.trackNodesPanel("nodeView.createNodeActiveChanged",{source:e,mode:n,createNodeActive:t,workflow_id:this.workflowsStore.workflowId})},async onAddNodes({nodes:e,connections:t},o=!1,n){let s=n;for(const{type:d,isAutoAdd:h,name:p,openDetail:w,position:f}of e){await this.addNode(d,{position:f??s,dragAndDrop:o,name:p},w??!1,!0,h);const N=this.nodes[this.nodes.length-1];s=[N.position[0]+Ye*2+nt,N.position[1]]}const i=this.nodes.length-e.length;for(const{from:d,to:h}of t){const p=this.nodes[i+d.nodeIndex],w=this.nodes[i+h.nodeIndex];this.connectTwoNodes(p.name,d.outputIndex??0,w.name,h.inputIndex??0,_.Main)}const a=this.nodes[this.nodes.length-1],l=this.getCurrentWorkflow().getParentNodesByDepth(a.name,1);l.length>1&&l.slice(1).forEach((d,h)=>{const p=this.workflowsStore.getNodeByName(d.name);p&&this.onMoveNode({nodeName:p.name,position:[p.position[0],p.position[1]+100*(h+1)]})}),this.addPinDataConnections(this.workflowsStore.pinnedWorkflowData||{})},async saveCurrentWorkflowExternal(e){await this.saveCurrentWorkflow(),e==null||e()},setSuspendRecordingDetachedConnections(e){this.suspendRecordingDetachedConnections=e},onMoveNode({nodeName:e,position:t}){this.workflowsStore.updateNodeProperties({name:e,properties:{position:t}});const o=this.workflowsStore.getNodeByName(e);setTimeout(()=>{var n;o&&((n=this.instance)==null||n.repaintEverything(),this.onNodeMoved(o))},0)},onRevertAddNode({node:e}){this.removeNode(e.name,!1)},async onRevertRemoveNode({node:e}){this.workflowsStore.workflow.nodes.find(o=>o.id===e.id)||(e.id=he(),await this.addNodes([e]))},onRevertAddConnection({connection:e}){this.suspendRecordingDetachedConnections=!0,this.__removeConnection(e,!0),this.suspendRecordingDetachedConnections=!1},async onRevertRemoveConnection({connection:e}){this.suspendRecordingDetachedConnections=!0,this.__addConnection(e),this.suspendRecordingDetachedConnections=!1},async onRevertNameChange({currentName:e,newName:t}){await this.renameNode(t,e)},onRevertEnableToggle({nodeName:e,isDisabled:t}){const o=this.workflowsStore.getNodeByName(e);o&&this.nodeHelpers.disableNodes([o])},onPageShow(e){e.persisted&&this.canvasStore.stopLoading()},readOnlyEnvRouteCheck(){this.readOnlyEnv&&[F.NEW_WORKFLOW,F.TEMPLATE_IMPORT].includes(this.$route.name)&&this.$nextTick(async()=>{this.resetWorkspace(),this.uiStore.stateIsDirty=!1,await this.$router.replace({name:F.WORKFLOWS})})},async checkAndInitDebugMode(){this.$route.name===F.EXECUTION_DEBUG&&(this.titleSet(this.workflowName,"DEBUG"),this.workflowsStore.isInDebugMode||(await this.applyExecutionData(this.$route.params.executionId),this.workflowsStore.isInDebugMode=!0))},onContextMenuAction(e,t){switch(e){case"copy":this.copyNodes(t);break;case"delete":this.deleteNodes(t);break;case"duplicate":this.duplicateNodes(t);break;case"execute":this.onRunNode(t[0].name,"NodeView.onContextMenuAction");break;case"open":this.ndvStore.activeNodeName=t[0].name;break;case"rename":this.renameNodePrompt(t[0].name);break;case"toggle_activation":this.toggleActivationNodes(t);break;case"toggle_pin":this.togglePinNodes(t,"context-menu");break;case"add_node":this.onToggleNodeCreator({source:ue.CONTEXT_MENU,createNodeActive:!this.isReadOnlyRoute&&!this.readOnlyEnv});break;case"add_sticky":this.onAddNodes({nodes:[{type:se}],connections:[]});break;case"select_all":this.selectAllNodes();break;case"deselect_all":this.deselectAllNodes();break}}},async onSourceControlPull(){let e=null;this.$route.params.name&&(e=this.$route.params.name);try{if(await Promise.all([this.loadCredentials(),this.loadVariables(),this.tagsStore.fetchAll()]),e!==null&&!this.uiStore.stateIsDirty){const t=await this.workflowsStore.fetchWorkflow(e);t&&(this.titleSet(t.name,"IDLE"),await this.openWorkflow(t))}}catch(t){console.error(t)}}}),Nh="_content_59nwu_5",kh="_shake_59nwu_13",bh="_setupCredentialsButtonWrapper_59nwu_31",Th={content:Nh,shake:kh,setupCredentialsButtonWrapper:bh},Sh=["textContent"],Dh={key:0,class:"workflow-execute-wrapper"};function Eh(e,t,o,n,s,i){const a=S("CanvasAddButton"),r=S("Node"),l=S("Sticky"),d=S("NodeDetailsView"),h=S("SetupWorkflowCredentialsButton"),p=S("NodeCreation"),w=S("CanvasControls"),f=S("ContextMenu"),N=S("n8n-button"),E=S("KeyboardShortcutTooltip"),u=S("n8n-icon-button"),k=Kt("touch");return c(),b("div",{class:D(e.$style.content),ref:"nodeViewRootRef"},[g("div",{id:"node-view-root",class:"node-view-root do-not-select","data-test-id":"node-view-root",onDragover:t[12]||(t[12]=(...v)=>e.onDragOver&&e.onDragOver(...v)),onDrop:t[13]||(t[13]=(...v)=>e.onDrop&&e.onDrop(...v))},[Y((c(),b("div",{class:D(["node-view-wrapper",e.workflowClasses]),"data-test-id":"node-view-wrapper",onTouchstart:t[2]||(t[2]=(...v)=>e.mouseDown&&e.mouseDown(...v)),onTouchend:t[3]||(t[3]=(...v)=>e.mouseUp&&e.mouseUp(...v)),onTouchmove:t[4]||(t[4]=(...v)=>e.canvasPanning.onMouseMove&&e.canvasPanning.onMouseMove(...v)),onMousedown:t[5]||(t[5]=(...v)=>e.mouseDown&&e.mouseDown(...v)),onMouseup:t[6]||(t[6]=(...v)=>e.mouseUp&&e.mouseUp(...v)),onContextmenu:t[7]||(t[7]=(...v)=>e.contextMenu.open&&e.contextMenu.open(...v)),onWheel:t[8]||(t[8]=(...v)=>e.canvasStore.wheelScroll&&e.canvasStore.wheelScroll(...v))},[g("div",{id:"node-view-background",class:"node-view-background",style:oe(e.backgroundStyle),"data-test-id":"node-view-background"},null,4),g("div",{id:"node-view",ref:"nodeViewRef",class:"node-view",style:oe(e.workflowStyle),"data-test-id":"node-view"},[Y(m(a,{ref:"canvasAddButton",style:oe(e.canvasAddButtonStyle),"show-tooltip":!e.containsTrigger&&e.showTriggerMissingTooltip,position:e.canvasStore.canvasAddButtonPosition,"data-test-id":"canvas-add-button",onClick:t[0]||(t[0]=v=>e.showTriggerCreator(e.NODE_CREATOR_OPEN_SOURCES.TRIGGER_PLACEHOLDER_BUTTON)),"onHook:mounted":e.canvasStore.setRecenteredCanvasAddButtonPosition},null,8,["style","show-tooltip","position","onHook:mounted"]),[[J,e.showCanvasAddButton]]),(c(!0),b(Q,null,ae(e.nodesToRender,v=>(c(),P(r,{key:`${v.id}_node`,name:v.name,"is-read-only":e.isReadOnlyRoute||e.readOnlyEnv,instance:e.instance,"is-active":!!e.activeNode&&e.activeNode.name===v.name,"hide-actions":e.pullConnActive,"is-production-execution-preview":e.isProductionExecutionPreview,workflow:e.currentWorkflowObject,"disable-pointer-events":!e.canOpenNDV,"hide-node-issues":e.hideNodeIssues,onDeselectAllNodes:e.deselectAllNodes,onDeselectNode:e.nodeDeselectedByName,onNodeSelected:e.nodeSelectedByName,onRunWorkflow:e.onRunNode,onMoved:e.onNodeMoved,onRun:e.onNodeRun},{"custom-tooltip":y(()=>[g("span",{textContent:T(e.$locale.baseText("nodeView.placeholderNode.addTriggerNodeBeforeExecuting"))},null,8,Sh)]),_:2},1032,["name","is-read-only","instance","is-active","hide-actions","is-production-execution-preview","workflow","disable-pointer-events","hide-node-issues","onDeselectAllNodes","onDeselectNode","onNodeSelected","onRunWorkflow","onMoved","onRun"]))),128)),(c(!0),b(Q,null,ae(e.stickiesToRender,v=>(c(),P(l,{key:`${v.id}_sticky`,name:v.name,workflow:e.currentWorkflowObject,"is-read-only":e.isReadOnlyRoute||e.readOnlyEnv,instance:e.instance,"is-active":!!e.activeNode&&e.activeNode.name===v.name,"node-view-scale":e.nodeViewScale,"grid-size":e.GRID_SIZE,"hide-actions":e.pullConnActive,onDeselectAllNodes:e.deselectAllNodes,onDeselectNode:e.nodeDeselectedByName,onNodeSelected:e.nodeSelectedByName,onRemoveNode:t[1]||(t[1]=$=>e.removeNode($,!0))},null,8,["name","workflow","is-read-only","instance","is-active","node-view-scale","grid-size","hide-actions","onDeselectAllNodes","onDeselectNode","onNodeSelected"]))),128))],4)],34)),[[k,e.touchTap,"tap"]]),m(d,{"read-only":e.isReadOnlyRoute||e.readOnlyEnv,renaming:e.renamingActive,"is-production-execution-preview":e.isProductionExecutionPreview,onRedrawNode:e.redrawNode,onSwitchSelectedNode:e.onSwitchSelectedNode,onValueChanged:e.valueChanged,onStopExecution:e.stopExecution,onSaveKeyboardShortcut:e.onSaveKeyboardShortcut},null,8,["read-only","renaming","is-production-execution-preview","onRedrawNode","onSwitchSelectedNode","onValueChanged","onStopExecution","onSaveKeyboardShortcut"]),(c(),P(we,null,{default:y(()=>[g("div",{class:D(e.$style.setupCredentialsButtonWrapper)},[m(h)],2)]),_:1})),(c(),P(we,null,{default:y(()=>[!e.isReadOnlyRoute&&!e.readOnlyEnv?(c(),P(p,{key:0,"create-node-active":e.createNodeActive,"node-view-scale":e.nodeViewScale,onToggleNodeCreator:e.onToggleNodeCreator,onAddNodes:e.onAddNodes},null,8,["create-node-active","node-view-scale","onToggleNodeCreator","onAddNodes"])):C("",!0)]),_:1})),(c(),P(we,null,{default:y(()=>[m(w)]),_:1})),(c(),P(we,null,{default:y(()=>[m(f,{onAction:e.onContextMenuAction},null,8,["onAction"])]),_:1})),!e.isReadOnlyRoute&&!e.readOnlyEnv?(c(),b("div",Dh,[e.isManualChatOnly?C("",!0):(c(),b("span",{key:0,onMouseenter:t[9]||(t[9]=v=>e.showTriggerMissingToltip(!0)),onMouseleave:t[10]||(t[10]=v=>e.showTriggerMissingToltip(!1)),onClick:t[11]||(t[11]=(...v)=>e.onRunContainerClick&&e.onRunContainerClick(...v))},[m(E,{label:e.runButtonText,shortcut:{metaKey:!0,keys:["↵"]}},{default:y(()=>[m(N,{loading:e.workflowRunning,label:e.runButtonText,size:"large",icon:"flask",type:"primary",disabled:e.isExecutionDisabled,"data-test-id":"execute-workflow-button",onClick:te(e.onRunWorkflow,["stop"])},null,8,["loading","label","disabled","onClick"])]),_:1},8,["label"])],32)),e.containsChatNodes?(c(),P(N,{key:1,label:"Chat",size:"large",icon:"comment",type:"primary","data-test-id":"workflow-chat-button",onClick:te(e.onOpenChat,["stop"])},null,8,["onClick"])):C("",!0),e.workflowRunning===!0&&!e.executionWaitingForWebhook?(c(),P(u,{key:2,icon:"stop",size:"large",class:"stop-execution",type:"secondary",title:e.stopExecutionInProgress?e.$locale.baseText("nodeView.stoppingCurrentExecution"):e.$locale.baseText("nodeView.stopCurrentExecution"),loading:e.stopExecutionInProgress,"data-test-id":"stop-execution-button",onClick:te(e.stopExecution,["stop"])},null,8,["title","loading","onClick"])):C("",!0),e.workflowRunning===!0&&e.executionWaitingForWebhook===!0?(c(),P(u,{key:3,class:"stop-execution",icon:"stop",size:"large",title:e.$locale.baseText("nodeView.stopWaitingForWebhookCall"),type:"secondary","data-test-id":"stop-execution-waiting-for-webhook-button",onClick:te(e.stopWaitingForWebhook,["stop"])},null,8,["title","onClick"])):C("",!0),!e.isReadOnlyRoute&&!e.readOnlyEnv&&e.workflowExecution&&!e.workflowRunning&&!e.allTriggersDisabled?(c(),P(u,{key:4,title:e.$locale.baseText("nodeView.deletesTheCurrentExecutionData"),icon:"trash",size:"large","data-test-id":"clear-execution-data-button",onClick:te(e.clearExecutionData,["stop"])},null,8,["title","onClick"])):C("",!0)])):C("",!0)],32)],2)}const Ch={$style:Th},Ih=L(vh,[["render",Eh],["__cssModules",Ch],["__scopeId","data-v-c60cf650"]]),jh=Object.freeze(Object.defineProperty({__proto__:null,default:Ih},Symbol.toStringTag,{value:"Module"}));export{zh as A,sr as D,jh as N,Kh as R,Yh as T,Pn as a,fh as b,ph as c,ch as d,Ne as e,on as f,At as s,qe as t,ft as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/RunDataTable-5BP-mJaN.js","assets/pinia-aUqqC48i.js","assets/n8n-_nNvRoCf.js","assets/vendor-NNwioulI.js","assets/lodash-es-5z_C16pm.js","assets/axios-s2RMMPhA.js","assets/flatted-jPn12Tq4.js","assets/esprima-next-ulPLCZ1Z.js","assets/luxon-ZRIU05qF.js","assets/@vueuse/core-8g26_cc0.js","assets/uuid-McvpxQtQ.js","assets/vue-i18n-1PEMRmUU.js","assets/@n8n/permissions-8yMqUF1Y.js","assets/n8n-y89D68g9.css","assets/TextWithHighlights.vue_vue_type_script_setup_true_lang-OUCPnKVA.js","assets/TextWithHighlights-4fPn_DY2.css","assets/index-xP-VuMjv.js","assets/@n8n/codemirror-lang-sql-feLn5IS9.js","assets/@lezer/common-1hBQ1gIF.js","assets/codemirror-lang-html-n8n-wWQLhhqk.js","assets/prettier-s3fE3Qyr.js","assets/@jsplumb/util-DR0SB56A.js","assets/@jsplumb/core-MKwKlGip.js","assets/@jsplumb/common-Q5_tv_GT.js","assets/@jsplumb/connector-bezier-3dWY17R5.js","assets/@jsplumb/browser-ui-AlqFM-P6.js","assets/codemirror-lang-n8n-expression-HpIZnV_9.js","assets/fast-json-stable-stringify-eHEaCv8s.js","assets/timeago.js--Bumj2r9.js","assets/qrcode.vue-UdCmS1Sj.js","assets/vue3-touch-events-_RfbPMOD.js","assets/chart.js-JtqvIvkt.js","assets/index-OZ0UPgDI.css","assets/useExecutionDebugging-GoiwhZAw.js","assets/file-saver-GLtlGJrO.js","assets/vue-json-pretty-AIiKR_BZ.js","assets/dateFormatter-e3zTcyK4.js","assets/RunDataAi-WDp0ZlAg.js","assets/RunDataAi-lJTQYpdI.css","assets/workflowActivate-taS2Qpdq.js","assets/collaboration.store-emJMSzVB.js","assets/RunDataTable-SMFiA3bR.css","assets/RunDataJson-pCteLtYj.js","assets/RunDataJson-Jt5WVSW6.css","assets/RunDataSchema-bFDumJlX.js","assets/RunDataSchema-_PH4mUfw.css","assets/RunDataSearch-ZHNpHbv8.js","assets/RunDataSearch-EE8rOPoF.css","assets/NodeCreation-q-9Zw2Lt.js","assets/NodeCreation-LcTWlYP6.css","assets/CanvasControls-uNKmu1Mm.js","assets/CanvasControls-vUMDXWeC.css","assets/SetupWorkflowCredentialsButton-YRXUCIqW.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
//# sourceMappingURL=NodeView-e_zfgMVH.js.map
