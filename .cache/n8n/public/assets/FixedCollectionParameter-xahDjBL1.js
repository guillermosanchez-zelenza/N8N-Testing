import{f_ as P,o as c,_ as I}from"./n8n-_nNvRoCf.js";import{g as O}from"./lodash-es-5z_C16pm.js";import{G as S,ag as p,l as s,m as n,T as m,O as y,R,S as A,Q as u,F as f,a7 as b,M as d,p as $,aG as j,I as B,a2 as L}from"./vendor-NNwioulI.js";import"./axios-s2RMMPhA.js";import"./flatted-jPn12Tq4.js";import"./esprima-next-ulPLCZ1Z.js";import"./luxon-ZRIU05qF.js";import"./pinia-aUqqC48i.js";import"./@vueuse/core-8g26_cc0.js";import"./uuid-McvpxQtQ.js";import"./vue-i18n-1PEMRmUU.js";import"./@n8n/permissions-8yMqUF1Y.js";const U=S({name:"FixedCollectionParameter",props:{nodeValues:{type:Object,required:!0},parameter:{type:Object,required:!0},path:{type:String,required:!0},values:{type:Object,default:()=>({})},isReadOnly:{type:Boolean,default:!1}},data(){return{selectedOption:void 0,mutableValues:{}}},computed:{getPlaceholderText(){const e=this.$locale.nodeText().placeholder(this.parameter,this.path);return e||this.$locale.baseText("fixedCollectionParameter.choose")},getProperties(){const e=[];let t;for(const o of this.propertyNames)t=this.getOptionProperties(o),t!==void 0&&e.push(t);return e},multipleValues(){var e;return!!((e=this.parameter.typeOptions)!=null&&e.multipleValues)},parameterOptions(){return this.multipleValues&&P(this.parameter.options)?this.parameter.options:this.parameter.options.filter(e=>!this.propertyNames.includes(e.name))},propertyNames(){return Object.keys(this.mutableValues||{})},sortable(){var e;return!!((e=this.parameter.typeOptions)!=null&&e.sortable)}},watch:{values:{handler(e){this.mutableValues=c(e)},deep:!0}},created(){this.mutableValues=c(this.values)},methods:{deleteOption(e,t){const o=this.mutableValues[e];!o||o.length>1?this.$emit("valueChanged",{name:this.getPropertyPath(e,t),value:void 0}):this.$emit("valueChanged",{name:this.getPropertyPath(e),value:void 0})},getPropertyPath(e,t){return`${this.path}.${e}`+(t!==void 0?`[${t}]`:"")},getOptionProperties(e){if(P(this.parameter.options)){for(const t of this.parameter.options)if(t.name===e)return t}},moveOptionDown(e,t){Array.isArray(this.mutableValues[e])&&this.mutableValues[e].splice(t+1,0,this.mutableValues[e].splice(t,1)[0]);const o={name:this.getPropertyPath(e),value:this.mutableValues[e]};this.$emit("valueChanged",o)},moveOptionUp(e,t){var i;Array.isArray(this.mutableValues[e])&&((i=this.mutableValues)==null||i[e].splice(t-1,0,this.mutableValues[e].splice(t,1)[0]));const o={name:this.getPropertyPath(e),value:this.mutableValues[e]};this.$emit("valueChanged",o)},optionSelected(e){const t=this.getOptionProperties(e);if(t===void 0)return;const o=`${this.path}.${t.name}`,i={};for(const l of t.values)l.type==="fixedCollection"&&l.typeOptions!==void 0&&l.typeOptions.multipleValues===!0?i[l.name]={}:l.typeOptions!==void 0&&l.typeOptions.multipleValues===!0?(i[l.name]=O(this.nodeValues,`${this.path}.${l.name}`,[]),Array.isArray(l.default)?i[l.name].push(...c(l.default)):l.default!==""&&typeof l.default!="object"&&i[l.name].push(c(l.default))):i[l.name]=c(l.default);let h;this.multipleValues?(h=O(this.nodeValues,o,[]),h.push(i)):h=i;const g={name:o,value:h};this.$emit("valueChanged",g),this.selectedOption=void 0},valueChanged(e){this.$emit("valueChanged",e)}}}),F={key:0,class:"no-items-exist"},q={key:1},_={key:0,class:"delete-option"},E={key:2,class:"parameter-item"},G={class:"parameter-item-wrapper"},M={key:0,class:"delete-option"},N={key:1,class:"controls"},K={key:1,class:"add-option"};function Q(e,t,o,i,h,g){const l=p("n8n-text"),k=p("n8n-input-label"),v=p("n8n-icon-button"),V=p("ParameterInputList"),T=p("n8n-button"),w=p("n8n-option"),D=p("n8n-select");return s(),n("div",{class:"fixed-collection-parameter",onKeydown:t[2]||(t[2]=L(()=>{},["stop"]))},[e.getProperties.length===0?(s(),n("div",F,[m(l,{size:"small"},{default:y(()=>[A(R(e.$locale.baseText("fixedCollectionParameter.currentlyNoItemsExist")),1)]),_:1})])):u("",!0),(s(!0),n(f,null,b(e.getProperties,a=>(s(),n("div",{key:a.name,class:"fixed-collection-parameter-property"},[a.displayName!==""&&e.parameter.options&&e.parameter.options.length!==1?(s(),d(k,{key:0,label:e.$locale.nodeText().inputLabelDisplayName(a,e.path),underline:!0,size:"small",color:"text-dark"},null,8,["label"])):u("",!0),e.multipleValues?(s(),n("div",q,[(s(!0),n(f,null,b(e.mutableValues[a.name],(z,r)=>(s(),n("div",{key:a.name+r,class:"parameter-item"},[$("div",{class:B(r?"border-top-dashed parameter-item-wrapper ":"parameter-item-wrapper")},[e.isReadOnly?u("",!0):(s(),n("div",_,[m(v,{type:"tertiary",text:"",size:"mini",icon:"trash",title:e.$locale.baseText("fixedCollectionParameter.deleteItem"),onClick:C=>e.deleteOption(a.name,r)},null,8,["title","onClick"]),e.sortable&&r!==0?(s(),d(v,{key:0,type:"tertiary",text:"",size:"mini",icon:"angle-up",title:e.$locale.baseText("fixedCollectionParameter.moveUp"),onClick:C=>e.moveOptionUp(a.name,r)},null,8,["title","onClick"])):u("",!0),e.sortable&&r!==e.mutableValues[a.name].length-1?(s(),d(v,{key:1,type:"tertiary",text:"",size:"mini",icon:"angle-down",title:e.$locale.baseText("fixedCollectionParameter.moveDown"),onClick:C=>e.moveOptionDown(a.name,r)},null,8,["title","onClick"])):u("",!0)])),(s(),d(j,null,{default:y(()=>[m(V,{parameters:a.values,"node-values":e.nodeValues,path:e.getPropertyPath(a.name,r),"hide-delete":!0,"is-read-only":e.isReadOnly,onValueChanged:e.valueChanged},null,8,["parameters","node-values","path","is-read-only","onValueChanged"])]),_:2},1024))],2)]))),128))])):(s(),n("div",E,[$("div",G,[e.isReadOnly?u("",!0):(s(),n("div",M,[m(v,{type:"tertiary",text:"",size:"mini",icon:"trash",title:e.$locale.baseText("fixedCollectionParameter.deleteItem"),onClick:z=>e.deleteOption(a.name)},null,8,["title","onClick"])])),m(V,{parameters:a.values,"node-values":e.nodeValues,path:e.getPropertyPath(a.name),"is-read-only":e.isReadOnly,class:"parameter-item","hide-delete":!0,onValueChanged:e.valueChanged},null,8,["parameters","node-values","path","is-read-only","onValueChanged"])])]))]))),128)),e.parameterOptions.length>0&&!e.isReadOnly?(s(),n("div",N,[e.parameter.options.length===1?(s(),d(T,{key:0,type:"tertiary",block:"",label:e.getPlaceholderText,onClick:t[0]||(t[0]=a=>e.optionSelected(e.parameter.options[0].name))},null,8,["label"])):(s(),n("div",K,[m(D,{modelValue:e.selectedOption,"onUpdate:modelValue":[t[1]||(t[1]=a=>e.selectedOption=a),e.optionSelected],placeholder:e.getPlaceholderText,size:"small",filterable:""},{default:y(()=>[(s(!0),n(f,null,b(e.parameterOptions,a=>(s(),d(w,{key:a.name,label:e.$locale.nodeText().collectionOptionDisplayName(e.parameter,a,e.path),value:a.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder","onUpdate:modelValue"])]))])):u("",!0)],32)}const ne=I(U,[["render",Q],["__scopeId","data-v-5d43b54f"]]);export{ne as default};
//# sourceMappingURL=FixedCollectionParameter-xahDjBL1.js.map
